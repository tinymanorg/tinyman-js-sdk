"use strict";var e=require("algosdk"),t=require("base64-js"),n=require("crypto");function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(){s=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function p(e,t,n,a){var s=t&&t.prototype instanceof f?t:f,o=Object.create(s.prototype),i=new E(a||[]);return r(o,"_invoke",{value:w(e,n,i)}),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=p;var d={};function f(){}function g(){}function h(){}var m={};c(m,o,(function(){return this}));var A=Object.getPrototypeOf,x=A&&A(A(N([])));x&&x!==t&&n.call(x,o)&&(m=x);var I=h.prototype=f.prototype=Object.create(m);function v(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function a(r,s,o,i){var u=l(e[r],e,s);if("throw"!==u.type){var c=u.arg,p=c.value;return p&&"object"==typeof p&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,o,i)}),(function(e){a("throw",e,o,i)})):t.resolve(p).then((function(e){c.value=e,o(c)}),(function(e){return a("throw",e,o,i)}))}i(u.arg)}var s;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){a(e,n,t,r)}))}return s=s?s.then(r,r):r()}})}function w(e,t,n){var r="suspendedStart";return function(a,s){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw s;return S()}for(n.method=a,n.arg=s;;){var o=n.delegate;if(o){var i=b(o,n);if(i){if(i===d)continue;return i}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function b(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=l(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,d;var s=a.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function N(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return g.prototype=h,r(I,"constructor",{value:h,configurable:!0}),r(h,"constructor",{value:g,configurable:!0}),g.displayName=c(h,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},e.awrap=function(e){return{__await:e}},v(y.prototype),c(y.prototype,i,(function(){return this})),e.AsyncIterator=y,e.async=function(t,n,r,a,s){void 0===s&&(s=Promise);var o=new y(p(t,n,r,a),s);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},v(I),c(I,u,"Generator"),c(I,o,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=N,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var i=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(i&&u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(i){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var s=a;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;k(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:N(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function o(e,t,n,r,a,s,o){try{var i=e[s](o),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function i(e){o(s,r,a,i,u,"next",e)}function u(e){o(s,r,a,i,u,"throw",e)}i(void 0)}))}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function p(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t,n){return(t=b(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function h(e,t,n){return h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&g(a,n.prototype),a},h.apply(null,arguments)}function m(e){var t="function"==typeof Map?new Map:void 0;return m=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return h(e,arguments,f(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),g(r,e)},m(e)}function A(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],u=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=v(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw s}}}}function b(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var T=function(e){return e.SwapRouterStaleDataError="SwapRouterStaleDataError",e.SwapRouterNoRouteError="SwapRouterNoRouteError",e.SwapRouterLowSwapAmountError="SwapRouterLowSwapAmountError",e.SwapRouterInsufficientReservesError="SwapRouterInsufficientReservesError",e.SwapRouterPoolHasNoLiquidityError="SwapRouterPoolHasNoLiquidityError",e.NoAvailablePoolError="NoAvailablePoolError",e.OutputAmountExceedsAvailableLiquidityError="OutputAmountExceedsAvailableLiquidityError",e.UnknownError="UnknownError",e.LowSwapAmountError="LowSwapAmountError",e.AssetDoesNotBelongToPoolError="AssetDoesNotBelongToPoolError",e.InvalidSwapTypeError="InvalidSwapTypeError",e}({}),k=function(e){function t(e,n){var r,a,s,o;return u(this,t),a=this,o=[n],s=f(s=t),(r=A(a,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(s,o||[],f(a).constructor):s.apply(a,o))).type=e,r.message=n,Error.captureStackTrace&&Error.captureStackTrace(r,t),r}return d(t,m(Error)),p(t)}(),E=Uint8Array.from([1]),N=100000n,S=100000n,P=100000n,D=50000n,_=28500n,B=1000n,O=1e3,R={mainnet:{base:"https://mainnet.analytics.tinyman.org/api",v1:"https://mainnet.analytics.tinyman.org/api/v1"},testnet:{base:"https://testnet.analytics.tinyman.org/api",v1:"https://testnet.analytics.tinyman.org/api/v1"}};var F="- would result negative",C="logic eval error:",Q="exceeds schema integer count",L=/transaction \w+:/,V=function(e){function t(e,n){var r;u(this,t);for(var a=arguments.length,s=new Array(a>2?a-2:0),o=2;o<a;o++)s[o-2]=arguments[o];r=function(e,t,n){return t=f(t),A(e,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(t,n||[],f(e).constructor):t.apply(e,n))}(this,t,[].concat(s));var i=r.extractMessageFromAlgoSDKError(e);return r.data=e,r.type=r.getErrorType(i),r.setMessage(r.getErrorMessage(i,r.type,n)),r}return d(t,m(Error)),p(t,[{key:"setMessage",value:function(e){this.message=e}},{key:"getErrorType",value:function(e){var t="Unknown";return e.includes(F)?t="SlippageTolerance":e.includes(Q)?t="ExceedingExcessAmountCount":e.includes(C)?t="LogicError":e.match(L)&&(t="TransactionError"),t}},{key:"getErrorMessage",value:function(e,t,n){var r;switch(t){case"SlippageTolerance":r="The process failed due to too much slippage in the price. Please adjust the slippage tolerance and try again.";break;case"ExceedingExcessAmountCount":r="The process failed due to the number of excess amounts accumulated for your account in the Tinyman app.";break;case"LogicError":r=e.split(C)[1];break;case"TransactionError":r=e.split(L)[1];break;case"Unknown":e&&(r=e)}return r||(r=n||"We encountered an unexpected error, try again later."),r.trim()}},{key:"extractMessageFromAlgoSDKError",value:function(e){var t,n,r="";return null!=e&&null!==(t=e.response)&&void 0!==t&&null!==(t=t.body)&&void 0!==t&&t.message?r=e.response.body.message:null!=e&&null!==(n=e.response)&&void 0!==n&&n.text?r=e.response.text:"string"==typeof(null==e?void 0:e.message)&&(r=this.isMessageObjectString(null==e?void 0:e.message)?JSON.parse(e.message||"{message: ''}").message:e.message),"string"!=typeof r&&(r=String(r)),r}},{key:"isMessageObjectString",value:function(e){return"string"==typeof e&&e.includes("{message:")}}])}();function U(t){var n,r=t.stateArray,a=void 0===r?[]:r,s=t.shouldDecodeKeys,o=void 0!==s&&s,i={},u=w(a);try{for(u.s();!(n=u.n()).done;){var c=n.value,p=c.key,l=void 0;if(1==c.value.type)l=c.value.bytes;else{if(2!=c.value.type)throw new Error("Unexpected state type: ".concat(c.value.type));l=c.value.uint}i[o?Buffer.from(p).toString():e.bytesToBase64(p)]=l}}catch(e){u.e(e)}finally{u.f()}return i}function M(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=t.reduce((function(e,t){return e+t.length}),0),a=new Uint8Array(r),s=0,o=0,i=t;o<i.length;o++){var u=i[o];a.set(u,s),s+=u.length}return a}function j(e){return new Promise((function(t){setTimeout((function(){t(null)}),e)}))}function G(e,t){return X.apply(this,arguments)}function X(){return(X=i(s().mark((function e(t,n){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,j(1e3);case 3:return r=null,e.prev=4,e.next=7,t.pendingTransactionInformation(n).do();case 7:r=e.sent,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:if(!r){e.next=17;break}if(!r.confirmedRound){e.next=15;break}return e.abrupt("return",r);case 15:if(!r.poolError){e.next=17;break}throw new Error("Transaction Rejected: ".concat(r.poolError));case 17:e.next=0;break;case 19:case"end":return e.stop()}}),e,null,[[4,10]])})))).apply(this,arguments)}function W(e,t,n){if(t>1||t<0)throw new Error("Invalid slippage value. Must be between 0 and 1, got ".concat(t));var r;try{var a="negative"===e?1-t:1+t;r=BigInt(Math.floor(Number(n)*a))}catch(e){throw new Error(e.message)}return r}function z(e,t){var n=Number(e);return Y({decimalPlaces:n},Math.pow(10,-n)*Number(t))}function Y(e,t){var n=e.decimalPlaces,r=void 0===n?0:n;if(r>0){var a=x(q(t),2),s=a[0],o=a[1],i=x(q(Math.round(Number(J(s,o+r)))),2),u=i[0],c=i[1];return Number(J(u,c-r))}return Math.round(t)}function J(e,t){return e+(t<0?"e".concat(t):"e+".concat(t))}function q(e){if(e.toString().includes("e")){var t=e.toString().split("e");return[parseFloat(t[0]),parseFloat(t[1])]}return[e,0]}function Z(e,t){return H.apply(this,arguments)}function H(){return(H=i(s().mark((function e(t,n){var r,a,o,i,u,c,p,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=[],a=w(n),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=18;break}return i=o.value,e.next=9,t.sendRawTransaction(i).do();case 9:return u=e.sent,c=u.txid,e.next=13,G(t,c);case 13:p=e.sent,l=Number(p.confirmedRound),r.push({confirmedRound:l,txnID:c});case 16:e.next=5;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(3),a.e(e.t0);case 23:return e.prev=23,a.f(),e.finish(23);case 26:return e.abrupt("return",r);case 29:throw e.prev=29,e.t1=e.catch(0),new V(e.t1,"We encountered an error while processing this transaction. Try again later.");case 32:case"end":return e.stop()}}),e,null,[[0,29],[3,20,23,26]])})))).apply(this,arguments)}function K(e){return e.reduce((function(e,t){return e+Number(t.txn.fee)}),0)}function $(e){var t,n;return(n=null===(t=e[0].txn.group)||void 0===t?void 0:t.buffer)?Buffer.from(n).toString("base64"):""}function ee(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=new Uint8Array(t),r=BigInt(e),a=t-1;a>=0;a--)n[a]=Number(r&BigInt(255)),r>>=BigInt(8);return n}function te(e){for(var t=[];;){var n=Number(e&BigInt(127));if(!(e>>=BigInt(7))){t.push(n);break}t.push(128|n)}return t}function ne(e){return(new TextEncoder).encode(e)}var re=function(e){return e.FixedInput="fixed-input",e.FixedOutput="fixed-output",e}({}),ae=.003,se={V1_1:"v1_1",V2:"v2"},oe=new(function(){return p((function e(){u(this,e),this.clientName="tinyman-js-sdk"}),[{key:"getClientName",value:function(){return this.clientName}},{key:"setClientName",value:function(e){this.clientName=e}},{key:"getAppCallTxnNoteWithClientName",value:function(e,t){var n=e===se.V1_1?"v1":e,r=JSON.stringify(a({origin:this.clientName},t));return ne("tinyman/".concat(n,":j").concat(r))}}])}());function ie(e){return ue.apply(this,arguments)}function ue(){return(ue=i(s().mark((function t(n){var r,a,o,i,u,c;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.initiatorAddr,a=n.client,(o=n.route).transactions&&o.transaction_fee){t.next=3;break}return t.abrupt("return",[]);case 3:return t.next=5,a.getTransactionParams().do();case 5:return i=t.sent,u=[],o.transactions.forEach((function(e){u.push(ce(e,i,r))})),u[0].fee=BigInt(o.transaction_fee),c=e.assignGroupID(u),t.abrupt("return",c.map((function(e){return{txn:e,signers:[r]}})));case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ce(n,r,a){var s;switch(n.type){case e.TransactionType.pay:return(s=e.makePaymentTxnWithSuggestedParamsFromObject({sender:a,receiver:n.receiver,amount:n.amount,suggestedParams:r})).fee=0n,s;case e.TransactionType.axfer:return(s=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:a,receiver:n.receiver,amount:n.amount,assetIndex:n.asset_id,suggestedParams:r})).fee=0n,s;case e.TransactionType.appl:var o,i=null===(o=n.args)||void 0===o?void 0:o.map(t.toByteArray),u=n.args&&"swap"===Buffer.from(n.args[0],"base64").toString("utf8");return(s=e.makeApplicationNoOpTxnFromObject({sender:a,appIndex:n.app_id,appArgs:i,accounts:n.accounts,foreignApps:n.apps,foreignAssets:n.assets,suggestedParams:r,note:u?oe.getAppCallTxnNoteWithClientName(se.V2):void 0})).fee=0n,s;default:throw new Error("Unknown transaction type: ".concat(n.type))}}function pe(e){return le.apply(this,arguments)}function le(){return(le=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d,f,g;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.amount,i=t.assetInID,u=t.assetOutID,c=t.swapType,p=t.network,l=t.slippage,d={asset_in_id:String(i),asset_out_id:String(u),swap_type:c,input_amount:c===re.FixedInput?String(o):void 0,output_amount:c===re.FixedOutput?String(o):void 0,slippage:l},e.next=4,fetch("".concat(R[p].v1,"/swap-router/quotes-v2/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}).catch((function(){throw new Error("Network error")}));case 4:return f=e.sent,e.next=7,f.json();case 7:if(g=e.sent,f.ok){e.next=14;break}if(s=g,!Boolean(s)||void 0===s.fallback_message){e.next=13;break}throw new k(g.type,g.fallback_message);case 13:throw new k(T.UnknownError,"There was an error while getting a quote from Swap Router");case 14:if(null!==(n=g.transactions)&&void 0!==n&&n.length){e.next=16;break}throw new k(T.SwapRouterNoRouteError,"Swap router couldn't find a route for this swap.");case 16:if(!(Number(g.asset_in.id)!==i||Number(g.asset_out.id)!==u||g.swap_type===re.FixedInput?BigInt(o)!==BigInt(null!==(r=g.input_amount)&&void 0!==r?r:0):BigInt(o)!==BigInt(null!==(a=g.output_amount)&&void 0!==a?a:0))){e.next=18;break}throw new k(T.UnknownError,"Swap router quote doesn't match the requested swap. Please try again.");case 18:return e.abrupt("return",g);case 19:case"end":return e.stop()}var s}),e)})))).apply(this,arguments)}var de={testnet:184778019,mainnet:1083651166};function fe(e){var t=me(e),n=t.assetIn,r=t.assetOut;return z(r.asset.decimals,Number(r.amount))/z(n.asset.decimals,Number(n.amount))}function ge(e){var t;return{asset:e.asset_out,amount:BigInt(null!==(t=e.output_amount)&&void 0!==t?t:0)}}function he(e){var t;return{asset:e.asset_in,amount:BigInt(null!==(t=e.input_amount)&&void 0!==t?t:0)}}function me(e){return{assetIn:he(e),assetOut:ge(e)}}l(l({},re.FixedInput,7),re.FixedOutput,8);var Ae=0,xe={id:"".concat(Ae),name:"Algorand",unit_name:"ALGO",decimals:6,url:"https://algorand.org",is_liquidity_token:!1,total_amount:"6615503326932151",clawback_address:""},Ie={V1:"TM1POOL",V1_1:"TMPOOL11",V2:"TMPOOL2"},ve={testnet:258703304,mainnet:22e8},ye={testnet:724519992,mainnet:2537013734},we={testnet:724676936,mainnet:2537023208};function be(e){return Te.apply(this,arguments)}function Te(){return(Te=i(s().mark((function t(n){var r,a,o,i,u;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.assetID,o=n.initiatorAddr,t.prev=1,t.next=4,r.getTransactionParams().do();case 4:return i=t.sent,u=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:o,receiver:o,assetIndex:a,amount:0,suggestedParams:i}),t.abrupt("return",[{txn:u,signers:[o]}]);case 9:throw t.prev=9,t.t0=t.catch(1),new V(t.t0,"We encountered something unexpected while opting into this asset. Try again later.");case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))).apply(this,arguments)}function ke(e,t){var n=Number(e.id),r=Number(t.id);return n>r?[a(a({},e),{},{id:n}),a(a({},t),{},{id:r})]:[a(a({},t),{},{id:r}),a(a({},e),{},{id:n})]}function Ee(e,t){var n=[e,t];return[Math.max.apply(Math,n),Math.min.apply(Math,n)]}function Ne(e){return Number(e)===Ae}function Se(e){return Number(e.id)}var Pe=function(e){return e.Direct="direct",e.Router="router",e}({}),De=4;var _e=function(e){return e[e.INPUT_TXN=0]="INPUT_TXN",e[e.APP_CALL_TXN=1]="APP_CALL_TXN",e}({}),Be=l(l({},re.FixedInput,1),re.FixedOutput,2),Oe=2,Re=ne("swap"),Fe=l(l({},re.FixedInput,ne("fixed-input")),re.FixedOutput,ne("fixed-output"));function Ce(e,t){return BigInt(Be[e]+Oe)*t}function Qe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;return Math.ceil(1/e)}function Le(e){return e<Qe(arguments.length>1&&void 0!==arguments[1]?arguments[1]:ae)}function Ve(e,t){return BigInt(Be[e]+1)*t}function Ue(e){var t=e.assetIn,n=e.assetOut;return z(n.decimals,Number(n.amount))/z(t.decimals,Number(t.amount))}function Me(e){var t=e.inputSupply,n=e.outputSupply,r=e.assetIn,a=e.assetOut,s=Ue({assetIn:r,assetOut:a}),o=z(a.decimals,Number(n))/z(r.decimals,Number(t));return Y({decimalPlaces:5},Math.abs(s/o-1))}function je(e){if(e.type===Pe.Router){var t=he(e.data);return{id:Se(t.asset),amount:t.amount}}return{id:e.data.quote.assetInID,amount:e.data.quote.assetInAmount}}function Ge(e){if(e.type===Pe.Router){var t=ge(e.data);return{id:Se(t.asset),amount:t.amount}}return{id:e.data.quote.assetOutID,amount:e.data.quote.assetOutAmount}}function Xe(e){return e.type===Pe.Direct?e.data.pool.contractVersion:se.V2}function We(e){return e.type===Pe.Direct?e.data.quote.rate:fe(e.data)}function ze(e){for(var t=e[0],n=We(t),r=1;r<e.length;r++){var a=e[r],s=We(a);s>n&&(t=a,n=s)}return t}function Ye(e){return e instanceof k&&[T.SwapRouterInsufficientReservesError,T.SwapRouterLowSwapAmountError,T.OutputAmountExceedsAvailableLiquidityError,T.LowSwapAmountError].includes(e.type)}ne("asset_opt_in");var Je={type:"logicsig",logic:{bytecode:"BCAIAQCBgICAgICAgPABgICAgICAgIDwAQMEBQYlJA1EMQkyAxJEMRUyAxJEMSAyAxJEMgQiDUQzAQAxABJEMwEQIQcSRDMBGIGCgICAgICAgPABEkQzARkiEjMBGyEEEhA3ARoAgAlib290c3RyYXASEEAAXDMBGSMSRDMBG4ECEjcBGgCABHN3YXASEEACOzMBGyISRDcBGgCABG1pbnQSQAE7NwEaAIAEYnVybhJAAZg3ARoAgAZyZWRlZW0SQAJbNwEaAIAEZmVlcxJAAnkAIQYhBSQjEk0yBBJENwEaARclEjcBGgIXJBIQRDMCADEAEkQzAhAhBBJEMwIhIxJEMwIiIxwSRDMCIyEHEkQzAiQjEkQzAiWACFRNUE9PTDExEkQzAiZRAA+AD1RpbnltYW5Qb29sMS4xIBJEMwIngBNodHRwczovL3RpbnltYW4ub3JnEkQzAikyAxJEMwIqMgMSRDMCKzIDEkQzAiwyAxJEMwMAMQASRDMDECEFEkQzAxElEkQzAxQxABJEMwMSIxJEJCMTQAAQMwEBMwIBCDMDAQg1AUIBsTMEADEAEkQzBBAhBRJEMwQRJBJEMwQUMQASRDMEEiMSRDMBATMCAQgzAwEIMwQBCDUBQgF8MgQhBhJENwEcATEAE0Q3ARwBMwQUEkQzAgAxABNEMwIUMQASRDMDADMCABJEMwIRJRJEMwMUMwMHMwMQIhJNMQASRDMDESMzAxAiEk0kEkQzBAAxABJEMwQUMwIAEkQzAQEzBAEINQFCAREyBCEGEkQ3ARwBMQATRDcBHAEzAhQSRDMDFDMDBzMDECISTTcBHAESRDMCADEAEkQzAhQzBAASRDMCESUSRDMDADEAEkQzAxQzAwczAxAiEk0zBAASRDMDESMzAxAiEk0kEkQzBAAxABNEMwQUMQASRDMBATMCAQgzAwEINQFCAJAyBCEFEkQ3ARwBMQATRDMCADcBHAESRDMCADEAE0QzAwAxABJEMwIUMwIHMwIQIhJNMQASRDMDFDMDBzMDECISTTMCABJEMwEBMwMBCDUBQgA+MgQhBBJENwEcATEAE0QzAhQzAgczAhAiEk03ARwBEkQzAQEzAgEINQFCABIyBCEEEkQzAQEzAgEINQFCAAAzAAAxABNEMwAHMQASRDMACDQBD0M=",address:"ABUKAXTANWR6K6ZYV75DWJEPVWWOU6SFUVRI6QHO44E4SIDLHBTD2CZ64A",size:881,variables:[{name:"TMPL_ASSET_ID_1",type:"int",index:15,length:10},{name:"TMPL_ASSET_ID_2",type:"int",index:5,length:10},{name:"TMPL_VALIDATOR_APP_ID",type:"int",index:74,length:10}],source:"https://github.com/tinymanorg/tinyman-contracts-v1/tree/dc9ab40c58b85c15d58f63a1507e18be76720dbb/contracts/pool_logicsig.teal.tmpl"},name:"pool_logicsig"},qe={type:"app",global_state_schema:{num_uints:0,num_byte_slices:0},local_state_schema:{num_uints:16,num_byte_slices:0},name:"validator_app"},Ze=l(l({},se.V1_1,{testnet:62368684,mainnet:552635992}),se.V2,{testnet:148607e3,mainnet:1002541853});function He(e,t){var n=Ze[t][e];if(!n)throw new Error("No Validator App exists for ".concat(e," network with ").concat(t," contract version"));return n}function Ke(){return(Ke=i(s().mark((function t(n){var r,a,o,i,u,c;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.network,o=n.contractVersion,i=n.initiatorAddr,t.next=3,r.getTransactionParams().do();case 3:return u=t.sent,c=e.makeApplicationOptInTxnFromObject({sender:i,appIndex:He(a,o),note:oe.getAppCallTxnNoteWithClientName(o),suggestedParams:u}),t.abrupt("return",[{txn:c,signers:[i]}]);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $e(){return($e=i(s().mark((function t(n){var r,a,o,i,u,c;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.network,o=n.contractVersion,i=n.initiatorAddr,t.next=3,r.getTransactionParams().do();case 3:return u=t.sent,c=e.makeApplicationClearStateTxnFromObject({sender:i,appIndex:He(a,o),note:oe.getAppCallTxnNoteWithClientName(o),suggestedParams:u}),t.abrupt("return",[{txn:c,signers:[i]}]);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var et=p((function e(t){u(this,e),this.schema={numLocalInts:t.local_state_schema.num_uints,numLocalByteSlices:t.local_state_schema.num_byte_slices,numGlobalInts:t.global_state_schema.num_uints,numGlobalByteSlices:t.global_state_schema.num_byte_slices}}));var tt=function(n){function r(e,t){var n,a,s,o;return u(this,r),a=this,o=[e],s=f(s=r),(n=A(a,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(s,o||[],f(a).constructor):s.apply(a,o))).poolLogicSigContractTemplate=t.logic.bytecode,n.templateVariables=t.logic.variables,n}return d(r,et),p(r,[{key:"generateLogicSigAccountForPool",value:function(n){if(n.asset1ID===n.asset2ID)throw new Error("Assets are the same");var r=He(n.network,se.V1_1),a=x(Ee(n.asset1ID,n.asset2ID),2),s=a[0],o=a[1],i=Array.from(t.toByteArray(this.poolLogicSigContractTemplate)),u={asset_id_1:s,asset_id_2:o,validator_app_id:r},c=0;this.templateVariables.sort((function(e,t){return e.index-t.index}));for(var p=0;p<this.templateVariables.length;p++){var l=this.templateVariables[p],d=u[l.name.split("TMPL_")[1].toLowerCase()],f=l.index-c,g=f+l.length,h=te(BigInt(d));c+=l.length-h.length,i=i.slice(0,f).concat(h).concat(i.slice(g))}var m=new Uint8Array(i);return new e.LogicSigAccount(m)}}])}(),nt=new tt(qe,Je),rt={type:"logicsig",logic:{bytecode:"BoAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgQBbNQA0ADEYEkQxGYEBEkSBAUM="},name:"pool_logicsig"},at={type:"app",global_state_schema:{num_uints:0,num_byte_slices:3},local_state_schema:{num_uints:12,num_byte_slices:2},name:"validator_app"};var st=new(function(t){function n(e,t){var r,a,s,o;return u(this,n),a=this,o=[e],s=f(s=n),(r=A(a,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(s,o||[],f(a).constructor):s.apply(a,o))).poolLogicSigContractTemplate=t.logic.bytecode,r}return d(n,et),p(n,[{key:"generateLogicSigAccountForPool",value:function(t){if(t.asset1ID===t.asset2ID)throw new Error("Assets are the same");var n=He(t.network,se.V2),r=x(Ee(t.asset1ID,t.asset2ID),2),a=r[0],s=r[1],o={bytes:Array.from(Buffer.from(this.poolLogicSigContractTemplate,"base64")),validatorAppId:Array.from(e.encodeUint64(n)),asset1ID:Array.from(e.encodeUint64(a)),asset2ID:Array.from(e.encodeUint64(s))},i=[].concat(I(o.bytes.slice(0,3)),I(o.validatorAppId.slice(0,8)),I(o.asset1ID.slice(0,8)),I(o.asset2ID.slice(0,8)),I(o.bytes.slice(27)));return new e.LogicSigAccount(new Uint8Array(i))}}])}())(at,rt);function ot(e){return function(e){return e===se.V2}(e)?st:nt}function it(e,t){var n,r=null===(n=e.appsLocalState)||void 0===n?void 0:n.find((function(e){return e.id===BigInt(t)}));return r&&r.keyValue?U({stateArray:r.keyValue,shouldDecodeKeys:!0}):null}var ut=ne("e");function ct(e){return pt.apply(this,arguments)}function pt(){return(pt=i(s().mark((function n(r){var a,o,i,u,c,p,l,d,f,g,h,m,A,x,I,v,y,b,T,k,E;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=r.client,o=r.pool,i=r.accountAddr,n.next=3,a.accountInformation(i).do();case 3:u=n.sent,c=u.appsLocalState,p=0n,l=0n,d=0n,f=o.account.address(),g=w(null!=c?c:[]),n.prev=10,g.s();case 12:if((h=g.n()).done){n.next=31;break}if((m=h.value).id==BigInt(o.validatorAppID)){n.next=16;break}return n.abrupt("continue",29);case 16:if(A=m.keyValue){n.next=19;break}return n.abrupt("break",31);case 19:x=U({stateArray:A}),I=t.fromByteArray(M(f.publicKey,ut,e.encodeUint64(o.asset1ID))),v=t.fromByteArray(M(f.publicKey,ut,e.encodeUint64(o.asset2ID))),y=t.fromByteArray(M(f.publicKey,ut,e.encodeUint64(o.poolTokenID))),b=x[I],T=x[v],k=x[y],"bigint"==typeof b&&(p=b),"bigint"==typeof T&&(l=T),"bigint"==typeof k&&(d=k);case 29:n.next=12;break;case 31:n.next=36;break;case 33:n.prev=33,n.t0=n.catch(10),g.e(n.t0);case 36:return n.prev=36,g.f(),n.finish(36);case 39:if(!((E={excessAsset1:p,excessAsset2:l,excessPoolTokens:d}).excessAsset1<0n||E.excessAsset2<0n||E.excessPoolTokens<0n)){n.next=42;break}throw new Error("Invalid account excess: ".concat(E));case 42:return n.abrupt("return",E);case 43:case"end":return n.stop()}}),n,null,[[10,33,36,39]])})))).apply(this,arguments)}function lt(){return(lt=i(s().mark((function n(r){var a,o,i,u,c,p,l,d,f,g,h,m,A,I,v;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=r.client,o=r.accountAddr,i=r.validatorAppID,n.next=3,a.accountInformation(o).do();case 3:if(u=n.sent,c=u.appsLocalState,p=null==c?void 0:c.find((function(e){return e.id==i})),l=[],p&&p.keyValue)for(d=U({stateArray:p.keyValue}),f=0,g=Object.entries(d);f<g.length;f++)h=g[f],m=x(h,2),A=m[0],I=m[1],41===(v=t.toByteArray(A)).length&&101===v[32]&&l.push({poolAddress:e.encodeAddress(v.slice(0,32)),assetID:e.decodeUint64(v.slice(33,41),"safe"),amount:BigInt(parseInt(I))});return n.abrupt("return",l);case 9:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var dt=function(e){return e.NOT_CREATED="not created",e.BOOTSTRAP="bootstrap",e.READY="ready",e.ERROR="error",e}({}),ft=l(l({},se.V1_1,{asset1:"a1",asset2:"a2"}),se.V2,{asset1:"asset_1_id",asset2:"asset_2_id",poolTokenID:"pool_token_asset_id",issuedPoolTokens:"issued_pool_tokens",asset1Reserves:"asset_1_reserves",asset2Reserves:"asset_2_reserves",asset1ProtocolFees:"asset_1_protocol_fees",asset2ProtocolFees:"asset_2_protocol_fees",totalFeeShare:"total_fee_share",protocolFeeRatio:"protocol_fee_ratio",cumulativePriceUpdateTimeStamp:"cumulative_price_update_timestamp"}),gt=1e3,ht=ne("o"),mt=0xffffffffffffffffn;function At(e){return xt.apply(this,arguments)}function xt(){return(xt=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d,f,g,h,m;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.client,a=t.network,o=t.asset1ID,i=t.asset2ID,u=ot(se.V1_1),c=u.generateLogicSigAccountForPool(t),p=He(a,se.V1_1),l=c.address(),d=Ee(o,i),e.next=8,r.accountInformation(l.toString()).do();case 8:return f=e.sent,g=it(f,p),h=null!==(n=f.createdAssets)&&void 0!==n&&n.length?Number(f.createdAssets[0].index):void 0,m={account:c,validatorAppID:p,asset1ID:d[0],asset2ID:d[1],status:g||h?dt.READY:dt.NOT_CREATED,contractVersion:se.V1_1,poolTokenID:h},g&&(m.asset1ID=Number(g[ft.v1_1.asset1]),m.asset2ID=Number(g[ft.v1_1.asset2])),e.abrupt("return",m);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function It(){return(It=i(s().mark((function n(r,a){var o,i,u,c,p,l,d,f,g,h,m,A,x,I,v,y,b,T,k,E,N,S,P,D,_,B;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.accountInformation(a.account.address()).do();case 2:if(o=n.sent,i=o.appsLocalState,u=o.assets,c=0n,p=0n,l=0n,i){n.next=9;break}throw new Error("State of the pool account is not found");case 9:if(u){n.next=11;break}throw new Error("Assets are not defined for this pool");case 11:d=w(i),n.prev=12,d.s();case 14:if((f=d.n()).done){n.next=33;break}if((g=f.value).id==BigInt(a.validatorAppID)){n.next=18;break}return n.abrupt("continue",31);case 18:if(h=g.keyValue){n.next=21;break}return n.abrupt("break",33);case 21:m=U({stateArray:h}),A=t.fromByteArray(M(ht,e.encodeUint64(a.asset1ID))),x=t.fromByteArray(M(ht,e.encodeUint64(a.asset2ID))),I=t.fromByteArray(M(ht,e.encodeUint64(a.poolTokenID))),v=m[A],y=m[x],b=m[I],"bigint"==typeof v&&(c=v),"bigint"==typeof y&&(p=y),"bigint"==typeof b&&(l=b);case 31:n.next=14;break;case 33:n.next=38;break;case 35:n.prev=35,n.t0=n.catch(12),d.e(n.t0);case 38:return n.prev=38,d.f(),n.finish(38);case 41:T=0n,k=0n,E=0n,N=w(u);try{for(N.s();!(S=N.n()).done;)P=S.value,D=Number(P.assetId),_=P.amount,D==a.asset1ID?T=_:D==a.asset2ID?k=_:D==a.poolTokenID&&(E=_)}catch(e){N.e(e)}finally{N.f()}if(0===a.asset2ID&&(k=o.amount-o.minBalance)<0n&&(k=0n),!((B={asset1:T-c,asset2:k-p,issuedLiquidity:mt-E+l,round:o.round}).asset1<0n||B.asset2<0n)){n.next=50;break}throw new Error("The pool reserves are below zero. The manager of one of the assets has used clawback to remove assets from this pool. Do not interact with the pool.");case 50:if(!(B.issuedLiquidity<0n||B.issuedLiquidity>mt)){n.next=52;break}throw new Error("Issued liquidity value is out of the expected range ([0n, ".concat(mt,"]): ").concat(B.issuedLiquidity));case 52:return n.abrupt("return",B);case 53:case"end":return n.stop()}}),n,null,[[12,35,38,41]])})))).apply(this,arguments)}function vt(){return vt=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.client,r=t.address,a=t.network,!(o=d.length>1&&void 0!==d[1]?d[1]:{})[r]){e.next=4;break}return e.abrupt("return",o[r]);case 4:return e.next=6,n.accountInformation(r).do();case 6:return i=e.sent,u=it(i,He(a,se.V1_1)),c=null,u&&(l=i.createdAssets[0],p=Number(l.index),c={asset1ID:Number(u[ft[se.V1_1].asset1]),asset2ID:Number(u[ft[se.V1_1].asset2]),poolTokenID:p},o[r]=c),e.abrupt("return",c);case 11:case"end":return e.stop()}}),e)}))),vt.apply(this,arguments)}var yt=Object.freeze({__proto__:null,getPoolAssets:function(e){return vt.apply(this,arguments)},getPoolInfo:At,getPoolReserves:function(e,t){return It.apply(this,arguments)}});function wt(e){return bt.apply(this,arguments)}function bt(){return(bt=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d,f,g;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.network,a=t.asset1ID,o=t.asset2ID,i=ot(se.V2),u=i.generateLogicSigAccountForPool(t),c=He(r,se.V2),p=u.address(),l=Ee(a,o),e.next=8,n.accountInformation(p).do();case 8:return d=e.sent,f=it(d,c),g={account:u,validatorAppID:c,asset1ID:l[0],asset2ID:l[1],status:f?dt.READY:dt.NOT_CREATED,contractVersion:se.V2},f&&(g.asset1ProtocolFees=BigInt(f[ft.v2.asset1ProtocolFees]),g.asset2ProtocolFees=BigInt(f[ft.v2.asset2ProtocolFees]),g.asset1Reserves=BigInt(f[ft.v2.asset1Reserves]),g.asset2Reserves=BigInt(f[ft.v2.asset2Reserves]),g.issuedPoolTokens=BigInt(f[ft.v2.issuedPoolTokens]),g.cumulativePriceUpdateTimeStamp=Number(f[ft.v2.cumulativePriceUpdateTimeStamp]),g.protocolFeeRatio=Number(f[ft.v2.protocolFeeRatio]),g.totalFeeShare=BigInt(f[ft.v2.totalFeeShare]),g.poolTokenID=Number(f[ft.v2.poolTokenID]),g.asset1ID=Number(f[ft.v2.asset1]),g.asset2ID=Number(f[ft.v2.asset2])),e.abrupt("return",g);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tt(){return(Tt=i(s().mark((function e(t,n){var r,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.accountInformation(n.account.address()).do();case 2:return r=e.sent,a=it(r,n.validatorAppID),o={asset1:0n,asset2:0n,issuedLiquidity:0n,round:r.round},a&&(o.asset1=BigInt(a[ft.v2.asset1Reserves]),o.asset2=BigInt(a[ft.v2.asset2Reserves]),o.issuedLiquidity=BigInt(a[ft.v2.issuedPoolTokens])),e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kt(){return(kt=i(s().mark((function e(t){var n,r,a,o,i,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.address,a=t.network,e.next=3,n.accountInformation(r).do();case 3:return o=e.sent,i=it(o,He(a,se.V2)),u=null,i&&(u={asset1ID:i[ft[se.V2].asset1],asset2ID:i[ft[se.V2].asset2],poolTokenID:i[ft[se.V2].poolTokenID]}),e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Et=Object.freeze({__proto__:null,getPoolAssets:function(e){return kt.apply(this,arguments)},getPoolInfo:wt,getPoolReserves:function(e,t){return Tt.apply(this,arguments)}});function Nt(e){return Boolean(e&&!(e.asset1+e.asset2))}var St=Object.freeze({__proto__:null,getPoolPairRatio:function(e){var t=Nt(e),n=null;return e&&!t&&e.asset1&&e.asset2&&(n=Number(e.asset1)/Number(e.asset2)),n},getPoolShare:function(e,t){var n=Number(t)/Number(e);return Number.isFinite(n)||(n=0),n},getPoolsForPair:function(e){return Promise.all([At(e),wt(e)])},isPoolEmpty:Nt,isPoolNotCreated:function(e){return(null==e?void 0:e.status)===dt.NOT_CREATED},isPoolReady:function(e){return(null==e?void 0:e.status)===dt.READY}}),Pt=a(l(l({},se.V1_1,a(a({},yt),St)),se.V2,a(a({},Et),St)),St),Dt=function(e){return e[e.FUNDING_TXN=0]="FUNDING_TXN",e[e.VALIDATOR_APP_CALL=1]="VALIDATOR_APP_CALL",e[e.POOL_TOKEN_CREATE=2]="POOL_TOKEN_CREATE",e[e.ASSET1_OPT_IN=3]="ASSET1_OPT_IN",e[e.ASSET2_OPT_IN=4]="ASSET2_OPT_IN",e}({}),_t={ASA_ALGO:960000n,ASA_ASA:859000n};function Bt(){return(Bt=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h,m,A,I,v,y,w,b,T,k,E,N,S,P;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.network,o=n.asset_1,i=n.asset_2,u=n.initiatorAddr,t.next=3,r.getTransactionParams().do();case 3:return c=t.sent,p=ke(o,i),l=x(p,2),d=l[0],f=d.id,g=d.unit_name,h=l[1],m=h.id,A=h.unit_name,I=Ne(m),v=He(a,se.V1_1),y=nt.generateLogicSigAccountForPool({network:a,asset1ID:f,asset2ID:m}),w=y.address(),b=e.makeApplicationOptInTxnFromObject({sender:w,appIndex:v,note:oe.getAppCallTxnNoteWithClientName(se.V1_1),appArgs:[ne("bootstrap"),e.encodeUint64(f),e.encodeUint64(m)],foreignAssets:I?[f]:[m],suggestedParams:c}),T=e.makeAssetCreateTxnWithSuggestedParamsFromObject({sender:w,total:0xffffffffffffffffn,decimals:6,defaultFrozen:!1,unitName:Ie.V1_1,assetName:"TinymanPool1.1 ".concat(g,"-").concat(A),assetURL:"https://tinyman.org",suggestedParams:c}),k=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:w,receiver:w,assetIndex:f,amount:0,suggestedParams:c}),E=e.makePaymentTxnWithSuggestedParamsFromObject({sender:u,receiver:w,amount:Ot(I),suggestedParams:c}),(N=[])[Dt.FUNDING_TXN]=E,N[Dt.VALIDATOR_APP_CALL]=b,N[Dt.POOL_TOKEN_CREATE]=T,N[Dt.ASSET1_OPT_IN]=k,I||(N[Dt.ASSET2_OPT_IN]=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:w,receiver:w,assetIndex:m,amount:0,suggestedParams:c})),S=e.assignGroupID(N),P=[{txn:S[Dt.FUNDING_TXN],signers:[u]},{txn:S[Dt.VALIDATOR_APP_CALL],signers:[w.toString()]},{txn:S[Dt.POOL_TOKEN_CREATE],signers:[w.toString()]},{txn:S[Dt.ASSET1_OPT_IN],signers:[w.toString()]}],S[Dt.ASSET2_OPT_IN]&&P.push({txn:S[Dt.ASSET2_OPT_IN],signers:[w.toString()]}),t.abrupt("return",P);case 23:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ot(e){return e?_t.ASA_ALGO:_t.ASA_ASA}function Rt(){return(Rt=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h,m,A,I;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.txGroup,a=n.network,o=n.initiatorSigner,i=n.asset1ID,u=n.asset2ID,t.next=3,o([r]);case 3:return c=t.sent,p=x(c,1),l=p[0],d=Ee(i,u),f=x(d,2),g=f[0],h=f[1],m=nt.generateLogicSigAccountForPool({network:a,asset1ID:g,asset2ID:h}),A=[],I=r.map((function(t,n){if(n===Dt.FUNDING_TXN)return A.push(t.txn.txID().toString()),l;var r=e.signLogicSigTransactionObject(t.txn,m),a=r.txID,s=r.blob;return A.push(a),s})),t.abrupt("return",{signedTxns:I,txnIDs:A});case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ft(e){return Ct.apply(this,arguments)}function Ct(){return(Ct=i(s().mark((function e(t){var n,r,a,o,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.signedTxns,a=t.txnIDs,e.prev=1,e.next=4,n.sendRawTransaction(r).do();case 4:return e.next=6,G(n,a[Dt.POOL_TOKEN_CREATE]);case 6:if(o=e.sent,"bigint"==typeof(i=o.assetIndex)){e.next=10;break}throw new Error("Generated ID is not valid: got ".concat(i));case 10:return e.abrupt("return",{poolTokenID:i});case 13:throw e.prev=13,e.t0=e.catch(1),new V(e.t0,"We encountered something unexpected while bootstraping the pool. Try again later.");case 16:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function Qt(){return(Qt=i(s().mark((function e(t){var n,r,a,o,i,u,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.network,a=t.pool,o=a.asset1ID,i=a.asset2ID,u=t.signedTxns,c=t.txnIDs,e.next=3,Ft({client:n,signedTxns:u,txnIDs:c});case 3:return e.abrupt("return",Pt.v1_1.getPoolInfo({client:n,network:r,asset1ID:o,asset2ID:i}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Lt={generateTxns:function(e){return Bt.apply(this,arguments)},signTxns:function(e){return Rt.apply(this,arguments)},execute:function(e){return Qt.apply(this,arguments)},getBootstrapFundingTxnAmount:Ot};var Vt=function(e){return e[e.FUNDING_TXN=0]="FUNDING_TXN",e[e.VALIDATOR_APP_CALL=1]="VALIDATOR_APP_CALL",e}({}),Ut={ASA_ALGO:5,ASA_ASA:6};function Mt(e,t){return jt.apply(this,arguments)}function jt(){return(jt=i(s().mark((function t(n,r){var a,o,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(o=null===(a=r.find((function(t){return t.txn.type===e.TransactionType.appl})))||void 0===a?void 0:a.txn.txID())){t.next=7;break}return t.next=4,e.waitForConfirmation(n,o,O);case 4:t.t0=t.sent,t.next=8;break;case 7:t.t0=void 0;case 8:return i=t.t0,t.abrupt("return",i);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Gt(e,t){return Xt.apply(this,arguments)}function Xt(){return(Xt=i(s().mark((function e(t,n){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Mt(t,n);case 2:return r=e.sent,e.abrupt("return",null==r?void 0:r.innerTxns);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wt(e,t){return zt.apply(this,arguments)}function zt(){return(zt=i(s().mark((function t(n,r){var a,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Gt(n,r);case 2:return a=t.sent,o=r[0].txn.sender.toString(),t.abrupt("return",null==a?void 0:a.reduce((function(t,n){var r,a,s=t,i=n.txn.txn;i.type===e.TransactionType.axfer&&i.assetTransfer&&i.assetTransfer.receiver.toString()===o?s.push({id:Number(i.assetTransfer.assetIndex),amount:null===(a=i.assetTransfer)||void 0===a?void 0:a.amount}):i.type===e.TransactionType.pay&&(null===(r=i.payment)||void 0===r?void 0:r.receiver.toString())===o&&s.push({id:Ae,amount:i.payment.amount});return s}),[]));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Yt(){return(Yt=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h,m,A,I,v,y,w,b,T;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.network,o=n.asset_1,i=n.asset_2,u=n.initiatorAddr,t.next=3,r.getTransactionParams().do();case 3:return c=t.sent,p=He(a,se.V2),l=e.getApplicationAddress(p),d=ke(o,i),f=x(d,2),g=f[0].id,h=f[1].id,t.next=9,Pt.v2.getPoolInfo({client:r,network:a,asset1ID:g,asset2ID:h});case 9:if(t.sent.status!==dt.READY){t.next=12;break}throw new Error("Pool for ".concat(o.unit_name,"-").concat(i.unit_name," already exists"));case 12:return m=st.generateLogicSigAccountForPool({network:a,asset1ID:g,asset2ID:h}),A=m.address(),I=Ne(h),(v=e.makeApplicationOptInTxnFromObject({sender:A,appIndex:p,appArgs:[ne("bootstrap")],note:oe.getAppCallTxnNoteWithClientName(se.V2),foreignAssets:[g,h],rekeyTo:l,suggestedParams:c})).fee=qt(I,c.minFee),y=e.makePaymentTxnWithSuggestedParamsFromObject({sender:u,receiver:A,amount:Jt(I,c.minFee),suggestedParams:c}),(w=[])[Vt.FUNDING_TXN]=y,w[Vt.VALIDATOR_APP_CALL]=v,b=e.assignGroupID(w),(T=[])[Vt.FUNDING_TXN]={txn:b[Vt.FUNDING_TXN],signers:[u]},T[Vt.VALIDATOR_APP_CALL]={txn:b[Vt.VALIDATOR_APP_CALL],signers:[A.toString()]},t.abrupt("return",T);case 26:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Jt(e,t){return function(e,t){var n=ot(e).schema,r=n.numLocalInts,a=n.numLocalByteSlices,s=N+S+S+P+_*BigInt(r)+D*BigInt(a);return t||(s+=S),s}(se.V2,e)+qt(e,t)+S}function qt(e,t){var n=e?Ut.ASA_ALGO:Ut.ASA_ASA;return BigInt(n+1)*t}function Zt(){return(Zt=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h,m,A,I;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.txGroup,a=n.network,o=n.initiatorSigner,i=n.asset1ID,u=n.asset2ID,t.next=3,o([r]);case 3:return c=t.sent,p=x(c,1),l=p[0],d=Ee(i,u),f=x(d,2),g=f[0],h=f[1],m=st.generateLogicSigAccountForPool({network:a,asset1ID:g,asset2ID:h}),A=[],I=r.map((function(t,n){if(n===Vt.FUNDING_TXN)return A.push(t.txn.txID().toString()),l;var r=e.signLogicSigTransactionObject(t.txn,m),a=r.txID,s=r.blob;return A.push(a),s})),t.abrupt("return",{signedTxns:I,txnIDs:A});case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ht(){return(Ht=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.network,o=n.pool,i=o.asset1ID,u=o.asset2ID,c=n.txGroup,p=n.signedTxns,t.prev=1,t.next=4,r.sendRawTransaction(p).do();case 4:return t.next=6,Mt(r,c);case 6:if(t.t5=f=t.sent,t.t4=null===t.t5,t.t4){t.next=10;break}t.t4=void 0===f;case 10:if(!t.t4){t.next=14;break}t.t6=void 0,t.next=15;break;case 14:t.t6=f.localStateDelta;case 15:if(t.t7=d=t.t6,t.t3=null!==t.t7,!t.t3){t.next=19;break}t.t3=void 0!==d;case 19:if(!t.t3){t.next=23;break}t.t8=d,t.next=24;break;case 23:t.t8=[];case 24:if(t.t9=l=t.t8[0],t.t2=null===t.t9,t.t2){t.next=28;break}t.t2=void 0===l;case 28:if(t.t1=t.t2,t.t1){t.next=31;break}t.t1=null===(l=l.delta)||void 0===l;case 31:if(t.t0=t.t1,t.t0){t.next=34;break}t.t0=null===(l=l.find((function(t){return t.key===e.bytesToBase64(ne(ft.v2.poolTokenID))})))||void 0===l;case 34:if(!t.t0){t.next=38;break}t.t10=void 0,t.next=39;break;case 38:t.t10=l.value.uint;case 39:if("bigint"==typeof(g=t.t10)){t.next=42;break}throw new Error("Generated ID is not valid: got ".concat(g));case 42:return t.abrupt("return",Pt.v2.getPoolInfo({client:r,network:a,asset1ID:i,asset2ID:u}));case 45:throw t.prev=45,t.t11=t.catch(1),new V(t.t11,"We encountered something unexpected while bootstraping the pool. Try again later.");case 48:case"end":return t.stop()}}),t,null,[[1,45]])})))).apply(this,arguments)}var Kt={generateTxns:function(e){return Yt.apply(this,arguments)},signTxns:function(e){return Zt.apply(this,arguments)},execute:function(e){return Ht.apply(this,arguments)},getBootstrapFundingTxnAmount:Jt,getTotalCost:function(e,t){return t+Jt(e,t)}};var $t=l(l(l(l(l(l({},se.V1_1,Lt),se.V2,Kt),"generateTxns",(function(e){return e.contractVersion===se.V1_1?Lt.generateTxns(e):Kt.generateTxns(e)})),"signTxns",(function(e){return e.contractVersion===se.V1_1?Lt.signTxns(e):Kt.signTxns(e)})),"execute",(function(e){return e.contractVersion===se.V1_1?Lt.execute(e):Kt.execute(e)})),"calculateBootstrapFundingTxnAmount",(function(e){var t=e.contractVersion,n=e.isAlgoPool,r=e.minFee;return t===se.V1_1?Lt.getBootstrapFundingTxnAmount(n):Kt.getBootstrapFundingTxnAmount(n,r)})),en=ne("add_liquidity"),tn=l(l({},se.V1_1,[ne("mint")]),se.V2,{INITIAL_LIQUIDITY:[ne("add_initial_liquidity")],SINGLE_ASSET_MODE:[en,ne("single")],FLEXIBLE_MODE:[en,ne("flexible")]}),nn=function(e){return e[e.FEE_TXN=0]="FEE_TXN",e[e.VALIDATOR_APP_CALL_TXN=1]="VALIDATOR_APP_CALL_TXN",e[e.ASSET1_IN_TXN=2]="ASSET1_IN_TXN",e[e.ASSET2_IN_TXN=3]="ASSET2_IN_TXN",e[e.LIQUDITY_OUT_TXN=4]="LIQUDITY_OUT_TXN",e}({}),rn=5;function an(){return(an=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h,m,A,x,I;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.network,o=n.poolAddress,i=n.asset1In,u=n.asset2In,c=n.poolTokenOut,p=n.slippage,l=n.initiatorAddr,d=W("negative",p,c.amount),t.next=4,r.getTransactionParams().do();case 4:return f=t.sent,g=e.makeApplicationNoOpTxnFromObject({sender:o,appIndex:He(a,se.V1_1),appArgs:tn.v1_1,accounts:[l],note:oe.getAppCallTxnNoteWithClientName(se.V1_1),foreignAssets:u.id==Ae?[i.id,c.id]:[i.id,u.id,c.id],suggestedParams:f}),h=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:l,receiver:o,assetIndex:i.id,amount:i.amount,suggestedParams:f}),m=u.id===Ae?e.makePaymentTxnWithSuggestedParamsFromObject({sender:l,receiver:o,amount:u.amount,suggestedParams:f}):e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:l,receiver:o,assetIndex:u.id,amount:u.amount,suggestedParams:f}),A=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:o,receiver:l,assetIndex:c.id,amount:d,suggestedParams:f}),x=e.makePaymentTxnWithSuggestedParamsFromObject({sender:l,receiver:o,amount:g.fee+A.fee,note:E,suggestedParams:f}),I=e.assignGroupID([x,g,h,m,A]),t.abrupt("return",[{txn:I[0],signers:[l]},{txn:I[1],signers:[o]},{txn:I[2],signers:[l]},{txn:I[3],signers:[l]},{txn:I[4],signers:[o]}]);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function sn(){return(sn=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.pool,a=n.txGroup,o=n.initiatorSigner,i=r.account,t.next=4,o([a]);case 4:return u=t.sent,c=x(u,3),p=c[0],l=c[1],d=c[2],f=a.map((function(t,n){return n===nn.FEE_TXN?p:n===nn.ASSET1_IN_TXN?l:n===nn.ASSET2_IN_TXN?d:e.signLogicSigTransactionObject(t.txn,i).blob})),t.abrupt("return",f);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function on(){return(on=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d,f,g,h,m,A,I,v,y,w;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.pool,a=t.txGroup,o=t.signedTxns,i=t.initiatorAddr,e.prev=1,p=null!==(u=null===(c=a[nn.LIQUDITY_OUT_TXN].txn.payment)||void 0===c?void 0:c.amount)&&void 0!==u?u:0n,e.next=5,ct({client:n,pool:r,accountAddr:i});case 5:return l=e.sent,e.next=8,Z(n,[o]);case 8:return d=e.sent,f=x(d,1),g=f[0],h=g.confirmedRound,m=g.txnID,A=K(a),I=$(a),e.next=17,ct({client:n,pool:r,accountAddr:i});case 17:return v=e.sent,(y=v.excessPoolTokens-l.excessPoolTokens)<0n&&(y=0n),e.abrupt("return",{round:h,fees:A,poolTokenID:r.poolTokenID,poolTokenOut:p+y,excessAmount:{excessAmountForAddingLiquidity:y,totalExcessAmount:v.excessPoolTokens},txnID:m,groupID:I});case 23:throw e.prev=23,e.t0=e.catch(1),"SlippageTolerance"===(w=new V(e.t0,"We encountered something unexpected while adding liquidity. Try again later.")).type&&w.setMessage("Adding liquidity failed due to too much slippage in the price. Please adjust the slippage tolerance and try again."),w;case 28:case"end":return e.stop()}}),e,null,[[1,23]])})))).apply(this,arguments)}var un=Object.freeze({__proto__:null,execute:function(e){return on.apply(this,arguments)},generateTxns:function(e){return an.apply(this,arguments)},getQuote:function(e){var t=e.pool,n=e.reserves,r=e.asset1In,a=e.asset2In;if(0n===n.issuedLiquidity){var s=BigInt(Math.floor(Math.sqrt(Number(r)*Number(a))));if(s<=B)throw new Error("Initial liquidity amount is too small. The amount must be greater than ".concat(B,", this quote is for ").concat(s,"."));return{round:Number(n.round),asset1ID:t.asset1ID,asset1In:r,asset2ID:t.asset2ID,asset2In:a,poolTokenID:t.poolTokenID,poolTokenOut:s-B,share:1}}var o=r*n.issuedLiquidity/n.asset1,i=a*n.issuedLiquidity/n.asset2,u=o<i?o:i;return{round:Number(n.round),asset1ID:t.asset1ID,asset1In:r,asset2ID:t.asset2ID,asset2In:a,poolTokenID:t.poolTokenID,poolTokenOut:u,share:Pt.getPoolShare(n.issuedLiquidity+u,u)}},signTxns:function(e){return sn.apply(this,arguments)}}),cn=function(e){return e.SINGLE="single",e.FLEXIBLE="flexible",e.INITIAL="initial",e}({}),pn=l(l(l({},cn.FLEXIBLE,{ASSET1_IN_TXN:0,ASSET2_IN_TXN:1,VALIDATOR_APP_CALL_TXN:2}),cn.SINGLE,{ASSET_IN_TXN:0,VALIDATOR_APP_CALL_TXN:1}),cn.INITIAL,{ASSET1_IN_TXN:0,ASSET2_IN_TXN:1,VALIDATOR_APP_CALL_TXN:2}),ln=l(l(l({},cn.INITIAL,1),cn.SINGLE,2),cn.FLEXIBLE,2),dn=l(l(l({},cn.INITIAL,3),cn.FLEXIBLE,3),cn.SINGLE,2);function fn(e){var t,n,r,a=e.reserves,s=e.totalFeeShare,o=e.asset1,i=e.asset2,u=a.asset1*a.asset2,c=a.asset1+o.amount,p=a.asset2+i.amount,l=c*p,d=BigInt(parseInt(String(Math.sqrt(Number(l*a.issuedLiquidity*a.issuedLiquidity/u))))),f=d-a.issuedLiquidity,g=f*c/d,h=f*p/d,m=o.amount-g,A=i.amount-h;if(m>A){var x=m;r=hn(x,s),t={id:o.id,amount:x+r,decimals:o.decimals,reserves:a.asset1},n={id:i.id,amount:BigInt(Math.abs(Math.min(Number(A),0))),decimals:i.decimals,reserves:a.asset2},f-=r*d/(c*BigInt(2))}else{var I=A;r=hn(I,s),t={id:i.id,amount:I+r,decimals:i.decimals,reserves:a.asset2},n={id:o.id,amount:BigInt(Math.abs(Math.min(Number(m),0))),decimals:o.decimals,reserves:a.asset1},f-=r*d/(p*BigInt(2))}return{poolTokenOutAmount:f,internalSwapQuote:{assetIn:t,assetOut:n,swapFees:r,priceImpact:Me({inputSupply:t.reserves,outputSupply:n.reserves,assetIn:t,assetOut:n})}}}function gn(e,t){if(!e.amount||!t.amount)throw new Error("Both assets are required for the initial add liquidity");return BigInt(Math.floor(Math.abs(Math.sqrt(Number(e.amount)*Number(t.amount))-gt)))}function hn(e,t){return e*BigInt(t)/(BigInt(1e4)-BigInt(t))}function mn(e,t){var n=ln[e];return BigInt(n+1)*t}function An(e){var t=e.txGroup;return(0,e.initiatorSigner)([t])}function xn(e){return In.apply(this,arguments)}function In(){return(In=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d,f,g;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.pool,a=t.txGroup,o=t.signedTxns,e.prev=1,e.next=4,Z(n,[o]);case 4:return i=e.sent,u=x(i,1),c=u[0],p=c.confirmedRound,l=c.txnID,e.prev=9,e.next=12,Wt(n,a);case 12:if(e.t1=f=e.sent,e.t0=null===e.t1,e.t0){e.next=16;break}e.t0=void 0===f;case 16:if(!e.t0){e.next=20;break}e.t2=void 0,e.next=21;break;case 20:e.t2=f.find((function(e){return e.id===r.poolTokenID}));case 21:d=e.t2,e.next=26;break;case 24:e.prev=24,e.t3=e.catch(9);case 26:return e.abrupt("return",{round:p,assetOut:d,fees:K(a),poolTokenID:r.poolTokenID,txnID:l,groupID:$(a)});case 29:throw e.prev=29,e.t4=e.catch(1),"SlippageTolerance"===(g=new V(e.t4,"We encountered something unexpected while adding liquidity. Try again later.")).type&&g.setMessage("Adding liquidity failed due to too much slippage in the price. Please adjust the slippage tolerance and try again."),g;case 34:case"end":return e.stop()}}),e,null,[[1,29],[9,24]])})))).apply(this,arguments)}function vn(){return(vn=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h,m,A,v,y,w,b;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.network,o=n.poolAddress,i=n.asset1In,u=n.asset2In,c=n.poolTokenOut,p=n.initiatorAddr,l=n.minPoolTokenAssetAmount,t.next=3,r.getTransactionParams().do();case 3:return d=t.sent,f=ke(i,u),g=x(f,2),h=g[0],m=g[1],A=Ne(m.id),v=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:p,receiver:o,assetIndex:h.id,amount:h.amount,suggestedParams:d}),y=A?e.makePaymentTxnWithSuggestedParamsFromObject({sender:p,receiver:o,amount:m.amount,suggestedParams:d}):e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:p,receiver:o,assetIndex:m.id,amount:m.amount,suggestedParams:d}),(w=e.makeApplicationNoOpTxnFromObject({sender:p,appIndex:He(a,se.V2),note:oe.getAppCallTxnNoteWithClientName(se.V2),appArgs:[].concat(I(tn.v2.FLEXIBLE_MODE),[e.encodeUint64(l)]),accounts:[o],foreignAssets:[c.id],suggestedParams:d})).fee=mn(cn.FLEXIBLE,d.minFee),b=e.assignGroupID([v,y,w]),t.abrupt("return",[{txn:b[0],signers:[p]},{txn:b[1],signers:[p]},{txn:b[2],signers:[p]}]);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var yn=Object.freeze({__proto__:null,execute:xn,generateTxns:function(e){return vn.apply(this,arguments)},getQuote:function(e){var t=e.pool,n=e.slippage,r=void 0===n?.05:n,a=e.asset1,s=e.asset2;if(0n===t.issuedPoolTokens)throw new Error("Pool has no liquidity at the moment. To be able to do Flexible Swap, you should first add initial liquidity.");if(t.status!==dt.READY)throw new Error("Pool is not ready");if(!t.poolTokenID)throw new Error("Pool token ID is not available");var o={asset1:t.asset1Reserves||0n,asset2:t.asset2Reserves||0n,issuedLiquidity:t.issuedPoolTokens||0n},i=fn({reserves:o,totalFeeShare:t.totalFeeShare,asset1:{id:t.asset1ID,amount:a.amount,decimals:a.decimals},asset2:{id:t.asset2ID,amount:s.amount,decimals:s.decimals}}),u=i.poolTokenOutAmount,c=i.internalSwapQuote,p=u-BigInt(Math.ceil(Number(u)*r));return{asset1In:{id:t.asset1ID,amount:a.amount},asset2In:{id:t.asset2ID,amount:s.amount},poolTokenOut:{id:t.poolTokenID,amount:u},share:Pt.getPoolShare(o.issuedLiquidity+u,u),slippage:r,internalSwapQuote:c,minPoolTokenAssetAmountWithSlippage:p}},signTxns:An});function wn(){return(wn=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.network,o=n.poolAddress,i=n.assetIn,u=n.poolTokenId,c=n.initiatorAddr,p=n.minPoolTokenAssetAmount,t.next=3,r.getTransactionParams().do();case 3:return l=t.sent,d=Ne(i.id),f=d?e.makePaymentTxnWithSuggestedParamsFromObject({sender:c,receiver:o,amount:i.amount,suggestedParams:l}):e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:c,receiver:o,assetIndex:i.id,amount:i.amount,suggestedParams:l}),(g=e.makeApplicationNoOpTxnFromObject({sender:c,appIndex:He(a,se.V2),note:oe.getAppCallTxnNoteWithClientName(se.V2),appArgs:[].concat(I(tn.v2.SINGLE_ASSET_MODE),[e.encodeUint64(p)]),accounts:[o],foreignAssets:[u],suggestedParams:l})).fee=mn(cn.SINGLE,l.minFee),h=e.assignGroupID([f,g]),t.abrupt("return",[{txn:h[0],signers:[c]},{txn:h[1],signers:[c]}]);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var bn=Object.freeze({__proto__:null,execute:xn,generateTxns:function(e){return wn.apply(this,arguments)},getQuote:function(e){var t=e.pool,n=e.assetIn,r=e.slippage,a=void 0===r?.05:r,s=e.decimals;if(0n===t.issuedPoolTokens)throw new Error("Pool has no liquidity");if(t.status!==dt.READY)throw new Error("Pool is not ready");if(!t.poolTokenID)throw new Error("Pool token ID is not available");var o=n.id===t.asset1ID,i=n.id===t.asset2ID;if(!o&&!i)throw new Error("Provided input asset id didn't match any asset of the pool");var u={id:t.asset1ID,amount:o?n.amount:0n,decimals:s.asset1},c={id:t.asset2ID,amount:i?n.amount:0n,decimals:s.asset2},p={asset1:t.asset1Reserves||0n,asset2:t.asset2Reserves||0n,issuedLiquidity:t.issuedPoolTokens||0n},l=fn({reserves:p,totalFeeShare:t.totalFeeShare||0,asset1:u,asset2:c}),d=l.poolTokenOutAmount,f=l.internalSwapQuote,g=d-BigInt(Math.ceil(Number(d)*a));return{assetIn:{id:o?t.asset1ID:t.asset2ID,amount:n.amount},poolTokenOut:{id:t.poolTokenID,amount:d},share:Pt.getPoolShare(p.issuedLiquidity+d,d),slippage:a,internalSwapQuote:f,minPoolTokenAssetAmountWithSlippage:g}},signTxns:An});function Tn(){return(Tn=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h,m;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.pool,o=n.network,i=n.poolAddress,u=n.asset1In,c=n.asset2In,p=n.poolTokenId,l=n.initiatorAddr,d=Ne(a.asset2ID),t.next=4,r.getTransactionParams().do();case 4:return f=t.sent,g=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:l,receiver:i,assetIndex:a.asset1ID,amount:u.amount,suggestedParams:f}),h=d?e.makePaymentTxnWithSuggestedParamsFromObject({sender:l,receiver:i,amount:c.amount,suggestedParams:f}):e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:l,receiver:i,assetIndex:a.asset2ID,amount:c.amount,suggestedParams:f}),(m=e.makeApplicationNoOpTxnFromObject({sender:l,appIndex:He(o,se.V2),appArgs:tn.v2.INITIAL_LIQUIDITY,note:oe.getAppCallTxnNoteWithClientName(se.V2),accounts:[i],foreignAssets:[p],suggestedParams:f})).fee=mn(cn.INITIAL,f.minFee),t.abrupt("return",e.assignGroupID([g,h,m]).map((function(e){return{txn:e,signers:[l]}})));case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var kn=Object.freeze({__proto__:null,execute:xn,generateTxns:function(e){return Tn.apply(this,arguments)},getQuote:function(e){var t=e.pool,n=e.asset1,r=e.asset2,a=e.slippage,s=void 0===a?.05:a;if(0n!==t.issuedPoolTokens)throw new Error("Pool already has liquidity");var o=BigInt(Math.floor(Math.sqrt(Number(n.amount)*Number(r.amount))));if(o<=BigInt(gt))throw new Error("Initial liquidity amount is too small. Liquidity amount must be greater than ".concat(gt,", this quote is for ").concat(o,"."));return{asset1In:{id:t.asset1ID,amount:n.amount},asset2In:{id:t.asset2ID,amount:r.amount},poolTokenOut:{id:t.poolTokenID,amount:gn(n,r)},slippage:s}},signTxns:An}),En=Object.freeze({__proto__:null,flexible:yn,initial:kn,withSingleAsset:bn}),Nn=l(l({},se.V1_1,un),se.V2,En);var Sn=function(e){return e[e.FEE_TXN=0]="FEE_TXN",e[e.VALIDATOR_APP_CALL_TXN=1]="VALIDATOR_APP_CALL_TXN",e[e.ASSET1_OUT_TXN=2]="ASSET1_OUT_TXN",e[e.ASSET2_OUT_TXN=3]="ASSET2_OUT_TXN",e[e.POOL_TOKEN_IN_TXN=4]="POOL_TOKEN_IN_TXN",e}({}),Pn=Object.values(Sn).length;function Dn(){return(Dn=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h,m,A,x,I,v,y,w,b;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.pool,o=n.poolTokenIn,i=n.asset1Out,u=n.asset2Out,c=n.slippage,p=n.initiatorAddr,t.next=3,r.getTransactionParams().do();case 3:return l=t.sent,d=a.account.address(),f=Ne(a.asset2ID),g=e.makeApplicationNoOpTxnFromObject({sender:d,appIndex:a.validatorAppID,appArgs:[ne("burn")],note:oe.getAppCallTxnNoteWithClientName(se.V1_1),accounts:[p],foreignAssets:f?[a.asset1ID,a.poolTokenID]:[a.asset1ID,a.asset2ID,a.poolTokenID],suggestedParams:l}),h=W("negative",c,i),m=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:d,receiver:p,assetIndex:a.asset1ID,amount:h,suggestedParams:l}),A=W("negative",c,u),x=f?e.makePaymentTxnWithSuggestedParamsFromObject({sender:d,receiver:p,amount:A,suggestedParams:l}):e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:d,receiver:p,assetIndex:a.asset2ID,amount:A,suggestedParams:l}),I=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:p,receiver:d,assetIndex:a.poolTokenID,amount:o,suggestedParams:l}),v=g.fee+m.fee+x.fee,y=e.makePaymentTxnWithSuggestedParamsFromObject({sender:p,receiver:d,amount:v,note:E,suggestedParams:l}),(w=[])[Sn.FEE_TXN]=y,w[Sn.VALIDATOR_APP_CALL_TXN]=g,w[Sn.ASSET1_OUT_TXN]=m,w[Sn.ASSET2_OUT_TXN]=x,w[Sn.POOL_TOKEN_IN_TXN]=I,b=e.assignGroupID(w),t.abrupt("return",[{txn:b[Sn.FEE_TXN],signers:[p]},{txn:b[Sn.VALIDATOR_APP_CALL_TXN],signers:[d.toString()]},{txn:b[Sn.ASSET1_OUT_TXN],signers:[d.toString()]},{txn:b[Sn.ASSET2_OUT_TXN],signers:[d.toString()]},{txn:b[Sn.POOL_TOKEN_IN_TXN],signers:[p]}]);case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _n(){return(_n=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.pool,a=n.txGroup,o=n.initiatorSigner,t.next=3,o([a]);case 3:return i=t.sent,u=x(i,2),c=u[0],p=u[1],l=r.account,d=a.map((function(t,n){return n===Sn.FEE_TXN?c:n===Sn.POOL_TOKEN_IN_TXN?p:e.signLogicSigTransactionObject(t.txn,l).blob})),t.abrupt("return",d);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Bn(){return(Bn=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d,f,g,h,m,A,I,v,y,w,b,T,k,E,N;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.pool,a=t.txGroup,o=t.signedTxns,i=t.initiatorAddr,e.prev=1,g=null!==(u=null===(c=a[Sn.ASSET1_OUT_TXN].txn.payment)||void 0===c?void 0:c.amount)&&void 0!==u?u:0n,h=null!==(p=null===(l=a[Sn.ASSET2_OUT_TXN].txn.payment)||void 0===l?void 0:l.amount)&&void 0!==p?p:0n,m=null!==(d=null===(f=a[Sn.POOL_TOKEN_IN_TXN].txn.payment)||void 0===f?void 0:f.amount)&&void 0!==d?d:0n,e.next=7,ct({client:n,pool:r,accountAddr:i});case 7:return A=e.sent,e.next=10,Z(n,[o]);case 10:return I=e.sent,v=x(I,1),y=v[0],w=y.confirmedRound,b=y.txnID,e.next=17,ct({client:n,pool:r,accountAddr:i});case 17:return T=e.sent,(k=T.excessAsset1-A.excessAsset1)<0n&&(k=0n),(E=T.excessAsset2-A.excessAsset2)<0n&&(E=0n),e.abrupt("return",{round:w,fees:K(a),asset1ID:r.asset1ID,asset1Out:g+k,asset2ID:r.asset2ID,asset2Out:h+E,poolTokenID:r.poolTokenID,poolTokenIn:m,excessAmounts:[{assetID:r.asset1ID,excessAmountForBurning:k,totalExcessAmount:T.excessAsset1},{assetID:r.asset2ID,excessAmountForBurning:E,totalExcessAmount:T.excessAsset2}],txnID:b,groupID:$(a)});case 25:throw e.prev=25,e.t0=e.catch(1),"SlippageTolerance"===(N=new V(e.t0,"We encountered something unexpected while burning liquidity. Try again later.")).type&&N.setMessage("The burn failed due to too much slippage in the price. Please adjust the slippage tolerance and try again."),N;case 30:case"end":return e.stop()}}),e,null,[[1,25]])})))).apply(this,arguments)}var On={generateTxns:function(e){return Dn.apply(this,arguments)},getQuote:function(e){var t=e.pool,n=e.reserves,r=e.poolTokenIn,a=n.issuedLiquidity&&r*n.asset1/n.issuedLiquidity,s=n.issuedLiquidity&&r*n.asset2/n.issuedLiquidity;return{round:Number(n.round),poolTokenID:t.poolTokenID,poolTokenIn:r,asset1ID:t.asset1ID,asset1Out:a,asset2ID:t.asset2ID,asset2Out:s}},signTxns:function(e){return _n.apply(this,arguments)},execute:function(e){return Bn.apply(this,arguments)}};function Rn(){return(Rn=i(s().mark((function t(n){var r,o,i,u,c,p,l,d,f,g,h,m,A,x,I,v,y,w,b,T;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.quote.type!==Pe.Router){t.next=2;break}return t.abrupt("return",ie(a(a({},n),{},{route:n.quote.data})));case 2:if(r=n.client,o=n.initiatorAddr,i=n.slippage,u=n.swapType,c=n.quote,p=c.data,l=p.pool,d=p.quote,f=d.assetInID,g=d.assetOutID,h=l.account.address(),(m=[l.asset1ID,l.asset2ID]).includes(f)&&m.includes(g)&&f!==g){t.next=9;break}throw new V({pool:l,quote:c},"Input asset (#".concat(f,") and output asset (#").concat(g,") provided to generate transactions do not belong to the pool ").concat(h,"."));case 9:return t.next=11,r.getTransactionParams().do();case 11:return A=t.sent,x=Ne(f),I=u===re.FixedInput?d.assetInAmount:W("positive",i,d.assetInAmount),v=u===re.FixedOutput?d.assetOutAmount:W("negative",i,d.assetOutAmount),y=x?e.makePaymentTxnWithSuggestedParamsFromObject({sender:o,receiver:h,amount:I,suggestedParams:A}):e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:o,receiver:h,amount:I,assetIndex:f,suggestedParams:A}),(w=e.makeApplicationNoOpTxnFromObject({sender:o,appIndex:l.validatorAppID,appArgs:[Re,Fe[u],e.encodeUint64(v)],note:oe.getAppCallTxnNoteWithClientName(se.V2,n.appCallNoteExtraData),accounts:[h],foreignAssets:[l.asset1ID,l.asset2ID],suggestedParams:A})).fee=Ve(u,A.minFee),(b=[])[_e.INPUT_TXN]=y,b[_e.APP_CALL_TXN]=w,T=e.assignGroupID(b),t.abrupt("return",[{txn:T[_e.INPUT_TXN],signers:[o]},{txn:T[_e.APP_CALL_TXN],signers:[o]}]);case 23:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Fn(){return(Fn=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d,f,g,h,m,A,I;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.client,o=t.quote,i=t.txGroup,u=t.signedTxns,e.next=3,Z(a,[u]);case 3:return c=e.sent,p=x(c,1),l=p[0],d=l.confirmedRound,f=l.txnID,g=Ge(o).id,h=je(o),e.prev=10,e.next=13,Wt(a,i);case 13:m=e.sent,e.next=18;break;case 16:e.prev=16,e.t0=e.catch(10);case 18:return A=null===(n=m)||void 0===n||null===(n=n.find((function(e){return e.id===h.id})))||void 0===n?void 0:n.amount,I=null===(r=m)||void 0===r?void 0:r.find((function(e){return e.id===g})),e.abrupt("return",{round:d,assetIn:{amount:h.amount-(A||0n),id:h.id},assetOut:I,quote:o,txnID:f});case 21:case"end":return e.stop()}}),e,null,[[10,16]])})))).apply(this,arguments)}function Cn(){return(Cn=i(s().mark((function e(t){var n,r,a,o,i,u,c,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.type,r=t.amount,a=t.assetIn,o=t.assetOut,i=t.network,u=t.slippage,c=t.pool,n!==re.FixedInput){e.next=7;break}return e.next=4,Un({assetIn:a,assetOut:o,amount:r,network:i,pool:c,slippage:u});case 4:p=e.sent,e.next=10;break;case 7:return e.next=9,jn({amount:r,assetIn:a,assetOut:o,network:i,pool:c,slippage:u});case 9:p=e.sent;case 10:return e.abrupt("return",p);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qn(e){return Promise.allSettled(e).then((function(e){if(e.every((function(e){return"rejected"===e.status}))){var t=e[0].reason;if(2===e.length){var n=e[1].reason;if(Ye(t)&&!Ye(n))throw t;throw n}throw t}return e.filter((function(e){return"fulfilled"===e.status&&e.value})).map((function(e){return e.value}))}))}function Ln(e){var t=e.amount,n=e.assetIn,r=e.assetOut,a=e.pool;if(!Pt.isPoolReady(a))throw new k(T.NoAvailablePoolError,"There is not an available pool for this asset pair");var s,o,i=n.id,u=n.decimals,c=r.id,p=r.decimals,l=t,d=a.totalFeeShare;if(i===a.asset1ID)s=a.asset1Reserves,o=a.asset2Reserves;else{if(i!==a.asset2ID)throw new k(T.AssetDoesNotBelongToPoolError,"Input asset (#".concat(i,") doesn't belong to the pool ").concat(a.account.address(),"."));s=a.asset2Reserves,o=a.asset1Reserves}var f=Xn({inputSupply:s,outputSupply:o,swapInputAmount:l,totalFeeShare:d,decimals:{assetIn:u,assetOut:p}}),g=f.swapOutputAmount,h=f.totalFeeAmount,m=f.priceImpact;if(g>o)throw new k(T.OutputAmountExceedsAvailableLiquidityError,"Output amount exceeds available liquidity.");if(Le(Number(t)))throw new k(T.LowSwapAmountError,"Swap amount is too low.");return{assetInID:i,assetInAmount:l,assetOutID:c,assetOutAmount:g,swapFee:Number(h),rate:z(p,Number(g))/z(u,Number(l)),priceImpact:m}}function Vn(e){var t=e.amount,n=e.assetIn,r=e.assetOut,a=e.pool;if(!a||!Pt.isPoolReady(a))throw new k(T.NoAvailablePoolError,"There is not an available pool for this asset pair");var s,o,i=n.id,u=n.decimals,c=r.id,p=r.decimals,l=t,d=a.totalFeeShare;if(c===a.asset1ID)s=a.asset2Reserves,o=a.asset1Reserves;else{if(c!==a.asset2ID)throw new k(T.AssetDoesNotBelongToPoolError,"Output asset (#".concat(c,") doesn't belong to the pool ").concat(a.account.address(),"."));s=a.asset1Reserves,o=a.asset2Reserves}var f=function(e){var t=e.inputSupply,n=e.outputSupply,r=e.swapOutputAmount,a=e.totalFeeShare,s=e.decimals,o=function(e){var t=e.inputSupply,n=e.outputSupply,r=e.outputAmount,a=t*n,s=a/(n-r)-t;return s+=BigInt(1),s}({inputSupply:t,outputSupply:n,outputAmount:r}),i=function(e){var t=e.swapAmount,n=e.totalFeeShare,r=Math.floor(Number(t*BigInt(1e4)/(BigInt(1e4)-n))),a=BigInt(r)-t;return a}({swapAmount:o,totalFeeShare:a}),u=o+i,c=Me({inputSupply:t,outputSupply:n,assetIn:{amount:u,decimals:s.assetIn},assetOut:{amount:r,decimals:s.assetOut}});return{swapInputAmount:u,totalFeeAmount:i,priceImpact:c}}({inputSupply:s,outputSupply:o,swapOutputAmount:l,totalFeeShare:d,decimals:{assetIn:u,assetOut:p}}),g=f.swapInputAmount,h=f.totalFeeAmount,m=f.priceImpact;if(l>o)throw new k(T.OutputAmountExceedsAvailableLiquidityError,"Output amount exceeds available liquidity.");if(Le(Number(g)))throw new k(T.LowSwapAmountError,"Swap amount is too low.");return{type:Pe.Direct,data:{pool:a,quote:{assetInID:i,assetInAmount:g,assetOutID:c,assetOutAmount:l,swapFee:Number(h),rate:z(p,Number(l))/z(u,Number(g)),priceImpact:m}}}}function Un(e){return Mn.apply(this,arguments)}function Mn(){return(Mn=i(s().mark((function e(t){var n,r,a,o,i,u,c,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.amount,r=t.assetIn,a=t.assetOut,o=t.network,i=t.slippage,u=t.pool,c=[],u?c.push(new Promise((function(e,t){try{var s=Ln({amount:n,assetIn:r,assetOut:a,pool:u});e({type:Pe.Direct,data:{pool:u,quote:s}})}catch(e){t(e)}}))):c.push(Promise.reject(new k(T.NoAvailablePoolError,"There is not an available pool for this asset pair"))),c.push(pe({amount:n,assetInID:r.id,assetOutID:a.id,swapType:re.FixedInput,network:o,slippage:i}).then((function(e){return{type:Pe.Router,data:e}}))),e.next=6,Qn(c);case 6:return p=e.sent,e.abrupt("return",ze(p));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function jn(e){return Gn.apply(this,arguments)}function Gn(){return(Gn=i(s().mark((function e(t){var n,r,a,o,i,u,c,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.amount,r=t.assetIn,a=t.assetOut,o=t.network,i=t.slippage,u=t.pool,(c=[new Promise((function(e,t){try{e(Vn({amount:n,assetIn:r,assetOut:a,pool:u}))}catch(e){t(e)}}))]).push(pe({amount:n,assetInID:r.id,assetOutID:a.id,swapType:re.FixedOutput,network:o,slippage:i}).then((function(e){return{type:Pe.Router,data:e}}))),e.next=5,Qn(c);case 5:return p=e.sent,e.abrupt("return",ze(p));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xn(e){var t=e.inputSupply,n=e.outputSupply,r=e.swapInputAmount,a=e.totalFeeShare,s=e.decimals,o=function(e){var t=e.inputAmount,n=e.totalFeeShare;return BigInt(Math.floor(Number(t*n)/1e4))}({inputAmount:r,totalFeeShare:a}),i=function(e){var t=e.inputSupply,n=e.outputSupply,r=e.swapAmount,a=t*n,s=n-a/(t+r);return s-=BigInt(1)}({inputSupply:t,outputSupply:n,swapAmount:r-o});return{swapOutputAmount:i,totalFeeAmount:o,priceImpact:Me({inputSupply:t,outputSupply:n,assetIn:{amount:r,decimals:s.assetIn},assetOut:{amount:i,decimals:s.assetOut}})}}var Wn={getQuote:function(e){return Cn.apply(this,arguments)},getFixedInputSwapQuote:Un,getFixedInputDirectSwapQuote:Ln,getFixedOutputDirectSwapQuote:Vn,getFixedOutputSwapQuote:jn,generateTxns:function(e){return Rn.apply(this,arguments)},signTxns:function(e){var t=e.txGroup;return(0,e.initiatorSigner)([t])},execute:function(e){return Fn.apply(this,arguments)},calculateFixedInputSwap:Xn},zn=2,Yn=ne("remove_liquidity"),Jn=function(e){return e[e.ASSET_TRANSFER_TXN=0]="ASSET_TRANSFER_TXN",e[e.APP_CALL_TXN=1]="APP_CALL_TXN",e}({});function qn(e,t){var n,r,a=t.issuedLiquidity;return a>e+BigInt(gt)?(n=e*t.asset1/a,r=e*t.asset2/a):(n=t.asset1,r=t.asset2),{asset1OutputAmount:n,asset2OutputAmount:r}}function Zn(){return(Zn=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h,m,A;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.pool,o=n.poolTokenIn,i=n.initiatorAddr,u=n.minAsset1Amount,c=n.minAsset2Amount,p=n.slippage,t.next=3,r.getTransactionParams().do();case 3:if(l=t.sent,d=a.account.address(),f=a.poolTokenID){t.next=8;break}throw new Error("Pool token asset ID is missing");case 8:return g=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:i,receiver:d,assetIndex:f,amount:o,suggestedParams:l}),(h=e.makeApplicationNoOpTxnFromObject({sender:i,appIndex:a.validatorAppID,note:oe.getAppCallTxnNoteWithClientName(se.V2),appArgs:[Yn,e.encodeUint64(W("negative",p,u)),e.encodeUint64(W("negative",p,c))],accounts:[d],foreignAssets:[a.asset1ID,a.asset2ID],suggestedParams:l})).fee=BigInt(zn+1)*l.minFee,(m=[])[Jn.ASSET_TRANSFER_TXN]=g,m[Jn.APP_CALL_TXN]=h,A=e.assignGroupID(m),t.abrupt("return",[{txn:A[Jn.ASSET_TRANSFER_TXN],signers:[i]},{txn:A[Jn.APP_CALL_TXN],signers:[i]}]);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Hn(){return(Hn=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h,m,A,x,I,v,y,w;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.pool,o=n.initiatorAddr,i=n.poolTokenIn,u=n.outputAssetId,c=n.minOutputAssetAmount,p=n.slippage,t.next=3,r.getTransactionParams().do();case 3:if(l=t.sent,d=a.asset1ID,f=a.asset2ID,g=a.account.address(),h=a.poolTokenID){t.next=9;break}throw new Error("Pool token asset ID is missing");case 9:if(m=0n,A=0n,x=W("negative",p,c),u!==d){t.next=17;break}m=x,A=0n,t.next=23;break;case 17:if(u!==f){t.next=22;break}m=0n,A=x,t.next=23;break;case 22:throw new Error("Invalid output asset id. It doesn't match with pool assets");case 23:return I=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:o,receiver:g,assetIndex:h,amount:i,suggestedParams:l}),(v=e.makeApplicationNoOpTxnFromObject({sender:o,appIndex:a.validatorAppID,note:oe.getAppCallTxnNoteWithClientName(se.V2),appArgs:[Yn,e.encodeUint64(m),e.encodeUint64(A)],accounts:[g],foreignAssets:[u],suggestedParams:l})).fee=BigInt(zn+1)*l.minFee,(y=[])[Jn.ASSET_TRANSFER_TXN]=I,y[Jn.APP_CALL_TXN]=v,w=e.assignGroupID(y),t.abrupt("return",[{txn:w[Jn.ASSET_TRANSFER_TXN],signers:[o]},{txn:w[Jn.APP_CALL_TXN],signers:[o]}]);case 31:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Kn(){return(Kn=i(s().mark((function e(t){var n,r,a,o,i,u,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.txGroup,a=t.signedTxns,e.next=3,Z(n,[a]);case 3:return o=e.sent,i=x(o,1),u=i[0].txnID,e.prev=6,e.next=9,Wt(n,r);case 9:c=e.sent,e.next=14;break;case 12:e.prev=12,e.t0=e.catch(6);case 14:return e.abrupt("return",{outputAssets:c,txnID:u});case 15:case"end":return e.stop()}}),e,null,[[6,12]])})))).apply(this,arguments)}var $n={getQuote:function(e){var t=e.pool,n=e.reserves,r=e.poolTokenIn,a=qn(r,n),s=a.asset1OutputAmount,o=a.asset2OutputAmount;return{round:Number(n.round),asset1Out:{assetId:t.asset1ID,amount:s},asset2Out:{assetId:t.asset2ID,amount:o},poolTokenIn:{assetId:t.poolTokenID,amount:r}}},getSingleAssetRemoveLiquidityQuote:function(e){var t,n=e.pool,r=e.reserves,a=e.poolTokenIn,s=e.assetOutID,o=e.decimals,i=qn(a,r),u=i.asset1OutputAmount,c=i.asset2OutputAmount,p=n.totalFeeShare;if(s===n.asset1ID){var l=Wn.calculateFixedInputSwap({inputSupply:r.asset2-c,outputSupply:r.asset1-u,swapInputAmount:c,totalFeeShare:p,decimals:o}),d=l.swapOutputAmount,f=l.totalFeeAmount,g=l.priceImpact;t={round:Number(r.round),assetOut:{assetId:s,amount:u+d},poolTokenIn:{assetId:n.poolTokenID,amount:a},internalSwapQuote:{amountIn:{assetId:n.asset2ID,amount:c},amountOut:{assetId:n.asset1ID,amount:d},swapFees:{assetId:n.asset2ID,amount:f},priceImpact:g}}}else{if(s!==n.asset2ID)throw new Error("assetOutID must be one of the pool assets");var h=Wn.calculateFixedInputSwap({inputSupply:r.asset1-u,outputSupply:r.asset2-c,swapInputAmount:u,totalFeeShare:p,decimals:o}),m=h.swapOutputAmount,A=h.totalFeeAmount,x=h.priceImpact;t={round:Number(r.round),assetOut:{assetId:s,amount:c+m},poolTokenIn:{assetId:n.poolTokenID,amount:a},internalSwapQuote:{amountIn:{assetId:n.asset2ID,amount:c},amountOut:{assetId:n.asset1ID,amount:m},swapFees:{assetId:n.asset2ID,amount:A},priceImpact:x}}}return t},generateTxns:function(e){return Zn.apply(this,arguments)},generateSingleAssetOutTxns:function(e){return Hn.apply(this,arguments)},signTxns:function(e){var t=e.txGroup;return(0,e.initiatorSigner)([t])},execute:function(e){return Kn.apply(this,arguments)}},er=l(l({},se.V1_1,On),se.V2,$n),tr=3n,nr=1000n,rr=function(e){return e[e.FEE_TXN_INDEX=0]="FEE_TXN_INDEX",e[e.VALIDATOR_APP_CALL_TXN_INDEX=1]="VALIDATOR_APP_CALL_TXN_INDEX",e[e.ASSET_IN_TXN_INDEX=2]="ASSET_IN_TXN_INDEX",e[e.ASSET_OUT_TXN_INDEX=3]="ASSET_OUT_TXN_INDEX",e}(rr||{});function ar(){return(ar=i(s().mark((function t(n){var r,a,o,i,u,c,p,l;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.pool,a=n.txGroup,o=n.initiatorSigner,t.next=3,o([a]);case 3:return i=t.sent,u=x(i,2),c=u[0],p=u[1],l=a.map((function(t,n){return n===rr.FEE_TXN_INDEX?c:n===rr.ASSET_IN_TXN_INDEX?p:e.signLogicSigTransactionObject(t.txn,r.account.lsig).blob})),t.abrupt("return",l);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function sr(){return(sr=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h,m,A,x,I,v,y,w,b;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.client,a=n.quoteAndPool,o=n.swapType,i=n.slippage,u=n.initiatorAddr,c=a.pool,p=a.quote,l=p.assetInID,d=p.assetOutID,f=c.account.address(),(g=[c.asset1ID,c.asset2ID]).includes(l)&&g.includes(d)&&l!==d){t.next=7;break}throw new V({pool:c,quote:p},"Input asset (#".concat(l,") and output asset (#").concat(d,") provided to generate transactions do not belong to the pool ").concat(f,"."));case 7:return t.next=9,r.getTransactionParams().do();case 9:return h=t.sent,m=[ne("swap"),o===re.FixedInput?ne("fi"):ne("fo")],A=e.makeApplicationNoOpTxnFromObject({sender:f,appIndex:c.validatorAppID,appArgs:m,accounts:[u],note:oe.getAppCallTxnNoteWithClientName(se.V1_1),foreignAssets:c.asset2ID==Ae?[c.asset1ID,c.poolTokenID]:[c.asset1ID,c.asset2ID,c.poolTokenID],suggestedParams:h}),x=o===re.FixedOutput?W("positive",i,p.assetInAmount):p.assetInAmount,I=l===Ae?e.makePaymentTxnWithSuggestedParamsFromObject({sender:u,receiver:f,amount:x,suggestedParams:h}):e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:u,receiver:f,assetIndex:l,amount:x,suggestedParams:h}),v=o===re.FixedInput?W("negative",i,p.assetOutAmount):p.assetOutAmount,y=d===Ae?e.makePaymentTxnWithSuggestedParamsFromObject({sender:f,receiver:u,amount:v,suggestedParams:h}):e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:f,receiver:u,assetIndex:d,amount:v,suggestedParams:h}),w=e.makePaymentTxnWithSuggestedParamsFromObject({sender:u,receiver:f,amount:A.fee+y.fee,note:E,suggestedParams:h}),b=e.assignGroupID([w,A,I,y]),t.abrupt("return",[{txn:b[0],signers:[u]},{txn:b[1],signers:[f.toString()]},{txn:b[2],signers:[u]},{txn:b[3],signers:[f.toString()]}]);case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function or(e){var t=e.pool,n=e.reserves,r=e.assetIn,s=e.decimals;if(t.status!==dt.READY)throw new k(T.NoAvailablePoolError,"There is not an available pool for this asset pair");var o,i,u,c=r.amount;if(r.id===t.asset1ID)o=t.asset2ID,i=n.asset1,u=n.asset2;else{if(r.id!==t.asset2ID)throw new k(T.AssetDoesNotBelongToPoolError,"Input asset (#".concat(r.id,") doesn't belong to the pool ").concat(t.account.address(),"."));o=t.asset1ID,i=n.asset2,u=n.asset1}var p=c*tr/nr,l=u-i*u/(i+(c-p));if(l>u)throw new k(T.OutputAmountExceedsAvailableLiquidityError,"Output amount exceeds available liquidity.");var d={assetIn:{amount:c,decimals:s.assetIn},assetOut:{amount:l,decimals:s.assetOut}},f={round:Number(n.round),assetInID:r.id,assetInAmount:c,assetOutID:o,assetOutAmount:l,swapFee:Number(p),rate:Ue(d),priceImpact:Me(a({inputSupply:i,outputSupply:u},d))};return{type:Pe.Direct,data:{pool:t,quote:f}}}function ir(e){return ur.apply(this,arguments)}function ur(){return(ur=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d,f,g,h,m,A,I;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.pool,a=t.signedTxns,o=t.assetIn,i=t.assetOut,u=t.initiatorAddr,e.next=3,ct({client:n,pool:r,accountAddr:u});case 3:return c=e.sent,e.next=6,Z(n,[a]);case 6:return p=e.sent,l=x(p,1),d=l[0],f=d.confirmedRound,g=d.txnID,e.next=13,ct({client:n,pool:r,accountAddr:u});case 13:return h=e.sent,i.id===r.asset1ID?(m=c.excessAsset1,A=h.excessAsset1):(m=c.excessAsset2,A=h.excessAsset2),(I=A-m)<0n&&(I=0n),e.abrupt("return",{round:f,assetInID:o.id,assetInAmount:o.amount,assetOutID:i.id,assetOutAmount:i.amount+I,excessAmount:{assetID:i.id,excessAmountForSwap:I,totalExcessAmount:A},txnID:g});case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function cr(e){var t=e.pool,n=e.reserves,r=e.assetOut,a=e.decimals;if(t.status!==dt.READY)throw new k(T.NoAvailablePoolError,"There is not an available pool for this asset pair");var s,o,i,u=r.amount;if(r.id===t.asset1ID)s=t.asset2ID,o=n.asset2,i=n.asset1;else{if(r.id!==t.asset2ID)throw new k(T.AssetDoesNotBelongToPoolError,"Output asset (#".concat(r.id,") doesn't belong to the pool ").concat(t.account.address(),"."));s=t.asset1ID,o=n.asset1,i=n.asset2}if(u>i)throw new k(T.OutputAmountExceedsAvailableLiquidityError,"Output amount exceeds available liquidity.");var c=o*i/(i-u)-o,p=c*nr/(nr-tr),l=p-c,d=z(a.assetOut,Number(u))/z(a.assetIn,Number(p)),f=z(a.assetOut,Number(i))/z(a.assetIn,Number(o)),g=Y({decimalPlaces:5},Math.abs(d/f-1)),h={round:Number(n.round),assetInID:s,assetInAmount:p,assetOutID:r.id,assetOutAmount:u,swapFee:Number(l),rate:d,priceImpact:g};return{type:Pe.Direct,data:{pool:t,quote:h}}}function pr(e){return lr.apply(this,arguments)}function lr(){return(lr=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d,f,g,h,m,A,I;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.pool,a=t.signedTxns,o=t.assetIn,i=t.assetOut,u=t.initiatorAddr,e.next=3,ct({client:n,pool:r,accountAddr:u});case 3:return c=e.sent,e.next=6,Z(n,[a]);case 6:return p=e.sent,l=x(p,1),d=l[0],f=d.confirmedRound,g=d.txnID,e.next=13,ct({client:n,pool:r,accountAddr:u});case 13:return h=e.sent,o.id===r.asset1ID?(m=c.excessAsset1,A=h.excessAsset1):(m=c.excessAsset2,A=h.excessAsset2),(I=A-m)<0n&&(I=0n),e.abrupt("return",{round:f,assetInID:o.id,assetInAmount:o.amount-I,assetOutID:i.id,assetOutAmount:i.amount,excessAmount:{assetID:o.id,excessAmountForSwap:I,totalExcessAmount:A},txnID:g});case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dr(){return(dr=i(s().mark((function e(t){var n,r,o,i,u,c,p,l,d,f,g,h,m,A,x,I;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.client,r=t.pool,o=t.swapType,i=t.txGroup,u=t.signedTxns,c=t.initiatorAddr,r.status===dt.READY){e.next=3;break}throw new V({pool:r,swapType:o,txGroup:i},"There is not an available pool for this asset pair");case 3:if(e.prev=3,m={id:Number(null===(p=i[rr.ASSET_IN_TXN_INDEX].txn.assetConfig)||void 0===p?void 0:p.assetIndex)||Ae,amount:null!==(l=null===(d=i[rr.ASSET_IN_TXN_INDEX].txn.payment)||void 0===d?void 0:d.amount)&&void 0!==l?l:0n},A={id:Number(null===(f=i[rr.ASSET_OUT_TXN_INDEX].txn.assetConfig)||void 0===f?void 0:f.assetIndex)||Ae,amount:null!==(g=null===(h=i[rr.ASSET_OUT_TXN_INDEX].txn.payment)||void 0===h?void 0:h.amount)&&void 0!==g?g:0n},o!==re.FixedInput){e.next=12;break}return e.next=9,ir({client:n,pool:r,signedTxns:u,assetIn:m,assetOut:A,initiatorAddr:c});case 9:x=e.sent,e.next=15;break;case 12:return e.next=14,pr({client:n,pool:r,signedTxns:u,assetIn:m,assetOut:A,initiatorAddr:c});case 14:x=e.sent;case 15:return e.abrupt("return",a(a({},x),{},{groupID:$(i),fees:K(i)}));case 18:throw e.prev=18,e.t0=e.catch(3),"SlippageTolerance"===(I=new V(e.t0,"We encountered something unexpected while swapping. Try again later.")).type&&I.setMessage("The swap failed due to too much slippage in the price. Please adjust the slippage tolerance and try again."),I;case 23:case"end":return e.stop()}}),e,null,[[3,18]])})))).apply(this,arguments)}var fr={getQuote:function(e,t,n,r,a){return e===re.FixedInput?or({pool:t,reserves:n,assetIn:r,decimals:a}):cr({pool:t,reserves:n,assetOut:r,decimals:a})},getFixedInputSwapQuote:or,getFixedOutputSwapQuote:cr,generateTxns:function(e){return sr.apply(this,arguments)},signTxns:function(e){return ar.apply(this,arguments)},execute:function(e){return dr.apply(this,arguments)},executeFixedOutputSwap:pr};function gr(e){return Promise.allSettled(e).then((function(e){if(e.every((function(e){return"rejected"===e.status}))){var t=x(e.map((function(e){return e.reason})),2),n=t[0],r=t[1];if(Ye(n)&&!Ye(r))throw n;throw r}return e.filter((function(e){return"fulfilled"===e.status&&e.value})).map((function(e){return e.value}))}))}function hr(){return(hr=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.amount,a=t.assetIn,o=t.assetOut,i=t.pools,u=[],(c=i.find((function(e){return e.info.contractVersion===se.V1_1})))?u.push(new Promise((function(e,t){try{e(fr.getFixedInputSwapQuote({pool:c.info,assetIn:{amount:r,id:Number(a.id)},decimals:{assetIn:a.decimals,assetOut:o.decimals},reserves:c.reserves}))}catch(e){t(e)}}))):u.push(Promise.reject(new k(T.NoAvailablePoolError,"Trying to swap from non-existent pool"))),p=i.find((function(e){return e.info.contractVersion===se.V2})),u.push(Wn.getFixedInputSwapQuote({amount:r,assetIn:{id:Se(a),decimals:a.decimals},assetOut:{id:Se(o),decimals:o.decimals},pool:null!==(n=null==p?void 0:p.info)&&void 0!==n?n:null,network:t.network,slippage:t.slippage})),e.next=8,gr(u);case 8:return l=e.sent,e.abrupt("return",ze(l));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mr(){return(mr=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.amount,a=t.assetIn,o=t.assetOut,i=t.pools,u=[],(c=i.find((function(e){return e.info.contractVersion===se.V1_1})))?u.push(new Promise((function(e,t){try{e(fr.getFixedOutputSwapQuote({pool:c.info,assetOut:{amount:r,id:Number(o.id)},decimals:{assetIn:a.decimals,assetOut:o.decimals},reserves:c.reserves}))}catch(e){t(e)}}))):u.push(Promise.reject(new k(T.NoAvailablePoolError,"Trying to swap from non-existent pool"))),p=i.find((function(e){return e.info.contractVersion===se.V2})),u.push(Wn.getFixedOutputSwapQuote({amount:r,assetIn:{id:Se(a),decimals:a.decimals},assetOut:{id:Se(o),decimals:o.decimals},pool:null!==(n=null==p?void 0:p.info)&&void 0!==n?n:null,network:t.network,slippage:t.slippage})),e.next=8,gr(u);case 8:return l=e.sent,e.abrupt("return",ze(l));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ar=l(l(l(l(l(l({},se.V1_1,fr),se.V2,Wn),"getQuote",(function(e){var t=e.type;if(t===re.FixedInput)return function(e){return hr.apply(this,arguments)}(e);if(t===re.FixedOutput)return function(e){return mr.apply(this,arguments)}(e);throw new k(T.InvalidSwapTypeError,"Invalid swap type")})),"generateTxns",(function(e){return e.quote.type===Pe.Direct&&Xe(e.quote)===se.V1_1?fr.generateTxns(a(a({},e),{},{quoteAndPool:e.quote.data})):Wn.generateTxns(e)})),"signTxns",(function(e){if(e.quote.type===Pe.Direct&&Xe(e.quote)===se.V1_1){var t=e.quote.data.pool;return fr.signTxns(a(a({},e),{},{pool:t}))}return Wn.signTxns(e)})),"execute",(function(e){return e.contractVersion===se.V1_1?fr.execute(e):Wn.execute(e)}));function xr(){return(xr=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.pool,a=t.txGroup,o=t.initiatorSigner,e.prev=1,e.next=4,Ir({txGroup:a,pool:r,initiatorSigner:o});case 4:return i=e.sent,e.next=7,Z(n,[i]);case 7:return u=e.sent,c=x(u,1),p=c[0],l=p.txnID,d=p.confirmedRound,e.abrupt("return",{fees:K(a),confirmedRound:d,txnID:l,groupID:$(a)});case 15:throw e.prev=15,e.t0=e.catch(1),new V(e.t0,"We encountered something unexpected while redeeming. Try again later.");case 18:case"end":return e.stop()}}),e,null,[[1,15]])})))).apply(this,arguments)}function Ir(e){return vr.apply(this,arguments)}function vr(){return(vr=i(s().mark((function t(n){var r,a,o,i,u,c,p,l;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.txGroup,a=n.pool,o=n.initiatorSigner,t.next=3,o([r]);case 3:return i=t.sent,u=x(i,1),c=u[0],p=a.account.lsig,l=r.map((function(t,n){return 0===n?c:e.signLogicSigTransactionObject(t.txn,p).blob})),t.abrupt("return",l);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function yr(){return yr=i(s().mark((function t(n){var r,a,o,u,c,p;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.data,o=n.initiatorSigner,t.prev=1,u=a.map((function(e){var t=e.txGroup,n=e.pool;return{txns:t,txnFees:K(t),groupID:$(t),lsig:n.account.lsig}})),t.next=5,o(u.map((function(e){return e.txns})));case 5:return c=t.sent,p=Promise.all(u.map((function(t,n){return new Promise(function(){var a=i(s().mark((function a(o,i){var u,p,l,d,f,g;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,u=t.txns.map((function(r,a){return 0===a?c[n]:e.signLogicSigTransactionObject(r.txn,t.lsig).blob})),a.next=4,Z(r,[u]);case 4:p=a.sent,l=x(p,1),d=l[0],f=d.txnID,g=d.confirmedRound,o({fees:t.txnFees,groupID:t.groupID,txnID:f,confirmedRound:g}),a.next=15;break;case 12:a.prev=12,a.t0=a.catch(0),i(a.t0);case 15:case"end":return a.stop()}}),a,null,[[0,12]])})));return function(e,t){return a.apply(this,arguments)}}())}))),t.abrupt("return",p);case 10:throw t.prev=10,t.t0=t.catch(1),new V(t.t0,"We encountered something unexpected while redeeming. Try again later.");case 13:case"end":return t.stop()}}),t,null,[[1,10]])}))),yr.apply(this,arguments)}function wr(){return(wr=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.pool,o=n.assetID,i=n.assetOut,u=n.initiatorAddr,t.next=3,r.getTransactionParams().do();case 3:return c=t.sent,p=a.account.address(),l=e.makeApplicationNoOpTxnFromObject({sender:p,appIndex:a.validatorAppID,appArgs:[ne("redeem")],note:oe.getAppCallTxnNoteWithClientName(a.contractVersion),accounts:[u],foreignAssets:0==a.asset2ID?[a.asset1ID,a.poolTokenID]:[a.asset1ID,a.asset2ID,a.poolTokenID],suggestedParams:c}),d=0===o?e.makePaymentTxnWithSuggestedParamsFromObject({sender:p,receiver:u,amount:i,suggestedParams:c}):e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:p,receiver:u,assetIndex:o,amount:i,suggestedParams:c}),f=e.makePaymentTxnWithSuggestedParamsFromObject({sender:u,receiver:p,amount:l.fee+d.fee,note:E,suggestedParams:c}),g=e.assignGroupID([f,l,d]),t.abrupt("return",[{txn:g[0],signers:[u]},{txn:g[1],signers:[p.toString()]},{txn:g[2],signers:[p.toString()]}]);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function br(e){var t,n={},r=w(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,s=(new TextDecoder).decode(Buffer.from(a.key,"base64")),o=void 0;o=1===a.value.type?a.value.bytes:a.value.uint,n[s]=o}}catch(e){r.e(e)}finally{r.f()}return n}function Tr(e,t,n){return e*t/n}var kr=BigInt(31536e3),Er=BigInt(1e14),Nr=BigInt(1e16),Sr={testnet:548587153,mainnet:1385499515},Pr=14;function Dr(e){return _r.apply(this,arguments)}function _r(){return(_r=i(s().mark((function t(n){var r,a,o,i,u,c;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.network,o=n.assetIDs,i=e.getApplicationAddress(Sr[a]),t.next=4,r.accountInformation(i).do();case 4:return u=t.sent,c=u.assets?u.assets.map((function(e){return e.assetId})):[],t.abrupt("return",o.filter((function(e){return e!==Ae&&!c.includes(BigInt(e))})));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Br(){return(Br=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h,m,A,v,y,w,b,T,k,E,N,P;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.network,o=n.poolAddress,i=n.poolTokenId,u=n.lendingManagerId,c=n.asset1In,p=n.asset2In,l=n.initiatorAddr,d=e.getApplicationAddress(Sr[a]),t.next=4,r.getTransactionParams().do();case 4:return f=t.sent,g=[c,p].sort((function(e,t){return t.fAssetId-e.fAssetId})),h=x(g,2),m=h[0],A=h[1],v=Ne(A.id),y=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:l,receiver:d,assetIndex:m.id,amount:m.amount,suggestedParams:f}),w=v?e.makePaymentTxnWithSuggestedParamsFromObject({sender:l,receiver:d,amount:A.amount,suggestedParams:f}):e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:l,receiver:d,assetIndex:A.id,amount:A.amount,suggestedParams:f}),(b=e.makeApplicationNoOpTxnFromObject({sender:l,appIndex:Sr[a],appArgs:[ne("add_liquidity"),e.decodeAddress(o).publicKey,e.encodeUint64(m.lendingAppId),e.encodeUint64(A.lendingAppId)],foreignAssets:[m.id,A.id,m.fAssetId,A.fAssetId],foreignApps:[m.lendingAppId,A.lendingAppId,u],accounts:[o],suggestedParams:f})).fee=f.minFee*BigInt(Pr+1),T=He(a,se.V2),k=e.makeApplicationNoOpTxnFromObject({sender:l,appIndex:Sr[a],appArgs:[ne("noop")],foreignAssets:[i],foreignApps:[T],accounts:[o],suggestedParams:f}),E=[y,w,b,k],t.next=16,Dr({client:r,network:a,assetIDs:[m.id,A.id,m.fAssetId,A.fAssetId,i]});case 16:return(N=t.sent).length&&((P=[e.makePaymentTxnWithSuggestedParamsFromObject({sender:l,receiver:d,amount:S*BigInt(N.length),suggestedParams:f}),e.makeApplicationNoOpTxnFromObject({sender:l,appIndex:Sr[a],appArgs:[ne("asset_optin")].concat(I(N.map((function(t){return e.encodeUint64(t)})))),foreignAssets:I(N),suggestedParams:f})])[1].fee=BigInt(N.length+1)*f.minFee,E.unshift.apply(E,P)),t.abrupt("return",e.assignGroupID(E).map((function(e){return{txn:e,signers:[l]}})));case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Or(){return(Or=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g,h,m,A,x,I,v;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.pool,o=n.poolTokenIn,i=n.initiatorAddr,u=n.asset1Out,c=n.asset2Out,p=n.lendingManagerId,l=n.network,d=e.getApplicationAddress(Sr[l]),t.next=4,r.getTransactionParams().do();case 4:if(f=t.sent,g=a.account.address(),h=a.poolTokenID){t.next=9;break}throw new Error("Pool token asset ID is missing");case 9:return m=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:i,receiver:d,assetIndex:h,amount:o,suggestedParams:f}),(A=e.makeApplicationNoOpTxnFromObject({sender:i,appIndex:Sr[l],appArgs:[ne("remove_liquidity"),g.publicKey,e.encodeUint64(u.lendingAppId),e.encodeUint64(c.lendingAppId)],accounts:[g],foreignAssets:[u.id,c.id,u.fAssetId,c.fAssetId],foreignApps:[u.lendingAppId,c.lendingAppId,p],suggestedParams:f})).fee=f.minFee*BigInt(Pr+1),x=He(l,se.V2),I=e.makeApplicationNoOpTxnFromObject({sender:i,appIndex:Sr[l],appArgs:[ne("noop")],accounts:[g],foreignAssets:[h,u.fAssetId,c.fAssetId],foreignApps:[x],suggestedParams:f}),v=e.assignGroupID([m,A,I]),t.abrupt("return",v.map((function(e){return{txn:e,signers:[i]}})));case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Rr(e,t,n){var r=BigInt(Math.floor((new Date).getTime()/1e3)-function(e){return null!=e?e:Math.floor((new Date).getTime()/1e3)}(n));return Tr(e,Nr+t*r/kr,Nr)}function Fr(){return(Fr=i(s().mark((function e(t,n){var r,a,o,i,u,c,p,l,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getApplicationByID(n).do();case 2:return a=e.sent,o=null!==(r=a.params.globalState)&&void 0!==r?r:[],i=br(o),u=Number(Buffer.from(i.pm,"base64").readBigUInt64BE(0)),c=Buffer.from(i.i,"base64"),p=c.readBigUInt64BE(32),l=c.readBigUInt64BE(40),d=Number(c.readBigUInt64BE(48)),e.abrupt("return",{appId:n,managerAppId:u,depositInterestRate:p,depositInterestIndex:l,lastUpdate:d});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Cr={AddLiquidity:Object.freeze({__proto__:null,generateTxns:function(e){return Br.apply(this,arguments)},getAddLiquidityTotalFee:function(e,t){return e*BigInt(4+Pr)+(t?BigInt(t+1)*e+BigInt(t)*S:0n)}}),RemoveLiquidity:Object.freeze({__proto__:null,generateTxns:function(e){return Or.apply(this,arguments)},getRemoveLiquidityTotalFee:function(e){return e*BigInt(3+Pr)}}),calculateWithdrawReturn:function(e){var t=e.withdrawAmount,n=Rr(e.depositInterestIndex,e.depositInterestRate,e.lastUpdate);return Tr(BigInt(t),n,Er)},calculateDepositReturn:function(e){var t=e.depositAmount,n=Rr(e.depositInterestIndex,e.depositInterestRate,e.lastUpdate);return t*Er/n},getFolksWrapperAppOptInRequiredAssetIDs:Dr};function Qr(t){var n=t.suggestedParams,r=t.stakingAppID,a=t.initiatorAddr,s=t.liquidityAssetID,o=t.program,i=t.amount,u=e.encodeUint64(i),c=e.encodeUint64(o.id);return e.makeApplicationNoOpTxnFromObject({appIndex:r,sender:a,suggestedParams:n,foreignAssets:[s],accounts:[o.accountAddress],appArgs:[ne("commit"),u],note:M(ne("tinymanStaking/v1:b"),c,e.encodeUint64(s),u)})}function Lr(){return(Lr=i(s().mark((function t(n){var r,a,o,i,u,c,p,l,d,f,g;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,a=n.stakingAppID,o=n.program,i=n.requiredAssetID,u=n.liquidityAssetID,c=n.amount,p=n.initiatorAddr,t.next=3,r.getTransactionParams().do();case 3:if(l=t.sent,d=Qr({suggestedParams:l,stakingAppID:a,program:o,liquidityAssetID:u,initiatorAddr:p,amount:c}),f=[d],"number"!=typeof i){t.next=10;break}return g=e.makeApplicationNoOpTxnFromObject({appIndex:a,sender:p,suggestedParams:l,foreignAssets:[i],accounts:[o.accountAddress],appArgs:[ne("log_balance")]}),f=e.assignGroupID([d,g]),t.abrupt("return",[{txn:f[0],signers:[p]},{txn:f[1],signers:[p]}]);case 10:return t.abrupt("return",[{txn:f[0],signers:[p]}]);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Vr=604800,Ur=1e3,Mr={testnet:480164661,mainnet:2200606875},jr={testnet:360907790,mainnet:2200609638},Gr={testnet:336189106,mainnet:2200608153},Xr={testnet:383416252,mainnet:2200608887},Wr=2500,zr=400,Yr=604800,Jr=ne("p"),qr=ne("a"),Zr=24,Hr=111300,Kr=Wr+zr*(41+Zr),$r=function(e){return e[e.Against=0]="Against",e[e.For=1]="For",e[e.Abstain=2]="Abstain",e}($r||{}),ea=new Uint8Array(34);function ta(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}var na=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var a=0;a<e.length;a++){var s=e.charAt(a),o=s.charCodeAt(0);if(255!==n[o])throw new TypeError(s+" is ambiguous");n[o]=a}var i=e.length,u=e.charAt(0),c=Math.log(i)/Math.log(256),p=Math.log(256)/Math.log(i);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,a=0;e[t]===u;)r++,t++;for(var s=(e.length-t)*c+1>>>0,o=new Uint8Array(s);e[t];){var p=n[e.charCodeAt(t)];if(255===p)return;for(var l=0,d=s-1;(0!==p||l<a)&&-1!==d;d--,l++)p+=i*o[d]>>>0,o[d]=p%256>>>0,p=p/256>>>0;if(0!==p)throw new Error("Non-zero carry");a=l,t++}if(" "!==e[t]){for(var f=s-a;f!==s&&0===o[f];)f++;for(var g=new Uint8Array(r+(s-f)),h=r;f!==s;)g[h++]=o[f++];return g}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,a=0,s=t.length;a!==s&&0===t[a];)a++,n++;for(var o=(s-a)*p+1>>>0,c=new Uint8Array(o);a!==s;){for(var l=t[a],d=0,f=o-1;(0!==l||d<r)&&-1!==f;f--,d++)l+=256*c[f]>>>0,c[f]=l%i>>>0,l=l/i>>>0;if(0!==l)throw new Error("Non-zero carry");r=d,a++}for(var g=o-r;g!==o&&0===c[g];)g++;for(var h=u.repeat(n);g<o;++g)h+=e.charAt(c[g]);return h},decodeUnsafe:l,decode:function(e){var n=l(e);if(n)return n;throw new Error(`Non-${t} character`)}}},ra=na;class aa{name;prefix;baseEncode;constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class sa{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,n){this.name=e,this.prefix=t;const r=t.codePointAt(0);if(void 0===r)throw new Error("Invalid prefix character");this.prefixCodePoint=r,this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return ia(this,e)}}class oa{decoders;constructor(e){this.decoders=e}or(e){return ia(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(null!=n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function ia(e,t){return new oa({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class ua{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new aa(e,t,n),this.decoder=new sa(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function ca({name:e,prefix:t,encode:n,decode:r}){return new ua(e,t,n,r)}function pa({name:e,prefix:t,alphabet:n}){const{encode:r,decode:a}=ra(n,e);return ca({prefix:t,name:e,encode:r,decode:e=>ta(a(e))})}function la({name:e,prefix:t,bitsPerChar:n,alphabet:r}){return ca({prefix:t,name:e,encode:e=>function(e,t,n){const r="="===t[t.length-1],a=(1<<n)-1;let s="",o=0,i=0;for(let r=0;r<e.length;++r)for(i=i<<8|e[r],o+=8;o>n;)o-=n,s+=t[a&i>>o];if(0!==o&&(s+=t[a&i<<n-o]),r)for(;0!=(s.length*n&7);)s+="=";return s}(e,r,n),decode:t=>function(e,t,n,r){const a={};for(let e=0;e<t.length;++e)a[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*n/8|0);let i=0,u=0,c=0;for(let t=0;t<s;++t){const s=a[e[t]];if(void 0===s)throw new SyntaxError(`Non-${r} character`);u=u<<n|s,i+=n,i>=8&&(i-=8,o[c++]=255&u>>i)}if(i>=n||0!=(255&u<<8-i))throw new SyntaxError("Unexpected end of data");return o}(t,r,n,e)})}const da=la({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});la({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),la({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),la({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),la({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),la({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),la({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),la({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),la({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const fa=pa({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"});pa({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});const ga=pa({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});pa({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ha=function e(t,n,r){n=n||[];var a=r=r||0;for(;t>=xa;)n[r++]=255&t|ma,t/=128;for(;t&Aa;)n[r++]=255&t|ma,t>>>=7;return n[r]=0|t,e.bytes=r-a+1,n},ma=128,Aa=-128,xa=Math.pow(2,31);var Ia=function e(t,n){var r,a=0,s=0,o=n=n||0,i=t.length;do{if(o>=i)throw e.bytes=0,new RangeError("Could not decode varint");r=t[o++],a+=s<28?(r&ya)<<s:(r&ya)*Math.pow(2,s),s+=7}while(r>=va);return e.bytes=o-n,a},va=128,ya=127;var wa=Math.pow(2,7),ba=Math.pow(2,14),Ta=Math.pow(2,21),ka=Math.pow(2,28),Ea=Math.pow(2,35),Na=Math.pow(2,42),Sa=Math.pow(2,49),Pa=Math.pow(2,56),Da=Math.pow(2,63),_a={encode:ha,decode:Ia,encodingLength:function(e){return e<wa?1:e<ba?2:e<Ta?3:e<ka?4:e<Ea?5:e<Na?6:e<Sa?7:e<Pa?8:e<Da?9:10}};function Ba(e,t=0){return[_a.decode(e,t),_a.decode.bytes]}function Oa(e,t,n=0){return _a.encode(e,t,n),t}function Ra(e){return _a.encodingLength(e)}function Fa(e,t){const n=t.byteLength,r=Ra(e),a=r+Ra(n),s=new Uint8Array(a+n);return Oa(e,s,0),Oa(n,s,r),s.set(t,a),new Ca(e,n,t,s)}class Ca{code;size;digest;bytes;constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}function Qa(e,t){const{bytes:n,version:r}=e;return 0===r?function(e,t,n){const{prefix:r}=n;if(r!==ga.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const a=t.get(r);if(null==a){const a=n.encode(e).slice(1);return t.set(r,a),a}return a}(n,Va(e),t??ga.encoder):function(e,t,n){const{prefix:r}=n,a=t.get(r);if(null==a){const a=n.encode(e);return t.set(r,a),a}return a}(n,Va(e),t??da.encoder)}const La=new WeakMap;function Va(e){const t=La.get(e);if(null==t){const t=new Map;return La.set(e,t),t}return t}class Ua{code;version;multihash;bytes;"/";constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Ma)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==ja)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ua.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=Fa(e,t);return Ua.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ua.equals(this,e)}static equals(e,t){const n=t;return null!=n&&e.code===n.code&&e.version===n.version&&function(e,t){if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}(e.bytes,n.bytes)}}(e.multihash,n.multihash)}toString(e){return Qa(this,e)}toJSON(){return{"/":Qa(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Ua)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:a}=t;return new Ua(e,n,r,a??Ga(e,n,r.bytes))}if(!0===t[Xa]){const{version:e,multihash:n,code:r}=t,a=function(e){const t=ta(e),[n,r]=Ba(t),[a,s]=Ba(t.subarray(r)),o=t.subarray(r+s);if(o.byteLength!==a)throw new Error("Incorrect length");return new Ca(n,a,o,t)}(n);return Ua.create(e,r,a)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Ma)throw new Error(`Version 0 CID must use dag-pb (code: ${Ma}) block encoding`);return new Ua(e,t,n,n.bytes);case 1:{const r=Ga(e,t,n.bytes);return new Ua(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return Ua.create(0,Ma,e)}static createV1(e,t){return Ua.create(1,e,t)}static decode(e){const[t,n]=Ua.decodeFirst(e);if(0!==n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Ua.inspectBytes(e),n=t.size-t.multihashSize,r=ta(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const a=r.subarray(t.multihashSize-t.digestSize),s=new Ca(t.multihashCode,t.digestSize,a,r);return[0===t.version?Ua.createV0(s):Ua.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=Ba(e.subarray(t));return t+=r,n};let r=n(),a=Ma;if(18===r?(r=0,t=0):a=n(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const s=t,o=n(),i=n(),u=t+i;return{version:r,codec:a,multihashCode:o,digestSize:i,multihashSize:u-s,size:u}}static parse(e,t){const[n,r]=function(e,t){switch(e[0]){case"Q":{const n=t??ga;return[ga.prefix,n.decode(`${ga.prefix}${e}`)]}case ga.prefix:{const n=t??ga;return[ga.prefix,n.decode(e)]}case da.prefix:{const n=t??da;return[da.prefix,n.decode(e)]}case fa.prefix:{const n=t??fa;return[fa.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}(e,t),a=Ua.decode(r);if(0===a.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Va(a).set(n,e),a}}const Ma=112,ja=18;function Ga(e,t,n){const r=Ra(e),a=r+Ra(t),s=new Uint8Array(a+n.byteLength);return Oa(e,s,0),Oa(t,s,r),s.set(n,a),s}const Xa=Symbol.for("@ipld/js-cid/CID");class Wa{name;code;encode;constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Fa(this.code,t):t.then((e=>Fa(this.code,e)))}throw Error("Unknown type, must be binary type")}}const za=85,Ya=function({name:e,code:t,encode:n}){return new Wa(e,t,n)}({name:"sha2-256",code:18,encode:e=>ta(n.createHash("sha256").update(e).digest())});var Ja=126144e3,qa=1e7,Za=Math.pow(2,64),Ha=48,Ka=21,$a=48,es=ne("tp"),ts=ne("sc"),ns=28100,rs=12900,as=421700,ss=409700;function os(e){var t=e/Yr;return(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?Math.floor(t):Math.ceil(t))*Yr}function is(e,t){if(e>t)throw new Error("Old timestamp must be less than or equal to new timestamp");for(var n=[],r=os(e)+Yr;r<t;)n.push(r),r+=Yr;return n.push(t),n}function us(e,t,n){return cs.apply(this,arguments)}function cs(){return(cs=i(s().mark((function e(t,n,r){var a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getApplicationBoxByName(n,r).do();case 3:return a=e.sent,o=a.value,e.abrupt("return",o);case 8:if(e.prev=8,e.t0=e.catch(0),!e.t0.message.includes("box not found")){e.next=12;break}return e.abrupt("return",null);case 12:throw e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function ps(e,t,n){return ls.apply(this,arguments)}function ls(){return(ls=i(s().mark((function e(t,n,r){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,us(t,n,r);case 3:return a=e.sent,e.abrupt("return",Boolean(a));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function ds(e,t){if(t<0)throw new Error("Time delta must be greater than or equal to 0");return Math.floor(e*t/Za)}function fs(e,t,n){var r=ds(t,n);r>e?r=t?e*e*Za/(2*t):0:r=(e+(e-r))*n/2;return r}function gs(e,t){return hs.apply(this,arguments)}function hs(){return(hs=i(s().mark((function e(t,n){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getApplicationByID(n).do();case 2:return r=e.sent,e.abrupt("return",ms(r));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ms(e){var t,n,r={},a=w(null!==(t=e.params.globalState)&&void 0!==t?t:[]);try{for(a.s();!(n=a.n()).done;){var s=n.value,o=Buffer.from(s.key).toString(),i=void 0;i=1===s.value.type?s.value.bytes:s.value.uint,r[o]=i}}catch(e){a.e(e)}finally{a.f()}return r}function As(){return(As=i(s().mark((function e(t){var n,r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(new TextEncoder).encode(t),e.next=3,Ya.digest(n);case 3:return r=e.sent,a=Ua.createV1(za,r),e.abrupt("return",a.toString(da));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xs(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n.flat().map((function(t){return t.group=void 0,e.decodeUnsignedTransaction(e.encodeUnsignedTransaction(t))}));return e.assignGroupID(a)}function Is(e,t){return vs.apply(this,arguments)}function vs(){return(vs=i(s().mark((function e(t,n){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getApplicationBoxes(n).do();case 2:return r=e.sent,e.abrupt("return",r.boxes.map((function(e){return e.name})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ys=function(){return p((function e(t,n,r,a,s,o,i,c,p,l,d,f,g,h,m,A,x){u(this,e),this.index=t,this.creationTimestamp=n,this.votingStartTimestamp=r,this.votingEndTimestamp=a,this.snapshotTotalVotingPower=s,this.voteCount=o,this.quorumNumerator=i,this.againstVotingPower=c,this.forVotingPower=p,this.abstainVotingPower=l,this.isApproved=d,this.isCancelled=f,this.isExecuted=g,this.isQuorumReached=h,this.proposerAddress=m,this.executionHash=A,this.executorAddress=x}),[{key:"snapshotTimestamp",get:function(){return this.creationTimestamp}}])}(),ws=p((function e(t,n,r,a,s,o,i,c,p,l){u(this,e),this.vaultAppId=Number(t),this.proposalIndexCounter=Number(n),this.votingDelay=Number(r),this.votingDuration=Number(a),this.proposalThreshold=Number(s),this.proposalThresholdNumerator=Number(o),this.quorumThreshold=Number(i),this.approvalRequirement=Number(c),this.manager=p,this.proposalManager=l}));function bs(e){return M(Jr,ne(e))}function Ts(t){var n=Buffer.from(t);return new ys(n.readUIntBE(0,8),n.readUIntBE(8,8),n.readUIntBE(16,8),n.readUIntBE(24,8),n.readUIntBE(32,8),n.readUIntBE(40,8),n.readUIntBE(48,8),n.readUIntBE(56,8),n.readUIntBE(64,8),n.readUIntBE(72,8),Boolean(n.readUIntBE(80,1)),Boolean(n.readUIntBE(81,1)),Boolean(n.readUIntBE(82,1)),Boolean(n.readUIntBE(83,1)),e.encodeAddress(new Uint8Array(n.subarray(84,116))),t.slice(116,150).toString(),e.encodeAddress(new Uint8Array(n.subarray(150,182))))}function ks(){return(ks=i(s().mark((function e(t,n,r){var a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=bs(r),e.next=3,us(t,n,a);case 3:if(o=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",Ts(o));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Es="AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY5HFKQ",Ns=function(){return p((function e(t,n,r,a){u(this,e),this.lockedAmount=t,this.lockEndTime=n,this.powerCount=r,this.deletedPowerCount=a}),[{key:"freeAccountPowerSpaceCount",get:function(){var e=this.powerCount%Ka;return e>0?Ka-e:0}},{key:"lastAccountPowerBoxIndex",get:function(){return Cs(BigInt(this.powerCount))[0]}},{key:"lastAccountPowerArrayIndex",get:function(){return Cs(BigInt(this.powerCount))[1]}}])}(),Ss=function(){return p((function e(t,n,r,a){u(this,e),this.bias=t,this.timestamp=n,this.slope=r,this.cumulativePower=a}),[{key:"lockEndTimestamp",get:function(){var e=this.bias*Math.pow(2,64)/this.slope;return this.timestamp+e}},{key:"cumulativePowerAt",value:function(e){var t=e-this.timestamp;if(t<0)throw new Error("Time delta must be greater than or equal to 0");return this.cumulativePower+fs(this.bias,this.slope,t)}}])}(),Ps=p((function e(t,n,r,a){u(this,e),this.bias=t,this.timestamp=n,this.slope=r,this.cumulativePower=a})),Ds=p((function e(t){u(this,e),this.slopeDelta=t})),_s=function(){return p((function e(t,n,r,a){u(this,e),this.totalLockedAmount=t,this.totalPowerCount=n,this.lastTotalPowerTimestamp=Number(r),this.tinyAssetId=Number(a)}),[{key:"freeTotalPowerSpaceCount",get:function(){var e=Number(this.totalPowerCount%BigInt(Ka));return e>0?Ka-e:0}},{key:"lastTotalPowerBoxIndex",get:function(){return Cs(this.totalPowerCount)[0]}},{key:"lastTotalPowerArrayIndex",get:function(){return Cs(this.totalPowerCount)[1]}}])}();function Bs(){return(Bs=i(s().mark((function e(t,n,r){var a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Rs(r),e.prev=1,e.next=4,us(t,n,a);case 4:if(!(o=e.sent)){e.next=7;break}return e.abrupt("return",Os(o));case 7:return e.abrupt("return",null);case 10:return e.prev=10,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function Os(e){var t=Buffer.from(e);return new Ns(t.readUIntBE(0,8),t.readUIntBE(8,8),t.readUIntBE(16,8),t.readUIntBE(24,8))}function Rs(t){return e.decodeAddress(t).publicKey}function Fs(e){var t=ee(e),n=new Uint8Array(es.length+t.length);return n.set(es,0),n.set(t,es.length),n}function Cs(e){var t=e-1n;return[Number(t/BigInt(Ka)),Number(t%BigInt(Ka))]}function Qs(t,n){var r=e.decodeAddress(t).publicKey,a=ee(n),s=new Uint8Array(r.length+a.length);return s.set(r,0),s.set(a,r.length),s}function Ls(e,t,n){return Vs.apply(this,arguments)}function Vs(){return(Vs=i(s().mark((function e(t,n,r){var a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Ms(r),e.next=3,us(t,n,a);case 3:if(o=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",Us(o));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Us(t){return new Ds(Number(e.bytesToBigInt(t.slice(t.length-16,t.length))))}function Ms(e){return M(ts,ee(e))}function js(e,t,n){return Gs.apply(this,arguments)}function Gs(){return(Gs=i(s().mark((function e(t,n,r){var a,o,i,u,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0,r&&(a=Number((r+BigInt(Ka-1))/BigInt(Ka))),o=[],i=0;case 4:if(!(i<a)){e.next=13;break}return u=Fs(i),e.next=8,us(t,n,u);case 8:(c=e.sent)&&o.push.apply(o,I(Xs(c)));case 10:i++,e.next=4;break;case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xs(e){for(var t,n=$a,r=[],a=0;a<e.length;a+=n)t=e.slice(a,a+n),r.push(t);for(var s=[],o=0,i=r;o<i.length;o++){var u=i[o];if(u.every((function(e){return 0===e})))break;var c=Buffer.from(u);s.push(new Ps(c.readUIntBE(0,8),c.readUIntBE(8,8),c.readUIntBE(16,16),c.readUIntBE(32,16)))}return s}function Ws(e){return zs.apply(this,arguments)}function zs(){return(zs=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.algodClient,r=t.address,a=t.appId,o=t.powerCount,u=0,(i=void 0===o?null:o)&&(u=Math.ceil(i/Ka)),c=[],p=0;case 5:if(!(p<u)){e.next=14;break}return l=Qs(r,p),e.next=9,us(n,a,l);case 9:(d=e.sent)&&c.push.apply(c,I(Js(d)));case 11:p++,e.next=5;break;case 14:return e.abrupt("return",c);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ys(e,t){for(var n=null,r=0;r<e.length;r++){if(!(t>=e[r].timestamp))break;n=r}return n}function Js(e){for(var t,n=Ha,r=[],a=0;a<e.length;a+=n)t=e.slice(a,a+n),r.push(t);for(var s=[],o=0,i=r;o<i.length;o++){var u=i[o];if(u.every((function(e){return 0===e})))break;var c=Buffer.from(u);s.push(new Ss(c.readUIntBE(0,8),c.readUIntBE(8,8),c.readUIntBE(16,16),c.readUIntBE(32,16)))}return s}function qs(t){var n=t.proposalId,r=t.proposalVotingAppId,a=t.sender,s=t.vaultAppId,o=t.vaultAppGlobalState,i=t.executionHash,u=t.executor,c=t.suggestedParams,p=t.appCallNote,l=bs(n),d=Rs(a),f=Fs(o.lastTotalPowerBoxIndex),g=[e.makePaymentTxnWithSuggestedParamsFromObject({sender:a,receiver:e.getApplicationAddress(r),amount:Hr,suggestedParams:c}),e.makeApplicationNoOpTxnFromObject({sender:a,suggestedParams:c,appIndex:r,appArgs:[ne("create_proposal"),ne(n),i?ne(i):ea,null!=u?u:e.decodeAddress(Es).publicKey],foreignApps:[s],boxes:[{appIndex:r,name:l},{appIndex:s,name:d},{appIndex:s,name:f}],note:p?ne(p):void 0})];return g[1].fee*=3n,e.assignGroupID(g)}function Zs(t){var n=t.accountPowerIndex,r=t.createAttendanceSheetBox,a=t.proposal,s=t.proposalId,o=t.proposalVotingAppId,i=t.sender,u=t.suggestedParams,c=t.vaultAppId,p=t.vote,l=t.appCallNote;if(![$r.Abstain,$r.Against,$r.For].includes(p))throw new Error("Invalid vote");var d,f,g=Math.floor(n/Ka),h=Math.floor(a.index/(8*Zr)),m=[{appIndex:o,name:bs(s)},{appIndex:o,name:(d=i,f=h,M(qr,e.decodeAddress(d).publicKey,ee(f)))},{appIndex:c,name:Rs(i)},{appIndex:c,name:Qs(i,g)},{appIndex:c,name:Qs(i,g+1)}],A=[e.makeApplicationNoOpTxnFromObject({sender:i,suggestedParams:u,appIndex:o,appArgs:[ne("cast_vote"),ne(s),ee(p),ee(n)],foreignApps:[c],boxes:m,note:l?ne(l):void 0})];if(A[0].fee*=2n,r){var x=e.makePaymentTxnWithSuggestedParamsFromObject({sender:i,receiver:e.getApplicationAddress(o),suggestedParams:u,amount:Kr});A.unshift(x)}return e.assignGroupID(A)}var Hs=ne("rp"),Ks=1012,$s=ne("c"),eo=42,to=Wr+zr*(41+Ks),no=p((function e(t,n,r,a,s,o,i){u(this,e),this.tinyAssetId=Number(t),this.vaultAppId=Number(n),this.rewardHistoryCount=Number(r),this.firstPeriodTimestamp=Number(a),this.rewardPeriodCount=Number(s),this.manager=o,this.rewardsManager=i})),ro=p((function e(t){u(this,e),this.value=t}));function ao(t,n){var r=e.decodeAddress(t).publicKey,a=ee(n),s=new Uint8Array($s.length+r.length+a.length);return s.set($s,0),s.set(r,$s.length),s.set(a,$s.length+r.length),s}function so(e,t,n,r){return oo.apply(this,arguments)}function oo(){return(oo=i(s().mark((function e(t,n,r,a){var o,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=ao(r,a),e.next=3,us(t,n,o);case 3:if(i=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",new ro(i));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}for(var io,uo=[],co=0;co<256;++co)uo.push((co+256).toString(16).slice(1));var po=new Uint8Array(16);function lo(){if(!io&&!(io="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return io(po)}var fo={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function go(e,t,n){if(fo.randomUUID&&!t&&!e)return fo.randomUUID();var r=(e=e||{}).random||(e.rng||lo)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return function(e,t=0){return(uo[e[t+0]]+uo[e[t+1]]+uo[e[t+2]]+uo[e[t+3]]+"-"+uo[e[t+4]]+uo[e[t+5]]+"-"+uo[e[t+6]]+uo[e[t+7]]+"-"+uo[e[t+8]]+uo[e[t+9]]+"-"+uo[e[t+10]]+uo[e[t+11]]+uo[e[t+12]]+uo[e[t+13]]+uo[e[t+14]]+uo[e[t+15]]).toLowerCase()}(r)}function ho(t){var n=t.sender,r=t.index,a=t.suggestedParams,s=t.boxes,o=void 0===s?[]:s,i=t.extraAppArgs,u=void 0===i?[]:i,c=t.foreignApps,p=void 0===c?[]:c,l=Math.max(0,8-p.length-o.length),d=Array(l).fill({appIndex:0,name:ne("")}),f=[].concat(I(o),I(d));return e.makeApplicationNoOpTxnFromObject({sender:n,suggestedParams:a,appIndex:r,appArgs:[ne("increase_budget")].concat(I(u)),foreignApps:p,boxes:f,note:ne(go())})}function mo(t){for(var n=t.rewardsAppId,r=t.vaultAppId,a=t.tinyAssetId,s=t.sender,o=t.periodIndexStart,i=t.periodCount,u=t.accountPowerIndexes,c=t.suggestedParams,p=t.createRewardClaimSheet,l=t.appCallNote,d=[],f=[],g=[],h=[],m=function(){var e,t,r=Math.floor(A/eo),a=(e=ee(r),(t=new Uint8Array(Hs.length+e.length)).set(Hs,0),t.set(e,Hs.length),t);f.find((function(e){return e.name.toString()===a.toString()}))||f.push({appIndex:n,name:a});var o=Math.floor(A/(8*Ks)),i=ao(s,o);g.find((function(e){return e.name.toString()===i.toString()}))||g.push({appIndex:n,name:i})},A=o;A<o+i;A++)m();var x,v=w(u);try{var y=function(){var e=x.value,t=Math.floor(e/Ka),n=Qs(s,t),a={appIndex:r,name:n};h.find((function(e){return e.name.toString()===n.toString()}))||h.push(a),n=Qs(s,t+1),a={appIndex:r,name:n},h.find((function(e){return e.name.toString()===n.toString()}))||h.push(a)};for(v.s();!(x=v.n()).done;)y()}catch(e){v.e(e)}finally{v.f()}if((d=[{appIndex:r,name:Rs(s)}].concat(g,f,h)).length>=11)throw new Error("Boxes' length cannot be larger than 10");var b=d.slice(0,6),T=[e.makeApplicationNoOpTxnFromObject({sender:s,suggestedParams:c,appIndex:n,appArgs:[ne("claim_rewards"),ee(o),ee(i),M.apply(void 0,I(u.map((function(e){return ee(e)}))))],foreignApps:[r],foreignAssets:[a],boxes:b,note:l?ne(l):void 0})];T[0].fee=T[0].fee*BigInt(i+2);var k=0,E=92+865*i,N=700+700*i;if(E>N&&(k=Math.floor((E-N)/666)+1),k||d.length>6){var S=d.slice(6),P=ho({sender:s,suggestedParams:c,extraAppArgs:[ee(Math.max(k-1,0))],index:n,foreignApps:[r],boxes:S});P.fee*=BigInt(Math.max(k,1)),T.unshift(P)}if(p){var D=e.makePaymentTxnWithSuggestedParamsFromObject({sender:s,receiver:e.getApplicationAddress(n),amount:to,suggestedParams:c});T.unshift(D)}return e.assignGroupID(T)}function Ao(e,t){return 0===Buffer.compare(e,t)}function xo(e){for(var t=0n,n=0;n<e.byteLength;n++){var r=e[n];t*=BigInt(256),t+=BigInt(r)}return Number(t)}var Io=8,vo=ne("p"),yo=ne("a"),wo=ne("v"),bo=28500,To=12500,ko=p((function e(t,n,r,a,s,o,i){u(this,e),this.index=t,this.creationTimestamp=n,this.votingStartTimestamp=r,this.votingEndTimestamp=a,this.votingPower=s,this.voteCount=o,this.isCancelled=i}));function Eo(t,n){return M(yo,e.decodeAddress(t).publicKey,ee(n))}function No(e){return new ko(xo(e.slice(0,8)),xo(e.slice(8,16)),xo(e.slice(16,24)),xo(e.slice(24,32)),xo(e.slice(32,40)),xo(e.slice(40,48)),Boolean(xo(e.slice(48,49))))}function So(){return(So=i(s().mark((function e(t,n,r){var a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=bs(r),e.next=3,us(t,n,a);case 3:if(o=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",No(o));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Po(t){var n=t.stakingVotingAppId,r=t.vaultAppId,a=t.sender,s=t.proposalId,o=t.proposal,i=t.votes,u=t.assetIds,c=t.accountPowerIndex,p=t.appBoxNames,l=t.suggestedParams,d=t.appCallNote,f=void 0===d?null:d;if(i.length!==u.length)throw new Error("The number of votes must be equal to the number of asset ids");if(u.length>Io)throw new Error("You cannot cast vote for more than ".concat(Io," different pools"));if(100!==i.reduce((function(e,t){return e+t}),0))throw new Error("The sum of the votes must equal 100%");var g,h=M.apply(void 0,I(i.map((function(e){return ee(e)})))),m=M.apply(void 0,I(u.map((function(e){return ee(e)})))),A=function(e){return M(vo,ne(e))}(s),x=Eo(a,Math.floor(o.index/8192)),v=!p.some((function(e){return Ao(e,x)})),y=Rs(a),b=Math.floor(c/Ka),T=Qs(a,b),k=Qs(a,b+1),E=0,N=[],S=w(u);try{var P=function(){var e=g.value,t=function(e,t){return M(wo,ee(e),ee(t))}(o.index,e);N.push({appIndex:n,name:t}),p.some((function(e){return Ao(e,t)}))||(E+=1)};for(S.s();!(g=S.n()).done;)P()}catch(e){S.e(e)}finally{S.f()}var D=[{appIndex:n,name:A},{appIndex:n,name:x}].concat(N,[{appIndex:r,name:y},{appIndex:r,name:T},{appIndex:r,name:k}]),_=[e.makeApplicationNoOpTxnFromObject({sender:a,suggestedParams:l,appIndex:n,appArgs:[ne("cast_vote"),ne(s),h,m,ee(c)],foreignApps:[r],boxes:D.slice(0,7),note:f?ne(f):void 0})];_[0].fee*=2n,D.length>=7&&_.push(ho({sender:a,suggestedParams:l,index:r,foreignApps:[n],boxes:D.slice(7,14)})),D.length>=14&&_.push(ho({sender:a,suggestedParams:l,index:r,foreignApps:[n],boxes:D.slice(14)}));var B=Number(v)*bo+E*To;return B&&(_=[e.makePaymentTxnWithSuggestedParamsFromObject({sender:a,receiver:e.getApplicationAddress(n),suggestedParams:l,amount:B})].concat(I(_))),e.assignGroupID(_)}function Do(t){var n=t.accountState,r=t.lockEndTime,a=t.lockedAmount,s=t.network,o=t.sender,i=t.vaultAppGlobalState,u=t.suggestedParams,c=t.slopeChangeAtLockEndTime,p=t.appCallNote;if(a<qa)throw new Error("Insufficient lock amount");if(r%Yr!=0)throw new Error("Invalid lock end time");var l=Mr[s],d=[{appIndex:l,name:Rs(o)},{appIndex:l,name:Fs(i.lastTotalPowerBoxIndex)},{appIndex:l,name:Fs(i.lastTotalPowerBoxIndex+1)}];if(n){var f=Qs(o,n.lastAccountPowerBoxIndex);if(d.push({appIndex:l,name:f}),!n.freeAccountPowerSpaceCount){var g=Qs(o,n.lastAccountPowerBoxIndex+1);d.push({appIndex:l,name:g})}}else{var h=Qs(o,0);d.push({appIndex:l,name:h})}var m=Ms(r);d.push({appIndex:l,name:m});var A,x=is(i.lastTotalPowerTimestamp,Date.now()/1e3),I=x.length,v=w(x);try{for(v.s();!(A=v.n()).done;){var y=A.value;if(y%Yr==0){var b=Ms(y);d.push({appIndex:l,name:b})}}}catch(e){v.e(e)}finally{v.f()}var T=0;n?n.freeAccountPowerSpaceCount||(T+=as):(T+=ns,T+=as),I>i.freeTotalPowerSpaceCount&&(T+=ss),c||(T+=rs);var k=[e.makeAssetTransferTxnWithSuggestedParamsFromObject({amount:a,assetIndex:ve[s],sender:o,receiver:e.getApplicationAddress(l),suggestedParams:u}),e.makeApplicationNoOpTxnFromObject({appIndex:l,sender:o,suggestedParams:u,appArgs:[ne("create_lock"),ee(r)],boxes:d.slice(0,8),note:p}),ho({sender:o,suggestedParams:u,index:l,boxes:d.slice(8)})];if(T){var E=e.makePaymentTxnWithSuggestedParamsFromObject({sender:o,receiver:e.getApplicationAddress(l),amount:T,suggestedParams:u});k.unshift(E)}return e.assignGroupID(k)}function _o(t){var n=t.accountState,r=t.lockedAmount,a=t.network,s=t.sender,o=t.vaultAppGlobalState,i=t.suggestedParams,u=t.appCallNote;if(r<qa)throw new Error("Insufficient lock amount");var c,p=Rs(s),l=Qs(s,n.lastAccountPowerBoxIndex),d=Fs(o.lastTotalPowerBoxIndex),f=Fs(o.lastTotalPowerBoxIndex+1),g=Ms(n.lockEndTime),h=[{appIndex:Mr[a],name:p},{appIndex:Mr[a],name:l},{appIndex:Mr[a],name:d},{appIndex:Mr[a],name:f},{appIndex:Mr[a],name:g}],m=is(o.lastTotalPowerTimestamp,Date.now()/1e3),A=m.length,x=w(m);try{for(x.s();!(c=x.n()).done;){var I=c.value;I%Yr==0&&(g=Ms(I),h.push({appIndex:Mr[a],name:g}))}}catch(e){x.e(e)}finally{x.f()}var v=0;if(A>o.freeTotalPowerSpaceCount&&(v+=ss),!n.freeAccountPowerSpaceCount){var y=Qs(s,n.lastAccountPowerBoxIndex+1);h.push({appIndex:Mr[a],name:y}),v+=as}var b=[e.makeAssetTransferTxnWithSuggestedParamsFromObject({assetIndex:ve[a],sender:s,receiver:e.getApplicationAddress(Mr[a]),amount:r,suggestedParams:i}),e.makeApplicationNoOpTxnFromObject({appIndex:Mr[a],sender:s,suggestedParams:i,appArgs:[ne("increase_lock_amount")],boxes:h,note:u}),ho({sender:s,suggestedParams:i,index:Mr[a]})];if(v){var T=e.makePaymentTxnWithSuggestedParamsFromObject({sender:s,receiver:e.getApplicationAddress(Mr[a]),amount:v,suggestedParams:i});b.unshift(T)}return e.assignGroupID(b)}function Bo(t){var n=t.accountState,r=t.network,a=t.newLockEndTime,s=t.slopeChangeAtNewLockEndTime,o=t.sender,i=t.vaultAppGlobalState,u=t.suggestedParams,c=t.appCallNote;if(a%Yr)throw new Error("Invalid lock end time");if(a<=n.lockEndTime)throw new Error("New lock end time must be greater than current lock end time");var p=Rs(o),l=Qs(o,n.lastAccountPowerBoxIndex),d=Fs(i.lastTotalPowerBoxIndex),f=Fs(i.lastTotalPowerBoxIndex+1),g=Ms(n.lockEndTime),h=Ms(a),m=[{appIndex:Mr[r],name:p},{appIndex:Mr[r],name:l},{appIndex:Mr[r],name:d},{appIndex:Mr[r],name:f},{appIndex:Mr[r],name:g},{appIndex:Mr[r],name:h}];if(!n.freeAccountPowerSpaceCount){var A=Qs(o,n.lastAccountPowerBoxIndex+1);m.push({appIndex:Mr[r],name:A})}var x,I=is(i.lastTotalPowerTimestamp,Math.floor(Date.now()/1e3)),v=I.length,y=w(I);try{for(y.s();!(x=y.n()).done;){var b=x.value;if(b%Yr==0){var T=Ms(b);m.push({appIndex:Mr[r],name:T})}}}catch(e){y.e(e)}finally{y.f()}var k=0;s||(k+=rs),n.freeAccountPowerSpaceCount||(k+=as),v>i.freeTotalPowerSpaceCount&&(k+=ss);var E=[e.makeApplicationNoOpTxnFromObject({appIndex:Mr[r],sender:o,suggestedParams:u,appArgs:[ne("extend_lock_end_time"),ee(a)],boxes:m.slice(0,8),note:c}),ho({sender:o,suggestedParams:u,index:Mr[r],boxes:m.slice(8)})];if(k){var N=e.makePaymentTxnWithSuggestedParamsFromObject({sender:o,receiver:e.getApplicationAddress(Mr[r]),amount:k,suggestedParams:u});E.unshift(N)}return e.assignGroupID(E)}function Oo(t){var n=t.accountState,r=t.network,a=t.sender,s=t.suggestedParams,o=t.appCallNote,i=Rs(a),u=Qs(a,n.lastAccountPowerBoxIndex),c=Qs(a,n.lastAccountPowerBoxIndex+1),p=[{appIndex:Mr[r],name:i},{appIndex:Mr[r],name:u},{appIndex:Mr[r],name:c}],l=e.makeApplicationNoOpTxnFromObject({appIndex:Mr[r],sender:a,suggestedParams:s,appArgs:[ne("withdraw")],foreignAssets:[ve[r]],boxes:p,note:o});l.fee*=2n;var d=[l];if(!n.freeAccountPowerSpaceCount){var f=e.makePaymentTxnWithSuggestedParamsFromObject({sender:a,receiver:e.getApplicationAddress(Mr[r]),amount:as,suggestedParams:s});d.unshift(f)}return e.assignGroupID(d)}var Ro=function(){return p((function e(t,n,r){u(this,e),this.algodClient=t,this.userAddress=n,this.network=r}),[{key:"getTinyPower",value:(y=i(s().mark((function e(){var t,n,r,a,o,i,u,c=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:Math.floor(Date.now()/Ur),e.next=3,this.fetchAccountState();case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return",0);case 6:return e.next=8,Ws({algodClient:this.algodClient,address:this.userAddress,appId:Mr[this.network],powerCount:n.powerCount});case 8:if(r=e.sent,null!==(a=Ys(r,t))){e.next=12;break}return e.abrupt("return",0);case 12:return o=r[a],i=t-o.timestamp,u=Math.max(o.bias-ds(o.slope,i),0),e.abrupt("return",u);case 16:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"getTotalTinyPower",value:(v=i(s().mark((function e(){var t,n,r,a,o,i,u,c,p,l,d,f,g,h,m,A,x,I,v=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.length>0&&void 0!==v[0]?v[0]:Math.floor(Date.now()/Ur),e.next=3,this.fetchVaultAppGlobalState();case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return",0);case 6:return e.next=8,js(this.algodClient,Mr[this.network],n.totalPowerCount);case 8:if(r=e.sent,a=Ys(r,t)){e.next=12;break}return e.abrupt("return",0);case 12:o=r[a],i=Math.floor(o.timestamp/Yr),u=Math.floor(t/Yr)-i,c=Array.from({length:u},(function(e,t){return(i+t)*Yr})),p=c.map((function(e,t){return[0===t?o.timestamp:c[t-1],e]})),l=o.slope,d=o.bias,f=w(p),e.prev=19,f.s();case 21:if((g=f.n()).done){e.next=34;break}return h=g.value,m=h[1]-h[0],A=ds(l,m),d=Math.max(d-A,0),e.next=28,Ls(this.algodClient,Mr[this.network],h[1]);case 28:x=e.sent,I=(null==x?void 0:x.slopeDelta)||0,l=Math.max(l-I,0),0!==d&&0!==l||(d=0,l=0);case 32:e.next=21;break;case 34:e.next=39;break;case 36:e.prev=36,e.t0=e.catch(19),f.e(e.t0);case 39:return e.prev=39,f.f(),e.finish(39);case 42:return e.abrupt("return",d);case 43:case"end":return e.stop()}}),e,this,[[19,36,39,42]])}))),function(){return v.apply(this,arguments)})},{key:"getCumulativeTinyPower",value:(x=i(s().mark((function e(){var t,n,r,a,o,i,u,c,p=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:Math.floor(Date.now()/Ur),e.next=3,this.fetchAccountState();case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return",0);case 6:return e.next=8,Ws({algodClient:this.algodClient,address:this.userAddress,appId:Mr[this.network],powerCount:n.powerCount});case 8:if(r=e.sent,null!==(a=Ys(r,t))){e.next=12;break}return e.abrupt("return",0);case 12:return o=r[a],i=t-o.timestamp,u=fs(o.bias,o.slope,i),c=o.cumulativePower-u,e.abrupt("return",c);case 17:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)})},{key:"fetchVaultAppGlobalState",value:(A=i(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,gs(this.algodClient,Mr[this.network]);case 3:return t=e.sent,e.abrupt("return",new _s(t.total_locked_amount,t.total_power_count,t.last_total_power_timestamp,t.tiny_asset_id));case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return A.apply(this,arguments)})},{key:"generateCreateLockTransactions",value:(m=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lockedAmount,r=t.lockEndTime,a=t.userAddress,o=t.suggestedParams,i=a||this.userAddress,e.next=4,this.fetchAccountState();case 4:return u=e.sent,e.next=7,this.fetchVaultAppGlobalState();case 7:if(c=e.sent,p=o,c){e.next=11;break}throw new Error("There was an error while fetching vault app global state");case 11:if(p){e.next=15;break}return e.next=14,this.algodClient.getTransactionParams().do();case 14:p=e.sent;case 15:return e.next=17,Ls(this.algodClient,Mr[this.network],r);case 17:return l=e.sent,e.abrupt("return",Do({lockedAmount:n,lockEndTime:r,vaultAppGlobalState:c,slopeChangeAtLockEndTime:l,sender:i,network:this.network,accountState:u,suggestedParams:p}));case 19:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"generateIncreaseLockAmountTransactions",value:(h=i(s().mark((function e(t){var n,r,a,o,i,u,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lockedAmount,r=t.userAddress,a=t.suggestedParams,o=r||this.userAddress,e.next=4,this.fetchAccountState();case 4:return i=e.sent,e.next=7,this.fetchVaultAppGlobalState();case 7:if(u=e.sent,c=a,u){e.next=11;break}throw new Error("There was an error while fetching vault app global state");case 11:if(i){e.next=13;break}throw new Error("There was an error while fetcing the account state");case 13:if(c){e.next=17;break}return e.next=16,this.algodClient.getTransactionParams().do();case 16:c=e.sent;case 17:return e.abrupt("return",_o({accountState:i,lockedAmount:n,network:this.network,sender:o,vaultAppGlobalState:u,suggestedParams:c}));case 18:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"generateExtendLockTimeTransactions",value:(g=i(s().mark((function e(t){var n,r,a,o,i,u,c,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.newLockEndTime,r=t.userAddress,a=t.suggestedParams,o=r||this.userAddress,e.next=4,this.fetchAccountState();case 4:return i=e.sent,e.next=7,this.fetchVaultAppGlobalState();case 7:if(u=e.sent,c=a,u){e.next=11;break}throw new Error("There was an error while fetching vault app global state");case 11:if(i){e.next=13;break}throw new Error("There was an error while fetcing the account state");case 13:if(c){e.next=17;break}return e.next=16,this.algodClient.getTransactionParams().do();case 16:c=e.sent;case 17:return e.next=19,Ls(this.algodClient,Mr[this.network],n);case 19:return p=e.sent,e.abrupt("return",Bo({accountState:i,network:this.network,newLockEndTime:n,sender:o,vaultAppGlobalState:u,suggestedParams:c,slopeChangeAtNewLockEndTime:null==p?void 0:p.slopeDelta}));case 21:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"generateIncreaseLockAmountAndExtendLockEndTimeTransactions",value:(f=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d,f,g;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lockAmount,r=t.lockEndTime,a=t.userAddress,o=t.suggestedParams,i=a||this.userAddress,e.next=4,this.fetchAccountState();case 4:return u=e.sent,e.next=7,this.fetchVaultAppGlobalState();case 7:if(c=e.sent,p=[],l=[],d=o,c){e.next=13;break}throw new Error("There was an error while fetching vault app global state");case 13:if(u){e.next=15;break}throw new Error("There was an error while fetcing the account state");case 15:if(d){e.next=19;break}return e.next=18,this.algodClient.getTransactionParams().do();case 18:d=e.sent;case 19:return p=_o({accountState:u,lockedAmount:n,network:this.network,sender:i,vaultAppGlobalState:c,suggestedParams:d}),u.powerCount+=1,c.totalPowerCount+=1n,e.next=24,Ls(this.algodClient,Mr[this.network],r);case 24:return f=e.sent,l=Bo({accountState:u,network:this.network,newLockEndTime:r,sender:i,vaultAppGlobalState:c,suggestedParams:d,slopeChangeAtNewLockEndTime:null==f?void 0:f.slopeDelta}),g=[].concat(I(p),I(l)),e.abrupt("return",Boolean(p.length)&&Boolean(l.length)?xs(p,l):g);case 28:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"generateWithdrawTransactions",value:(d=i(s().mark((function e(t,n,r){var a,o,i,u,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t||this.userAddress,e.next=3,this.fetchAccountState();case 3:if(o=e.sent,i=r,o){e.next=7;break}throw new Error("There was an error while fetcing the account state");case 7:if(i){e.next=11;break}return e.next=10,this.algodClient.getTransactionParams().do();case 10:i=e.sent;case 11:if(u=Oo({accountState:o,network:this.network,sender:a,suggestedParams:i,client:this.algodClient}),!n){e.next=17;break}return e.next=15,be({client:this.algodClient,initiatorAddr:a,assetID:ve[this.network]});case 15:c=e.sent,u=xs([c[0].txn],u);case 17:return e.abrupt("return",u);case 18:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"fetchAccountState",value:function(){return function(e,t,n){return Bs.apply(this,arguments)}(this.algodClient,Mr[this.network],this.userAddress)}},{key:"fetchStakingDistributionProposal",value:function(e){return function(e,t,n){return So.apply(this,arguments)}(this.algodClient,jr[this.network],e)}},{key:"generateCastVoteForStakingDistributionProposalTransactions",value:(l=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d,f,g,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.proposalId,a=t.votes,o=t.assetIds,i=t.userAddress,u=t.suggestedParams,c=null!=i?i:this.userAddress,p=u,e.next=5,this.fetchStakingDistributionProposal(r);case 5:if(l=e.sent){e.next=8;break}throw new Error("There was an error while fetching staking distribution proposal");case 8:if(p){e.next=12;break}return e.next=11,this.algodClient.getTransactionParams().do();case 11:p=e.sent;case 12:return e.next=14,this.fetchAccountState();case 14:return d=e.sent,e.next=17,Is(this.algodClient,jr[this.network]);case 17:return f=e.sent,e.next=20,Ws({algodClient:this.algodClient,address:c,appId:Mr[this.network],powerCount:null!==(n=null==d?void 0:d.powerCount)&&void 0!==n?n:null});case 20:if(g=e.sent,null!==(h=Ys(g,l.creationTimestamp))){e.next=24;break}throw new Error("It is required to have an account power at the staking distribution proposal creation timestamp");case 24:return e.abrupt("return",Po({stakingVotingAppId:jr[this.network],vaultAppId:Mr[this.network],sender:c,proposalId:r,proposal:l,votes:a,assetIds:o,accountPowerIndex:h,appBoxNames:f,suggestedParams:p,appCallNote:null}));case 25:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"fetchRewardsAppGlobalState",value:(c=i(s().mark((function t(){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,gs(this.algodClient,Gr[this.network]);case 3:return n=t.sent,t.abrupt("return",new no(n.tiny_asset_id,n.vault_app_id,n.reward_history_count,n.first_period_timestamp,n.reward_period_count,e.encodeAddress(n.manager),e.encodeAddress(n.rewards_manager)));case 7:return t.prev=7,t.t0=t.catch(0),console.error(t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return c.apply(this,arguments)})},{key:"generateClaimRewardTransactions",value:(o=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d,f,g,h,m,A,x,I,v,y,w,b,T,k;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.periodIndexStart,a=t.periodCount,o=t.userAddress,i=t.suggestedParams,u=t.shouldOptIntoTINY,c=null!=o?o:this.userAddress,p=i){e.next=7;break}return e.next=6,this.algodClient.getTransactionParams().do();case 6:p=e.sent;case 7:return e.next=9,this.fetchAccountState();case 9:return l=e.sent,e.next=12,this.fetchRewardsAppGlobalState();case 12:if(d=e.sent){e.next=15;break}throw new Error("There was an error while fetching rewards app global state");case 15:if(!(r+a>d.rewardPeriodCount)){e.next=17;break}throw new Error("The reward period index to be claimed cannot be larger than the latest reward period index");case 17:return e.next=19,Ws({algodClient:this.algodClient,address:c,appId:Mr[this.network],powerCount:null!==(n=null==l?void 0:l.powerCount)&&void 0!==n?n:null});case 19:for(f=e.sent,g=d.firstPeriodTimestamp+r*Vr,h=d.firstPeriodTimestamp+(r+a)*Vr,m=[],A=g;A<h+1;A+=Vr)m.push(null!==(x=Ys(f,A))&&void 0!==x?x:0);I=!1,(v=new Set).add(Math.floor(r/(8*Ks))),v.add(Math.floor((r+a)/(8*Ks))),y=0,w=Array.from(v);case 29:if(!(y<w.length)){e.next=40;break}return b=w[y],e.next=33,so(this.algodClient,Gr[this.network],this.userAddress,b);case 33:if(e.sent){e.next=37;break}return I=!0,e.abrupt("break",40);case 37:y++,e.next=29;break;case 40:if(T=mo({rewardsAppId:Gr[this.network],vaultAppId:Mr[this.network],tinyAssetId:ve[this.network],sender:this.userAddress,periodIndexStart:r,periodCount:a,accountPowerIndexes:m,createRewardClaimSheet:I,suggestedParams:p}),!u){e.next=46;break}return e.next=44,be({client:this.algodClient,initiatorAddr:c,assetID:ve[this.network]});case 44:k=e.sent,T=xs([k[0].txn],T);case 46:return e.abrupt("return",T);case 47:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"fetchProposal",value:function(e){return function(e,t,n){return ks.apply(this,arguments)}(this.algodClient,Xr[this.network],e)}},{key:"uploadProposalMetadata",value:function(e,t){var n={proposal_id:e,metadata:t};return fetch("".concat(R[this.network].v1,"/governance/proposals/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).catch((function(){return Promise.reject(new Error("Network error. Try again later."))})).then((function(e){return e.ok?Promise.resolve(e):Promise.reject(e)})).catch(function(){var e=i(s().mark((function e(t){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,"function"!=typeof t.json){e.next=6;break}return e.next=4,t.json();case 4:r=e.sent,n=r;case 6:return e.abrupt("return",Promise.reject(n));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"generateCreateProposalTransactions",value:(a=i(s().mark((function t(n){var r,a,o,i,u,c,p,l;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.proposalId,a=n.userAddress,o=n.suggestedParams,i=n.executionHash,u=n.executor,!i||34===i.length){t.next=3;break}throw new Error("Invalid execution hash");case 3:return t.next=5,this.fetchVaultAppGlobalState();case 5:if(c=t.sent){t.next=8;break}throw new Error("There was an error while fetching vault app global state");case 8:if(p=null!=a?a:this.userAddress,l=o){t.next=14;break}return t.next=13,this.algodClient.getTransactionParams().do();case 13:l=t.sent;case 14:if(t.t0=qs,t.t1=r,t.t2=Xr[this.network],t.t3=p,t.t4=l,t.t5=c,t.t6=Mr[this.network],t.t7=i,!u){t.next=26;break}t.t8=e.decodeAddress(u).publicKey,t.next=31;break;case 26:return t.t9=Uint8Array,t.next=29,this.fetchProposalVotingAppGlobalState();case 29:t.t10=t.sent.proposalManager,t.t8=new t.t9(t.t10);case 31:return t.t11=t.t8,t.t12={proposalId:t.t1,proposalVotingAppId:t.t2,sender:t.t3,suggestedParams:t.t4,vaultAppGlobalState:t.t5,vaultAppId:t.t6,executionHash:t.t7,executor:t.t11},t.abrupt("return",(0,t.t0)(t.t12));case 34:case"end":return t.stop()}}),t,this)}))),function(e){return a.apply(this,arguments)})},{key:"generateCastVoteTransactions",value:(r=i(s().mark((function e(t){var n,r,a,o,i,u,c,p,l,d,f,g,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.proposalId,r=t.suggestedParams,a=t.vote,o=t.userAddress,i=null!=o?o:this.userAddress,u=r){e.next=7;break}return e.next=6,this.algodClient.getTransactionParams().do();case 6:u=e.sent;case 7:return e.next=9,this.fetchProposal(n);case 9:return c=e.sent,e.next=12,this.fetchAccountState();case 12:if(p=e.sent,c){e.next=15;break}throw new Error("Proposal not found");case 15:if(p){e.next=17;break}throw new Error("Account state not found");case 17:if(c.isApproved){e.next=19;break}throw new Error("Proposal not approved");case 19:if(c.votingStartTimestamp){e.next=21;break}throw new Error("Voting start timestamp is not valid");case 21:if(!(c.votingStartTimestamp>=Math.floor(Date.now()/Ur)||c.votingEndTimestamp<=Math.floor(Date.now()/Ur))){e.next=23;break}throw new Error("Voting period is not active");case 23:return e.next=25,Ws({algodClient:this.algodClient,address:i,appId:Mr[this.network],powerCount:p.powerCount});case 25:if(l=e.sent,null!==(d=Ys(l,c.creationTimestamp))){e.next=29;break}throw new Error("Account power index not found");case 29:return f=Math.floor(c.index/(8*Zr)),g=Eo(i,f),e.next=33,ps(this.algodClient,Xr[this.network],g);case 33:return h=!e.sent,e.abrupt("return",Zs({proposalVotingAppId:Xr[this.network],vaultAppId:Mr[this.network],sender:i,proposalId:n,proposal:c,vote:a,accountPowerIndex:d,createAttendanceSheetBox:h,suggestedParams:u}));case 35:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"fetchProposalVotingAppGlobalState",value:(n=i(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gs(this.algodClient,Xr[this.network]);case 2:return t=e.sent,e.abrupt("return",new ws(t.vault_app_id,t.proposal_index_counter,t.voting_delay,t.voting_duration,t.proposal_threshold,t.proposal_threshold_numerator,t.quorum_threshold,t.approval_requirement,t.manager,t.proposal_manager));case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getRequiredTinyPowerToCreateProposal",value:(t=i(s().mark((function e(t){var n,r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t){e.next=4;break}e.t0=t,e.next=7;break;case 4:return e.next=6,this.getTotalTinyPower();case 6:e.t0=e.sent;case 7:return n=e.t0,e.next=10,this.fetchProposalVotingAppGlobalState();case 10:return r=e.sent,a=r.proposalThreshold,r.proposalThresholdNumerator&&(a=Math.max(a,Math.floor(n*r.proposalThresholdNumerator/100)+1)),e.abrupt("return",a);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]);var t,n,r,a,o,c,l,d,f,g,h,m,A,x,v,y}(),Fo=2500,Co=400,Qo=function(){return p((function e(t,n){u(this,e),l(this,"data",null),this.name=t,this.structReference=n,this.size=n[t].size,this.fields=n[t].fields}),[{key:"apply",value:function(e){var t=e;return t||(t=Buffer.alloc(this.size)),this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this}},{key:"getField",value:function(e){var t;if(!this.data)throw new Error("Data is not initialized");var n=this.fields[e];if(!n)throw new Error("Field ".concat(e," does not exist in struct ").concat(this.name));var r=n.offset,a=n.offset+n.size,s=null===(t=this.data)||void 0===t?void 0:t.buffer.slice(r,a);return Mo(n.type,this.structReference).apply(Buffer.from(s))}}])}(),Lo=function(){return p((function e(t,n){u(this,e),l(this,"data",null),this.struct=t,this.length=n}),[{key:"apply",value:function(e){var t=e;return t||(t=Buffer.alloc(this.struct.size*this.length)),this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this}},{key:"getField",value:function(e){var t,n=this.struct.size*e,r=n+this.struct.size,a=null===(t=this.data)||void 0===t?void 0:t.buffer.slice(n,r);return this.struct.apply(a?Buffer.from(a):void 0)}}])}(),Vo=function(){return p((function e(){u(this,e)}),[{key:"apply",value:function(e){for(var t=BigInt(0),n=0;n<e.length;n++)t=(t<<BigInt(8))+BigInt(e[n]);return t}}])}(),Uo=function(){return p((function e(){u(this,e)}),[{key:"apply",value:function(e){return e}}])}();function Mo(e,t){if("int"===e)return new Vo;if(e.startsWith("uint"))return new Vo;if(e.startsWith("bytes"))return new Uo;if(Object.keys(t).includes(e))return new Qo(e,t);if(e.includes("[")){var n=e.match(/^(\w+)\[(\d+)\]$/);if(!n)throw new Error("Could not parse array type: ".concat(e));var r=n[1],a=parseInt(n[2],10);return new Lo(new Qo(r,t),Number(a))}throw new Error("Unknown type: ".concat(e))}var jo={testnet:724519988,mainnet:2537013674},Go={testnet:724676904,mainnet:2537022861},Xo={testnet:480164661,mainnet:2200606875},Wo={UserState:{size:32,fields:{staked_amount:{type:"int",size:8,offset:0},accumulated_rewards_per_unit_at_last_update:{type:"int",size:8,offset:8},accumulated_rewards:{type:"int",size:8,offset:16},timestamp:{type:"int",size:8,offset:24}}}},zo=function(){return p((function t(n,r,a,s){u(this,t),this.algod=n,this.appId=r,this.applicationAddress=this.appId?e.getApplicationAddress(this.appId):null,this.network=a,this.structs=s}),[{key:"setupTxnFeeAndAssignGroupId",value:function(t){var n=t.txns,r=t.additionalFeeCount,a=void 0===r?0:r,s=n[0].fee,o=n.map((function(e){return e.fee=0n,e}));return o[0].fee=BigInt(o.length+a)*s,e.assignGroupID(o)}},{key:"getGlobal",value:(c=i(s().mark((function e(t,n,r){var a,o,i,u,c,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r||this.appId){e.next=3;break}throw new Error("Application ID not provided");case 3:return e.next=5,this.algod.getApplicationByID(i).do();case 5:if(u=e.sent,c=null!==(a=u.params.globalState)&&void 0!==a?a:[],!(p=null===(o=c.find((function(e){return Ao(e.key,t)})))||void 0===o?void 0:o.value)){e.next=12;break}if(2!==p.type){e.next=11;break}return e.abrupt("return",p.uint);case 11:return e.abrupt("return",p.bytes);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"calculateMinBalance",value:function(e){var n=e.accounts,r=void 0===n?0:n,a=e.assets,s=0;return s+=1e5*r,s+=1e5*(void 0===a?0:a),s+=function(e){return Object.entries(e).reduce((function(e,n){var r=x(n,2),a=r[0],s=r[1];return e+t.toByteArray(a).length*Co+s.size*Co}),Fo)}(e.boxes||{}),s}},{key:"boxExists",value:(o=i(s().mark((function e(t,n){var r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n||this.appId){e.next=3;break}throw new Error("Application ID not provided");case 3:return e.prev=3,e.next=6,this.algod.getApplicationBoxByName(r,t).do();case 6:return a=e.sent,e.abrupt("return",Boolean(a));case 10:return e.prev=10,e.t0=e.catch(3),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,this,[[3,10]])}))),function(e,t){return o.apply(this,arguments)})},{key:"getBox",value:(a=i(s().mark((function e(t,n,r,a){var o,i,u,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=r||this.appId,i=null!=a?a:this.structs,o){e.next=5;break}throw new Error("Application ID not provided");case 5:return e.next=7,this.algod.getApplicationBoxByName(o,t).do();case 7:if(u=e.sent.value,i){e.next=10;break}throw new Error("structs not defined");case 10:return c=new Qo(n,i),e.abrupt("return",c.apply(Buffer.from(u)));case 14:if(e.prev=14,e.t0=e.catch(0),!e.t0.message.includes("box not found")){e.next=18;break}return e.abrupt("return",null);case 18:throw new Error(e.t0);case 19:case"end":return e.stop()}}),e,this,[[0,14]])}))),function(e,t,n,r){return a.apply(this,arguments)})},{key:"getOptinTxnIfNeeded",value:(r=i(s().mark((function t(n,r){var a,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=[],t.next=3,this.isOptedIn(n,r);case 3:if(t.sent){t.next=8;break}return t.next=6,this.getSuggestedParams();case 6:o=t.sent,a.push(e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:n,receiver:n,assetIndex:r,amount:0,suggestedParams:o}));case 8:return t.abrupt("return",a);case 9:case"end":return t.stop()}}),t,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"isOptedIn",value:(n=i(s().mark((function e(t,n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.algod.accountAssetInformation(t,n).do();case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(e,t){return n.apply(this,arguments)})},{key:"getSuggestedParams",value:function(){return this.algod.getTransactionParams().do()}},{key:"convertStandardTransactionsToSignerTransactions",value:function(e,t){if(Array.isArray(t)&&t.length!==e.length)throw new Error("Signer length does not match transaction length");return e.map((function(e,n){return{txn:e,signers:Array.isArray(t)?[t[n]]:[t]}}))}}]);var n,r,a,o,c}();var Yo=new Qo("UserState",Wo),Jo=function(n){function r(e,t){var n,a,s,o;return u(this,r),a=this,o=[e,Go[t],t,Wo],s=f(s=r),(n=A(a,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(s,o||[],f(a).constructor):s.apply(a,o))).vaultAppId=Xo[t],n}return d(r,zo),p(r,[{key:"increaseStake",value:(y=i(s().mark((function t(n,r){var a,o,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getSuggestedParams();case 2:return a=t.sent,o=this.getUserStateBoxName(r),t.t0=[],t.t1=I,t.next=8,this.getApplyRateChangeTxnIfNeeded();case 8:return t.t2=t.sent,t.t3=(0,t.t1)(t.t2),t.t4=I,t.next=13,this.getUserBoxPaymentTxnIfNeeded(r,a);case 13:return t.t5=t.sent,t.t6=(0,t.t4)(t.t5),t.t7=I,t.next=18,this.getOptinTxnIfNeeded(r,we[this.network]);case 18:return t.t8=t.sent,t.t9=(0,t.t7)(t.t8),t.t10=[e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:r,receiver:this.applicationAddress,amount:n,assetIndex:ye[this.network],suggestedParams:a}),e.makeApplicationNoOpTxnFromObject({sender:r,appIndex:this.appId,appArgs:[ne("increase_stake"),e.bigIntToBytes(n,8)],foreignApps:[this.vaultAppId],foreignAssets:[we[this.network]],boxes:[{appIndex:0,name:o},{appIndex:this.vaultAppId,name:o}],suggestedParams:a})],i=t.t0.concat.call(t.t0,t.t3,t.t6,t.t9,t.t10),t.abrupt("return",Promise.all(this.setupTxnFeeAndAssignGroupId({txns:i,additionalFeeCount:2})));case 23:case"end":return t.stop()}}),t,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"decreaseStake",value:(v=i(s().mark((function t(n,r){var a,o,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getSuggestedParams();case 2:return a=t.sent,o=this.getUserStateBoxName(r),t.t0=[],t.t1=I,t.next=8,this.getApplyRateChangeTxnIfNeeded();case 8:return t.t2=t.sent,t.t3=(0,t.t1)(t.t2),t.t4=I,t.next=13,this.getOptinTxnIfNeeded(r,ye[this.network]);case 13:return t.t5=t.sent,t.t6=(0,t.t4)(t.t5),t.t7=[e.makeApplicationNoOpTxnFromObject({sender:r,appIndex:this.appId,appArgs:[ne("decrease_stake"),e.bigIntToBytes(n,8)],foreignAssets:[ye[this.network],we[this.network]],boxes:[{appIndex:0,name:o}],suggestedParams:a})],i=t.t0.concat.call(t.t0,t.t3,t.t6,t.t7),t.abrupt("return",Promise.all(this.setupTxnFeeAndAssignGroupId({txns:i,additionalFeeCount:2})));case 18:case"end":return t.stop()}}),t,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"claimRewards",value:(x=i(s().mark((function t(n){var r,a,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getSuggestedParams();case 2:return r=t.sent,a=this.getUserStateBoxName(n),t.t0=[],t.t1=I,t.next=8,this.getApplyRateChangeTxnIfNeeded();case 8:return t.t2=t.sent,t.t3=(0,t.t1)(t.t2),t.t4=I,t.next=13,this.getOptinTxnIfNeeded(n,ve[this.network]);case 13:return t.t5=t.sent,t.t6=(0,t.t4)(t.t5),t.t7=[e.makeApplicationNoOpTxnFromObject({sender:n,appIndex:this.appId,appArgs:[ne("claim_rewards")],foreignAssets:[ve[this.network]],foreignApps:[this.vaultAppId],boxes:[{appIndex:0,name:a},{appIndex:this.vaultAppId,name:a}],suggestedParams:r})],o=t.t0.concat.call(t.t0,t.t3,t.t6,t.t7),t.abrupt("return",Promise.all(this.setupTxnFeeAndAssignGroupId({txns:o,additionalFeeCount:3})));case 18:case"end":return t.stop()}}),t,this)}))),function(e){return x.apply(this,arguments)})},{key:"calculateIncreaseStakeFee",value:(m=i(s().mark((function e(t,n){var r,a,o,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.shouldApplyRateChange();case 2:return r=e.sent,e.next=5,this.isOptedIn(t,we[this.network]);case 5:return a=!e.sent,e.next=8,this.boxExists(this.getUserStateBoxName(t));case 8:return o=e.sent,i=4+Number(r)+Number(a)+Number(!o),e.abrupt("return",BigInt(i)*n);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"calculateDecreaseStakeFee",value:(h=i(s().mark((function e(t,n){var r,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.shouldApplyRateChange();case 2:return r=e.sent,e.next=5,this.isOptedIn(t,ye[this.network]);case 5:return a=!e.sent,o=3+Number(r)+Number(a),e.abrupt("return",BigInt(o)*n);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"getUserStateBoxName",value:function(t){return e.decodeAddress(t).publicKey}},{key:"getApplyRateChangeTxnIfNeeded",value:(g=i(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.shouldApplyRateChange();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",this.getApplyRateChangeTxn());case 4:return e.abrupt("return",[]);case 5:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"getUserBoxPaymentTxnIfNeeded",value:(c=i(s().mark((function e(t,n){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getUserStateBoxName(t),e.next=3,this.boxExists(r);case 3:if(e.sent){e.next=5;break}return e.abrupt("return",this.getUserBoxPaymentTxn(r,t,n));case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"getUserBoxPaymentTxn",value:function(n,r,a){var s=l({},t.fromByteArray(n),Yo);return[e.makePaymentTxnWithSuggestedParamsFromObject({sender:r,receiver:this.applicationAddress,suggestedParams:a,amount:this.calculateMinBalance({boxes:s})})]}},{key:"shouldApplyRateChange",value:(o=i(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Math.floor(Date.now()/Ur),e.next=3,this.getGlobal(ne("current_reward_rate_per_time_end_timestamp"));case 3:return n=e.sent,e.abrupt("return",n<=t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getApplyRateChangeTxn",value:(a=i(s().mark((function t(){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.t1=this.applicationAddress,t.t2=this.appId,t.t3=[ne("apply_rate_change")],t.next=6,this.getSuggestedParams();case 6:return t.t4=t.sent,t.t5={sender:t.t1,appIndex:t.t2,appArgs:t.t3,suggestedParams:t.t4},t.t6=t.t0.makeApplicationNoOpTxnFromObject.call(t.t0,t.t5),n=[t.t6],t.abrupt("return",this.setupTxnFeeAndAssignGroupId({txns:n}));case 11:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})}]);var a,o,c,g,h,m,x,v,y}();var qo=function(t){function n(e,t){return u(this,n),r=this,s=[e,jo[t],t],a=f(a=n),A(r,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(a,s||[],f(r).constructor):a.apply(r,s));var r,a,s}return d(n,zo),p(n,[{key:"sync",value:(c=i(s().mark((function t(n){var r,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getSuggestedParams();case 2:return r=t.sent,t.t0=e,t.t1=n,t.t2=this.appId,t.t3=[ne("sync")],t.t4=r,t.t5=e.encodeAddress,t.next=11,this.getGlobal(ne("account_1"));case 11:return t.t6=t.sent,t.t7=(0,t.t5)(t.t6),t.t8=e.encodeAddress,t.next=16,this.getGlobal(ne("account_2"));case 16:return t.t9=t.sent,t.t10=(0,t.t8)(t.t9),t.t11=e.encodeAddress,t.next=21,this.getGlobal(ne("account_3"));case 21:return t.t12=t.sent,t.t13=(0,t.t11)(t.t12),t.t14=e.encodeAddress,t.next=26,this.getGlobal(ne("account_4"));case 26:return t.t15=t.sent,t.t16=(0,t.t14)(t.t15),t.t17=[t.t7,t.t10,t.t13,t.t16],t.t18={sender:t.t1,appIndex:t.t2,appArgs:t.t3,suggestedParams:t.t4,accounts:t.t17},t.t19=t.t0.makeApplicationNoOpTxnFromObject.call(t.t0,t.t18),a=[t.t19],t.abrupt("return",this.setupTxnFeeAndAssignGroupId({txns:a}));case 33:case"end":return t.stop()}}),t,this)}))),function(e){return c.apply(this,arguments)})},{key:"mint",value:(o=i(s().mark((function t(n,r){var a,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getSuggestedParams();case 2:return a=t.sent,t.t0=[],t.t1=I,t.next=7,this.getOptinTxnIfNeeded(r,ye[this.network]);case 7:return t.t2=t.sent,t.t3=(0,t.t1)(t.t2),t.t4=e.makePaymentTxnWithSuggestedParamsFromObject({sender:r,receiver:this.applicationAddress,amount:n,suggestedParams:a}),t.t5=e,t.t6=r,t.t7=this.appId,t.t8=[ne("mint"),e.bigIntToBytes(n,8)],t.t9=e.encodeAddress,t.next=17,this.getGlobal(ne("account_1"));case 17:return t.t10=t.sent,t.t11=(0,t.t9)(t.t10),t.t12=e.encodeAddress,t.next=22,this.getGlobal(ne("account_2"));case 22:return t.t13=t.sent,t.t14=(0,t.t12)(t.t13),t.t15=e.encodeAddress,t.next=27,this.getGlobal(ne("account_3"));case 27:return t.t16=t.sent,t.t17=(0,t.t15)(t.t16),t.t18=e.encodeAddress,t.next=32,this.getGlobal(ne("account_4"));case 32:return t.t19=t.sent,t.t20=(0,t.t18)(t.t19),t.t21=[t.t11,t.t14,t.t17,t.t20],t.t22=a,t.t23=[ye[this.network]],t.t24={sender:t.t6,appIndex:t.t7,appArgs:t.t8,accounts:t.t21,suggestedParams:t.t22,foreignAssets:t.t23},t.t25=t.t5.makeApplicationNoOpTxnFromObject.call(t.t5,t.t24),t.t26=[t.t4,t.t25],o=t.t0.concat.call(t.t0,t.t3,t.t26),t.abrupt("return",this.setupTxnFeeAndAssignGroupId({txns:o,additionalFeeCount:1}));case 42:case"end":return t.stop()}}),t,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"burn",value:(a=i(s().mark((function t(n,r){var a,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getSuggestedParams();case 2:return a=t.sent,t.t0=e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:r,receiver:this.applicationAddress,assetIndex:ye[this.network],amount:n,suggestedParams:a}),t.t1=e,t.t2=r,t.t3=this.appId,t.t4=[ne("burn"),e.bigIntToBytes(n,8)],t.t5=e.encodeAddress,t.next=11,this.getGlobal(ne("account_1"));case 11:return t.t6=t.sent,t.t7=(0,t.t5)(t.t6),t.t8=e.encodeAddress,t.next=16,this.getGlobal(ne("account_2"));case 16:return t.t9=t.sent,t.t10=(0,t.t8)(t.t9),t.t11=e.encodeAddress,t.next=21,this.getGlobal(ne("account_3"));case 21:return t.t12=t.sent,t.t13=(0,t.t11)(t.t12),t.t14=e.encodeAddress,t.next=26,this.getGlobal(ne("account_4"));case 26:return t.t15=t.sent,t.t16=(0,t.t14)(t.t15),t.t17=[t.t7,t.t10,t.t13,t.t16],t.t18=a,t.t19={sender:t.t2,appIndex:t.t3,appArgs:t.t4,accounts:t.t17,suggestedParams:t.t18},t.t20=t.t1.makeApplicationNoOpTxnFromObject.call(t.t1,t.t19),o=[t.t0,t.t20],t.abrupt("return",this.setupTxnFeeAndAssignGroupId({txns:o,additionalFeeCount:1}));case 34:case"end":return t.stop()}}),t,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"getRatio",value:(r=i(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Number,e.next=3,this.getGlobal(ne("rate"));case 3:return e.t1=e.sent,e.t2=(0,e.t0)(e.t1),e.t3=1e12,e.abrupt("return",e.t2/e.t3);case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getCirculatingSupply",value:function(){return this.getGlobal(ne("minted_talgo"))}}]);var r,a,o,c}(),Zo=ne("order_count"),Ho=ne("governor_order_fee_rate");ne("governor_fee_rate_power_threshold");var Ko=ne("order_fee_rate"),$o=ne("latest_version"),ei=ne("version"),ti={TriggerOrder:{size:80,fields:{asset_id:{type:"int",size:8,offset:0},amount:{type:"int",size:8,offset:8},target_asset_id:{type:"int",size:8,offset:16},target_amount:{type:"int",size:8,offset:24},filled_amount:{type:"int",size:8,offset:32},collected_target_amount:{type:"int",size:8,offset:40},is_partial_allowed:{type:"int",size:8,offset:48},fee_rate:{type:"int",size:8,offset:56},creation_timestamp:{type:"int",size:8,offset:64},expiration_timestamp:{type:"int",size:8,offset:72}}},RecurringOrder:{size:88,fields:{asset_id:{type:"int",size:8,offset:0},amount:{type:"int",size:8,offset:8},target_asset_id:{type:"int",size:8,offset:16},collected_target_amount:{type:"int",size:8,offset:24},min_target_amount:{type:"int",size:8,offset:32},max_target_amount:{type:"int",size:8,offset:40},remaining_recurrences:{type:"int",size:8,offset:48},interval:{type:"int",size:8,offset:56},fee_rate:{type:"int",size:8,offset:64},last_fill_timestamp:{type:"int",size:8,offset:72},creation_timestamp:{type:"int",size:8,offset:80}}},Entry:{size:8,fields:{app_id:{type:"int",size:8,offset:0}}}},ni=16,ri=16,ai=0,si=0,oi={mainnet:2814989833,testnet:739800082},ii={mainnet:2200606875,testnet:480164661},ui={mainnet:NaN,testnet:730573191},ci="CoASY3JlYXRlX2FwcGxpY2F0aW9ugBJ1cGRhdGVfYXBwbGljYXRpb26AC3Bvc3RfdXBkYXRlgAxhc3NldF9vcHRfaW6AEXB1dF90cmlnZ2VyX29yZGVygBRjYW5jZWxfdHJpZ2dlcl9vcmRlcoAbc3RhcnRfZXhlY3V0ZV90cmlnZ2VyX29yZGVygBllbmRfZXhlY3V0ZV90cmlnZ2VyX29yZGVygBNwdXRfcmVjdXJyaW5nX29yZGVygBZjYW5jZWxfcmVjdXJyaW5nX29yZGVygBdleGVjdXRlX3JlY3VycmluZ19vcmRlcoAHY29sbGVjdDYaAI4MAAEAEQAhAC0AQgBmAHYAjgCmAM4A3gEFADEYgQASRDYaAReIARCBAUMxGYEEEkQ2GgEXiAG6gQFDMRmBABJEiAI5gQFDMRmBABJENhoBSRWBQBJEiALBgQFDMRmBABJENhoBFzYaAhc2GgMXNhoEFzYaBRc2GgYXiALbgQFDMRmBABJENhoBF4gEF4EBQzEZgQASRDYaARc2GgIXNhoDF4gE/IEBQzEZgQASRDYaARc2GgIXNhoDF4gFmoEBQzEZgQASRDYaARc2GgIXNhoDFzYaBBc2GgUXNhoGFzYaBxeIB+OBAUMxGYEAEkQ2GgEXiAk5gQFDMRmBABJENhoBFzYaAkkVgUASRDYaA0kVgYACEkQ2GgQXiAmwgQFDMRmBABJENhoBFzYaAkkVgQESRIgGtYEBQzUBgAx1c2VyX2FkZHJlc3MxAGeAD3JlZ2lzdHJ5X2FwcF9pZDQBZzQBcghINQKAHHJlZ2lzdHJ5X2FwcF9hY2NvdW50X2FkZHJlc3M0Amc0AYAMdmF1bHRfYXBwX2lkZUg1A4AMdmF1bHRfYXBwX2lkNANnNAGADXJvdXRlcl9hcHBfaWRlSDUEgA1yb3V0ZXJfYXBwX2lkNARngAd2ZXJzaW9ugQJngAQPPg00MQA0ARY0AxZQUFCwiTUFgAx1c2VyX2FkZHJlc3NkNQYxADQGEkQxFoEBCDgYgA9yZWdpc3RyeV9hcHBfaWRkEkQxFoEBCDkaAIANdmVyaWZ5X3VwZGF0ZRJEMRaBAQg5GgE0BRYSRDEWgQIIOBgyCBJEMRaBAgg5GgCAC3Bvc3RfdXBkYXRlEkSABEZ071kxADQFFlBQsImADHVzZXJfYWRkcmVzc2Q1BzEANAcSRIECgAd2ZXJzaW9uZA1EgA9yZWdpc3RyeV9hcHBfaWRkNQg0CIAMdmF1bHRfYXBwX2lkZUg1CYAMdmF1bHRfYXBwX2lkNAlnNAiADXJvdXRlcl9hcHBfaWRlSDUKgA1yb3V0ZXJfYXBwX2lkNApngAd2ZXJzaW9ugQJngAT8pjz+gQIWULCJNQuADHVzZXJfYWRkcmVzc2Q1DDEANAwSRIEANQ00DYEIEkAAGDQLgQg0DQuBCFgXiAsyNA2BAQg1DUL/4Ik1DjUPNRA1ETUSNROADHVzZXJfYWRkcmVzc2Q1FDEANBQSRIALb3JkZXJfY291bnRkNRWAAW80FRZQSYFQuUQ1FjQSgQANRDQQgQANRDQTNBETRDQOFEEAEIH///////////8BNRdCAAcyBzQOCDUXNBFBAAwyCjQRcAA1GEg0GEQxFoEBCTIKNBM0EogKvIgJmTUZNBMWNBaBAE8CuzQSFjQWgQhPArs0ERY0FoEQTwK7NBAWNBaBGE8Cu4EAFjQWgSBPAruBABY0FoEoTwK7NA8WNBaBME8CuzQZFjQWgThPArsyBxY0FoFATwK7NBcWNBaBSE8Cu4ALb3JkZXJfY291bnQ0FYEBCGc0Fr5INRqAEXB1dF90cmlnZ2VyX29yZGVyNBQ0FRY0GlCICwiABBN6A8M0FDQVFjQaUFBQsIAEoI8xYzQVFlCwiTUbgAx1c2VyX2FkZHJlc3NkNRwxADQcEkSAAW80GxZQSb1EgVASRDUdNB2BCIEIuhc1HjQdgTCBCLoXQQANNB40HYEggQi6Fwk1HjQdgSiBCLoXFEQ0HYEAgQi6FzQeMgo0HIgKOzQdvkg1H4AUY2FuY2VsX3RyaWdnZXJfb3JkZXI0HDQbFogKYYAEE3oDwzQcNBsWNB9QUFCwgATZpb9wNBsWULA0HbxIiTUgNSE1IjUjNSQ0JDgAMQASRDQkOBCBBhJENCQ4GYEAEkQ0JDgYMggSRDQkORoANCMSRDQkORoBNCIWEkQ0JDkaAjQhFhJENCQ5GgM0IBYSRIk1JTUmNSeAAW80JxZQSb1EgVASRDUoNCWBAg9ENCiBCIEIuhc1KTQogTCBCLoXQQAWNCk0KIEggQi6Fwk1KTQmNCkOREIABjQmNCkSRDIHNCiBSIEIuhcORDEWNCUINSo0KoAZZW5kX2V4ZWN1dGVfdHJpZ2dlcl9vcmRlcjQnNCY0JYj/KDQogQCBCLoXNCYyCjEAiAkNgARteEGbgAx1c2VyX2FkZHJlc3NkNCcWMQBQUFCwiTUrNSw1LYAMdXNlcl9hZGRyZXNzZDUugAFvNC0WUEm9RIFQEkQ1LzEWNCsJNTA0MIAbc3RhcnRfZXhlY3V0ZV90cmlnZ2VyX29yZGVyNC00LDQriP6iNC+BMIEIuhcUQQANNC+BGIEIuhc1MUIAFzQvgQiBCLoXNC+BGIEIuhc0LIgGYTUxMRaBAQkyCjQvgRCBCLoXNDGIB/w1MjQvgSCBCLoXNCwIFjQvgSBPArs0MjQvgTiBCLoXiAZeNTM0M0Q0L4EogQi6FzQyNDMJCBY0L4EoTwK7NC++SDU0gBR1cGRhdGVfdHJpZ2dlcl9vcmRlcjQuNC0WNDRQiAg6gAQTegPDNC40LRY0NFBQULCABK4KflKADHVzZXJfYWRkcmVzc2Q0LRYxADQsFjQyFlBQUFBQsDQvgRCBCLoXNDMyCoAccmVnaXN0cnlfYXBwX2FjY291bnRfYWRkcmVzc2SIB4s0L4EIgQi6FzQvgSCBCLoXEkEAGzQvgRCBCLoXNC+BKIEIuhcyCjQuiAdgNC+8SIk1NTU2gAx1c2VyX2FkZHJlc3NkNTcxADQ3EkQ0NYABbxJBAEiAAW80NhZQSb1EgVASRDU6NDqBEIEIuhc1ODQ6gSiBCLoXNTmBABY0OoEoTwK7NDq+SDU7gAQTegPDNDc0NhY0O1BQULBCAFQ0NYABchJBAEiAAXI0NhZQSb1EgVgSRDU8NDyBEIEIuhc1ODQ8gRiBCLoXNTmBABY0PIEYTwK7NDy+SDU9gARvi/yfNDc0NhY0PVBQULBCAAOBAUM0OUQ0ODQ5Mgo0N4gGjYAEKgYeKzQ2FjQ5FlBQsIk1PjU/NUA1QTVCNUM1RIAMdXNlcl9hZGRyZXNzZDVFMQA0RRJEgAtvcmRlcl9jb3VudGQ1RoABcjRGFlBJgVi5RDVHNEOBAA1ENEQ0QhNEND+BAA1END6BPA9END6BPBgURDRAFEEADYH///////////8BNUA0QTRADkQ0QkEADDIKNEJwADVISDRIRDEWgQEJMgo0RDRDND8LiAU+iAQbNUk0RBY0R4EATwK7NEMWNEeBCE8CuzRCFjRHgRBPAruBABY0R4EYTwK7NEEWNEeBIE8CuzRAFjRHgShPArs0PxY0R4EwTwK7ND4WNEeBOE8CuzRJFjRHgUBPAruBABY0R4FITwK7MgcWNEeBUE8Cu4ALb3JkZXJfY291bnQ0RoEBCGc0R75INUqAE3B1dF9yZWN1cnJpbmdfb3JkZXI0RTRGFjRKUIgFfoAEb4v8nzRFNEYWNEpQUFCwgASH6GpLNEYWULCJNUuADHVzZXJfYWRkcmVzc2Q1TDEANEwSRIABcjRLFlBJvUSBWBJENU00TYEYgQi6FxRENE2BCIEIuhc0TYEwgQi6Fws1TjRNgQCBCLoXNE4yCjRMiATANE2+SDVPgBZjYW5jZWxfcmVjdXJyaW5nX29yZGVyNEw0SxaIBOSABG+L/J80TDRLFjRPUFBQsIAEPnsMZjRLFlCwNE28SIk1UDVRNVI1U4ABcjRTFlBJvUSBWBJENVSADHVzZXJfYWRkcmVzc2Q1VTEWgQASRDINgQASRDEAiAIDMgc0VIFIgQi6FzRUgTiBCLoXCA9ENFKBCIEAC4EIWBc0VIEAgQi6FxJENFKBCDRQC4EIWBc0VIEQgQi6FxJENFSBCIEIuhc0VIEggQi6FzRSNFE0UIgBDjVWNFY0VIEggQi6Fw80VjRUgSiBCLoXDhBENFY0VIFAgQi6F4gB7DVXNFdENFSBMIEIuheBAQkWNFSBME8CuzIHFjRUgUhPArs0VIEYgQi6FzRWNFcJCBY0VIEYTwK7NFS+SDVYgBZ1cGRhdGVfcmVjdXJyaW5nX29yZGVyNFU0UxY0WFCIA6mABG+L/J80VTRTFjRYUFBQsIAEoPcklTRVNFMWMQA0VIEIgQi6FxY0VhZQUFBQULA0VIEQgQi6FzRXMgqAHHJlZ2lzdHJ5X2FwcF9hY2NvdW50X2FkZHJlc3NkiAMBNFSBMIEIuhcUQQAbNFSBEIEIuhc0VIEYgQi6FzIKNFWIAt40VLxIiTVZNVo1WzVcNV2ADXJvdXRlcl9hcHBfaWRkcghINV40W4EINFkLgQhYFzVfMgo0X4gDMzVgiANUNFuBCIEAC4EIWBc0XTIKNF6IAo2IA0aBBrIQgQCyAYANcm91dGVyX2FwcF9pZGSyGIAEc3dhcLIaNF0Wsho0XBayGjRbsho0WrIaNFkWshqIAx+IAyQyCjRfiALRNGAJNWE0YYk1YjRigA9yZWdpc3RyeV9hcHBfaWRkgAtpc19lbmRvcnNlZGM1YzVkNGNENGQ1ZTRlRIk1ZjVnNWg0ZxaB////////////ARajNGgWojVpNGYWNGmjgf///////////wEWohc1ajRqiTVrNWw0bDRrC4GQTgo1bTRtiYAMdXNlcl9hZGRyZXNzZIgApjVxgA9yZWdpc3RyeV9hcHBfaWRkgCFnb3Zlcm5vcl9mZWVfcmF0ZV9wb3dlcl90aHJlc2hvbGRlSDVuNG41cjRxNHINQQAygA9yZWdpc3RyeV9hcHBfaWRkgBdnb3Zlcm5vcl9vcmRlcl9mZWVfcmF0ZWVINW9CACaAD3JlZ2lzdHJ5X2FwcF9pZGSADm9yZGVyX2ZlZV9yYXRlZUg1bzRvNXA0cIk1c4gBwYEGshCADHZhdWx0X2FwcF9pZGSyGIARZ2V0X3RpbnlfcG93ZXJfb2ayGjRzshqBALIBiAGhtD6BBFs1dDR0iTV1NHVBABwyCjR1cAA1dkg0doEAEkEACzR1gQAyCjIKiACjiTV3NXg1eTV6NHgUQQAbNHo4EIEBEkQ0ejgHNHkSRDR6OAg0dxJEQgAgNHo4EIEEEkQ0ejgUNHkSRDR6OBE0eBJENHo4EjR3EkSJNXs1fDV9NX40fBRBACE0fjgQgQESRDR+OAc0fRJENH44CDR7D0Q0fjgINX9CACY0fjgQgQQSRDR+OBQ0fRJENH44ETR8EkQ0fjgSNHsPRDR+OBI1fzR/iTWANYE1gjWDNIMUQQAdiACrgQGyEDSBsgA0gLIHNIKyCIEAsgGIAKlCAB6IAI6BBLIQNIGyADSAshQ0grISNIOyEYEAsgGIAIiJNYQ1hTWGiABpgQayEIEAsgGAD3JlZ2lzdHJ5X2FwcF9pZGSyGIAKZW1pdF9ldmVudLIaNIayGjSFsho0hLIaiABFiTWHNYiBADWJNIcUQQAMNIhgNIh4CTWJQgAJNIg0h3AASDWJNImJNIoURIEBNYqJNIqNAwABAAMACQCxibGBAjWKibaJNIpBAAGJs4mzgQA1iok=",pi="CoEBQw==",li=function(e){return e.Trigger="trigger_order",e.Recurring="recurring_order",e}({}),di=function(e){return e.Trigger="TriggerOrder",e.Recurring="RecurringOrder",e.Entry="Entry",e}({});function fi(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=new Array(arguments.length>1&&void 0!==arguments[1]?arguments[1]:8).fill(t);return r.splice.apply(r,[0,e.length].concat(I(e))),M.apply(void 0,I(r.map((function(e){return ee(e,n)}))))}var gi=new Qo("Entry",ti),hi=new Qo(di.Trigger,ti),mi=new Qo(di.Recurring,ti),Ai=function(t){function n(t,r,a,s){var o,i,c,p;return u(this,n),i=this,p=[t,r,a,ti],c=f(c=n),(o=A(i,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(c,p||[],f(i).constructor):c.apply(i,p))).algod=t,o.registryAppId=oi[a],o.registryApplicationAddress=e.getApplicationAddress(o.registryAppId).toString(),o.routerAppId=ui[a],o.routerApplicationAddress=e.getApplicationAddress(o.routerAppId).toString(),o.vaultAppId=ii[a],o.vaultApplicationAddress=e.getApplicationAddress(o.vaultAppId).toString(),o.userAddress=s,o}return d(n,zo),p(n,[{key:"shouldUpdateOrderingApp",value:(E=i(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.appId){e.next=2;break}return e.abrupt("return",Promise.resolve(!1));case 2:return e.next=4,this.getLatestOrderAppVersion();case 4:if(t=e.sent){e.next=7;break}throw new Error("Registry app has no approved version. Unable to compare.");case 7:return e.next=9,this.getGlobal(ei,void 0,this.appId);case 9:return n=e.sent,e.abrupt("return",t!==n);case 11:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"prepareUpdateOrderingAppTransactions",value:(k=i(s().mark((function t(){var n,r,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.appId){t.next=2;break}throw new Error("Application ID not provided");case 2:return t.next=4,this.getLatestOrderAppVersion();case 4:if(n=t.sent){t.next=7;break}throw new Error("Registry app has no approved version. Unable to update order app.");case 7:return t.next=9,this.getSuggestedParams();case 9:return r=t.sent,a=[e.makeApplicationUpdateTxnFromObject({sender:this.userAddress,suggestedParams:r,appIndex:this.appId,appArgs:[ne("update_application"),e.bigIntToBytes(n,8)],approvalProgram:e.base64ToBytes(ci),clearProgram:e.base64ToBytes(pi)}),e.makeApplicationNoOpTxnFromObject({sender:this.userAddress,suggestedParams:r,appIndex:this.registryAppId,appArgs:[ne("verify_update"),e.bigIntToBytes(n,8)],boxes:[{appIndex:this.registryAppId,name:this.getAppVersionBoxName(Number(n))}]}),e.makeApplicationNoOpTxnFromObject({sender:this.userAddress,suggestedParams:r,appIndex:this.appId,appArgs:[ne("post_update")]})],t.abrupt("return",this.setupTxnFeeAndAssignGroupId({txns:a}));case 12:case"end":return t.stop()}}),t,this)}))),function(){return k.apply(this,arguments)})},{key:"calculateCreateOrderAppMinBalanceIncreaseAmount",value:function(){return P*BigInt(4)+BigInt(ri)*D+BigInt(ni)*_}},{key:"prepareCreateOrderAppTransactions",value:(T=i(s().mark((function t(r){var a,o,i,u,c;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getLatestOrderAppVersion();case 2:if(a=t.sent){t.next=5;break}throw new Error("Registry app has no approved version. Unable to create order app.");case 5:return t.next=7,this.getSuggestedParams();case 7:return o=t.sent,i=n.getRegistryEntryBoxName(r),u={},c=[],t.next=13,this.boxExists(i,this.registryAppId);case 13:if(t.sent){t.next=16;break}u=l({},e.bytesToBase64(i),gi),c.push(e.makePaymentTxnWithSuggestedParamsFromObject({sender:r,receiver:this.registryApplicationAddress,amount:this.calculateMinBalance({accounts:1,assets:1,boxes:u}),suggestedParams:o}));case 16:return c.push(e.makeApplicationCreateTxnFromObject({sender:r,suggestedParams:o,onComplete:e.OnApplicationComplete.NoOpOC,appArgs:[ne("create_application"),ee(this.registryAppId)],approvalProgram:e.base64ToBytes(ci),clearProgram:e.base64ToBytes(pi),numGlobalByteSlices:ri,numGlobalInts:ni,numLocalByteSlices:si,numLocalInts:ai,extraPages:3}),e.makeApplicationNoOpTxnFromObject({sender:r,suggestedParams:o,appIndex:this.registryAppId,appArgs:[ne("create_entry")],boxes:[{appIndex:0,name:i},{appIndex:this.registryAppId,name:this.getAppVersionBoxName(Number(a))}]})),t.abrupt("return",this.setupTxnFeeAndAssignGroupId({txns:c}));case 18:case"end":return t.stop()}}),t,this)}))),function(e){return T.apply(this,arguments)})},{key:"checkOrderAppAvailability",value:(b=i(s().mark((function t(r){var a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.appId||this.applicationAddress){t.next=15;break}if(!r){t.next=6;break}this.appId=r,this.applicationAddress=e.getApplicationAddress(r),t.next=15;break;case 6:return t.next=8,n.getOrderApplicationId(this.algod,this.network,this.userAddress);case 8:if(!(a=t.sent)){t.next=14;break}this.appId=Number(a),this.applicationAddress=e.getApplicationAddress(this.appId),t.next=15;break;case 14:throw new Error("Ordering client is not found for this account address. Please create an order app first.");case 15:case"end":return t.stop()}}),t,this)}))),function(e){return b.apply(this,arguments)})},{key:"getPutTriggerOrderTransactionFee",value:(y=i(s().mark((function t(n){var r,a,o,i,u,c,p,d,f;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.assetInId,a=n.assetOutId,o=n.type,i=0n,this.applicationAddress){t.next=4;break}return t.abrupt("return",i);case 4:return t.prev=4,t.next=7,this.getSuggestedParams();case 7:return u=t.sent.minFee,t.next=10,this.getAssetsToOptInToOrderingClient(this.applicationAddress,[r,a]);case 10:return c=t.sent,t.next=13,this.getOrderCount();case 13:p=t.sent,d=this.getOrderBoxName(p,o),f=l({},e.bytesToBase64(d),hi),i+=BigInt(5+c.length+Number(Boolean(c.length)))*u+BigInt(this.calculateMinBalance({boxes:f,assets:c.length})),t.next=21;break;case 19:t.prev=19,t.t0=t.catch(4);case 21:return t.abrupt("return",i);case 22:case"end":return t.stop()}}),t,this,[[4,19]])}))),function(e){return y.apply(this,arguments)})},{key:"preparePutTriggerOrderTransactions",value:(v=i(s().mark((function t(n){var r,o,i,u,c,p,d,f,g,h,m,A,x,v;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.assetInId,o=n.assetOutId,i=n.assetInAmount,u=n.assetOutAmount,c=n.isPartialAllowed,p=n.duration,t.next=3,this.checkOrderAppAvailability();case 3:return t.next=5,this.getSuggestedParams();case 5:return d=t.sent,t.next=8,this.getOrderCount();case 8:return f=t.sent,g=this.getOrderBoxName(f,li.Trigger),h={},m=[],t.next=14,this.getAssetsToOptInToOrderingClient(this.applicationAddress,[r,o]);case 14:return A=t.sent,t.next=17,this.boxExists(g);case 17:if(t.sent){t.next=24;break}return h=a(a({},h),{},l({},e.bytesToBase64(g),hi)),t.next=21,this.algod.accountInformation(this.applicationAddress).do();case 21:x=t.sent,v=Math.max(0,Number(x.minBalance-x.amount)),m.push(e.makePaymentTxnWithSuggestedParamsFromObject({sender:this.userAddress,receiver:this.applicationAddress,amount:v+this.calculateMinBalance({boxes:h,assets:A.length}),suggestedParams:d}));case 24:return m.push.apply(m,I(this.prepareOrderAppAssetOptinTransactionsIfNeeded(A,d)).concat([r===Ae?e.makePaymentTxnWithSuggestedParamsFromObject({sender:this.userAddress,receiver:this.applicationAddress,amount:i,suggestedParams:d}):e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:this.userAddress,receiver:this.applicationAddress,assetIndex:r,amount:i,suggestedParams:d}),e.makeApplicationNoOpTxnFromObject({sender:this.userAddress,suggestedParams:d,appIndex:this.appId,appArgs:[ne("put_trigger_order"),ee(r),e.bigIntToBytes(i,8),ee(o),e.bigIntToBytes(u,8),ee(Number(c)),ee(p)],foreignAssets:[o],foreignApps:[this.registryAppId,this.vaultAppId],boxes:[{appIndex:0,name:g},{appIndex:this.vaultAppId,name:e.decodeAddress(this.userAddress).publicKey},{appIndex:this.registryAppId,name:this.getRegistryEntryBoxName(this.userAddress)}]})])),t.abrupt("return",this.setupTxnFeeAndAssignGroupId({txns:m,additionalFeeCount:2+A.length}));case 26:case"end":return t.stop()}}),t,this)}))),function(e){return v.apply(this,arguments)})},{key:"preparePutRecurringOrderTransactions",value:(x=i(s().mark((function t(n){var r,o,i,u,c,p,d,f,g,h,m,A,x,v,y,w;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.amount,o=n.assetId,i=n.targetAssetId,u=n.targetRecurrence,c=n.interval,p=n.maxTargetPrice,d=n.minTargetPrice,t.next=3,this.checkOrderAppAvailability();case 3:return t.next=5,this.getOrderCount();case 5:return f=t.sent,g=this.getOrderBoxName(f,li.Recurring),h=[],m={},t.next=11,this.getSuggestedParams();case 11:return A=t.sent,t.next=14,this.getAssetsToOptInToOrderingClient(this.applicationAddress,[o,i]);case 14:return x=t.sent,v=r*BigInt(u),t.next=18,this.boxExists(g);case 18:if(t.sent){t.next=25;break}return m=a(a({},m),{},l({},e.bytesToBase64(g),mi)),t.next=22,this.algod.accountInformation(this.applicationAddress).do();case 22:y=t.sent,w=Math.max(0,Number(y.minBalance-BigInt(y.amount))),h.push(e.makePaymentTxnWithSuggestedParamsFromObject({sender:this.userAddress,receiver:this.applicationAddress,amount:w+this.calculateMinBalance({boxes:m,assets:x.length}),suggestedParams:A}));case 25:return h.push.apply(h,I(this.prepareOrderAppAssetOptinTransactionsIfNeeded(x,A)).concat([o===Ae?e.makePaymentTxnWithSuggestedParamsFromObject({sender:this.userAddress,receiver:this.applicationAddress,amount:v,suggestedParams:A}):e.makeAssetTransferTxnWithSuggestedParamsFromObject({sender:this.userAddress,receiver:this.applicationAddress,assetIndex:o,amount:v,suggestedParams:A}),e.makeApplicationNoOpTxnFromObject({sender:this.userAddress,suggestedParams:A,appIndex:this.appId,foreignApps:[this.registryAppId,this.vaultAppId],foreignAssets:[i],boxes:[{appIndex:0,name:g},{appIndex:this.vaultAppId,name:e.decodeAddress(this.userAddress).publicKey},{appIndex:this.registryAppId,name:this.getRegistryEntryBoxName(this.userAddress)}],appArgs:[ne("put_recurring_order"),ee(o),e.bigIntToBytes(r,8),ee(i),ee(p?Math.floor(Number(r)/p):0),ee(d?Math.floor(Number(r)/d):0),ee(u),ee(c)]})])),t.abrupt("return",this.setupTxnFeeAndAssignGroupId({txns:h,additionalFeeCount:2+x.length}));case 27:case"end":return t.stop()}}),t,this)}))),function(e){return x.apply(this,arguments)})},{key:"prepareCancelOrderTransactions",value:(m=i(s().mark((function t(n,r){var a,o,i,u;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.appId){t.next=2;break}throw new Error("Application ID not provided");case 2:return a=this.getOrderBoxName(n,r),t.next=5,this.getBox(a,r===li.Trigger?di.Trigger:di.Recurring);case 5:if(o=t.sent){t.next=8;break}throw new Error("Order not found");case 8:return t.next=10,this.getSuggestedParams();case 10:return i=t.sent,u=[e.makeApplicationNoOpTxnFromObject({sender:this.userAddress,suggestedParams:i,appIndex:this.appId,appArgs:[ne(r===li.Trigger?"cancel_trigger_order":"cancel_recurring_order"),ee(n)],boxes:[{appIndex:0,name:a},{appIndex:this.registryAppId,name:this.getRegistryEntryBoxName(this.userAddress)}],foreignAssets:[Number(o.getField("asset_id"))],foreignApps:[this.registryAppId]})],t.abrupt("return",this.setupTxnFeeAndAssignGroupId({txns:u,additionalFeeCount:2}));case 13:case"end":return t.stop()}}),t,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"prepareClaimCollectedTargetAmount",value:(h=i(s().mark((function t(n,r){var a,o,i,u;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.appId){t.next=2;break}throw new Error("Application ID not provided");case 2:return t.next=4,this.getSuggestedParams();case 4:return a=t.sent,o=this.getOrderBoxName(n,r),t.next=8,this.getBox(o,r===li.Trigger?di.Trigger:di.Recurring);case 8:if(i=t.sent){t.next=11;break}throw new Error("Order not found");case 11:return u=[e.makeApplicationNoOpTxnFromObject({sender:this.userAddress,suggestedParams:a,appIndex:this.appId,appArgs:[ne("collect"),ee(n),ne(r===li.Trigger?"o":"r")],boxes:[{appIndex:0,name:o}],foreignAssets:[Number(i.getField("target_asset_id"))],foreignApps:[this.registryAppId]})],t.abrupt("return",this.setupTxnFeeAndAssignGroupId({txns:u,additionalFeeCount:2}));case 13:case"end":return t.stop()}}),t,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"getPlatformFeeRate",value:(g=i(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGlobal(Zo,0,this.registryAppId);case 2:if(n=e.sent,!(t&&t>=n)){e.next=5;break}return e.abrupt("return",this.getGlobal(Ho,0,this.registryAppId));case 5:return e.abrupt("return",this.getGlobal(Ko,0,this.registryAppId));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"getOrderCount",value:function(){return this.appId?this.getGlobal(Zo,0,this.appId):Promise.resolve(0)}},{key:"getOrderBoxName",value:function(e,t){return M(ne(t===li.Trigger?"o":"r"),ee(e))}},{key:"getRegistryEntryBoxName",value:function(t){return M(ne("e"),e.decodeAddress(t).publicKey)}},{key:"prepareOrderAppAssetOptInTransaction",value:function(t,n,r,a){return e.makeApplicationNoOpTxnFromObject({sender:t,appIndex:n,appArgs:[ne("asset_opt_in"),fi(r)],suggestedParams:a})}},{key:"prepareOrderAppAssetOptinTransactionsIfNeeded",value:function(e,t){if(!this.appId||!this.applicationAddress)throw new Error("Application ID not provided");return e.length?[this.prepareOrderAppAssetOptInTransaction(this.userAddress,this.appId,e,t)]:[]}},{key:"getAssetsToOptInToOrderingClient",value:(c=i(s().mark((function e(t,n){var r,a,o,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=w(n),e.prev=2,a.s();case 4:if((o=a.n()).done){e.next=17;break}if(!Ne(i=o.value)){e.next=10;break}e.t0=!1,e.next=13;break;case 10:return e.next=12,this.isOptedIn(t,i);case 12:e.t0=!e.sent;case 13:e.t0&&r.push(i);case 15:e.next=4;break;case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(2),a.e(e.t1);case 22:return e.prev=22,a.f(),e.finish(22);case 25:return e.abrupt("return",r);case 26:case"end":return e.stop()}}),e,this,[[2,19,22,25]])}))),function(e,t){return c.apply(this,arguments)})},{key:"getLatestOrderAppVersion",value:function(){return this.getGlobal($o,void 0,this.registryAppId)}},{key:"getAppVersionBoxName",value:function(e){return M(ne("v"),ee(e))}}],[{key:"getRegistryEntryBoxName",value:function(t){var n=e.decodeAddress(t).publicKey;return new Uint8Array([].concat(I(ne("e")),I(n)))}},{key:"getOrderApplicationId",value:(o=i(s().mark((function e(t,r,a){var o,i,u,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.getRegistryEntryBoxName(a),i=oi[r],u=null,e.prev=3,e.next=6,t.getApplicationBoxByName(i,o).do();case 6:c=e.sent,u=Buffer.from(c.value),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(3);case 12:return e.abrupt("return",u?gi.apply(u).getField("app_id"):null);case 13:case"end":return e.stop()}}),e,null,[[3,10]])}))),function(e,t,n){return o.apply(this,arguments)})},{key:"initializeOrderingClient",value:(r=i(s().mark((function e(t,r,a){var o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getOrderApplicationId(t,r,a);case 2:return o=e.sent,e.abrupt("return",new n(t,o?Number(o):null,r,a));case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return r.apply(this,arguments)})}]);var r,o,c,g,h,m,x,v,y,b,T,k,E}();exports.ALGO_ASSET=xe,exports.ALGO_ASSET_ID=Ae,exports.ASSET_OPT_IN_PROCESS_TXN_COUNT=1,exports.AccountState=Ns,exports.AddLiquidity=Nn,exports.BASE_MINIMUM_BALANCE=N,exports.Bootstrap=$t,exports.CONTRACT_VERSION=se,exports.LendingPool=Cr,exports.MINIMUM_ADD_LIQUIDITY_AMOUNT=B,exports.MINIMUM_BALANCE_REQUIRED_PER_APP=P,exports.MINIMUM_BALANCE_REQUIRED_PER_ASSET=S,exports.MINIMUM_BALANCE_REQUIRED_PER_BYTE_SCHEMA=D,exports.MINIMUM_BALANCE_REQUIRED_PER_INT_SCHEMA_VALUE=_,exports.OPT_IN_VALIDATOR_APP_PROCESS_TXN_COUNT=1,exports.OPT_OUT_VALIDATOR_APP_PROCESS_TXN_COUNT=1,exports.OrderingClient=Ai,exports.POOL_TOKEN_UNIT_NAME=Ie,exports.PoolStatus=dt,exports.ProposalVote=$r,exports.REDEEM_PROCESS_TXN_COUNT=3,exports.RemoveLiquidity=er,exports.Swap=Ar,exports.SwapQuoteError=k,exports.SwapQuoteErrorType=T,exports.SwapQuoteType=Pe,exports.SwapType=re,exports.TinymanGovernanceClient=Ro,exports.TinymanSTAlgoClient=Jo,exports.TinymanTAlgoClient=qo,exports.V1_1AddLiquidityTxnIndices=nn,exports.V1_1_ADD_LIQUIDITY_PROCESS_TXN_COUNT=rn,exports.V1_1_REMOVE_LIQUIDITY_TXN_COUNT=Pn,exports.V2AddLiquidityTxnIndices=pn,exports.V2AddLiquidityType=cn,exports.V2_REMOVE_LIQUIDITY_APP_CALL_INNER_TXN_COUNT=zn,exports.applySlippageToAmount=W,exports.calculatePriceImpact=Me,exports.calculateSwapRate=Ue,exports.calculateTinyPower=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.floor(Date.now()/1e3),a=(n=e,Math.floor(n*Za/Ja)),s=t-r;return s<0?0:ds(a,s)},exports.combineAndRegroupSignerTxns=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var s=n.flat(),o=s.map((function(t){var n=t.txn;return n.group=void 0,e.decodeUnsignedTransaction(e.encodeUnsignedTransaction(n))})),i=e.assignGroupID(o);return s.map((function(e,t){return a(a({},e),{},{txn:i[t]})}))},exports.combineAndRegroupTxns=xs,exports.convertFromBaseUnits=z,exports.convertToBaseUnits=function(e,t){var n=Math.pow(10,Number(e))*Number(t);return BigInt(Y({decimalPlaces:0},n))},exports.fetchFolksLendingPool=function(e,t){return Fr.apply(this,arguments)},exports.generateCidFromProposalMetadata=function(e){return function(e){return As.apply(this,arguments)}(function(e){return JSON.stringify(e,Object.keys(e).sort(),0)}(e))},exports.generateOptIntoAssetTxns=be,exports.generateOptIntoValidatorTxns=function(e){return Ke.apply(this,arguments)},exports.generateOptOutOfValidatorTxns=function(e){return $e.apply(this,arguments)},exports.generateProposalMetadata=function(e){var t=e.category,n=e.description,r=e.discussionUrl,a=e.pollUrl,s=e.title;return{category:t.trim(),description:n.trim(),discussion_url:r.trim(),poll_url:a.trim(),title:s.trim()}},exports.generateRedeemTxns=function(e){return wr.apply(this,arguments)},exports.generateSwapRouterTxnFromRecipe=ce,exports.generateSwapRouterTxns=ie,exports.getAccountExcess=function(e){return lt.apply(this,arguments)},exports.getAccountExcessWithinPool=ct,exports.getAddLiquidityTotalFee=function(e){switch(e.version){case se.V1_1:return t=e.minFee,BigInt(rn)*t;case se.V2:return function(e,t){return BigInt(ln[e]+dn[e])*t}(e.type,e.minFee);default:throw new Error("Provided contract version was not valid.")}var t},exports.getAppCallInnerAssetData=Wt,exports.getAssetInAndAssetOutFromSwapQuote=function(e){return{assetIn:je(e),assetOut:Ge(e)}},exports.getAssetInAndOutFromSwapRoute=me,exports.getAssetInFromSwapQuote=je,exports.getAssetInFromSwapRoute=he,exports.getAssetOutFromSwapQuote=Ge,exports.getAssetOutFromSwapRoute=ge,exports.getBestQuote=ze,exports.getMinRequiredBalanceToOptIn=function(e){var t,n=e.currentMinumumBalanceForAccount,r=e.suggestedTransactionFee;if("app-opt-in"===e.type){var a=ot(e.contractVersion);t=P+BigInt(a.schema.numLocalByteSlices)*D+BigInt(a.schema.numLocalInts)*_}else t=S;return t+(n||0n)+(r||0n)},exports.getStakingAppID=function(e){return"testnet"===e?51948952:649588853},exports.getStartTimestampOfWeek=os,exports.getSwapAppCallFeeAmount=Ve,exports.getSwapQuoteContractVersion=Xe,exports.getSwapQuotePriceImpact=function(e){return e.type===Pe.Router?Number(e.data.price_impact):e.data.quote.priceImpact},exports.getSwapQuoteRate=We,exports.getSwapRoute=pe,exports.getSwapRouteRate=fe,exports.getSwapRouterAppID=function(e){var t=de[e];if(!t)throw new Error("Unknown network or network not supported: ".concat(e));return t},exports.getSwapTotalFee=function(e){switch(e.version){case se.V1_1:return t=e.minFee,BigInt(De)*t;case se.V2:return Ce(e.type,e.minFee);default:throw new Error("Provided contract version was not valid.")}var t},exports.getTxnGroupID=$,exports.getV2MinSwapAssetInAmount=Qe,exports.getV2SwapTotalFee=Ce,exports.getValidatorAppID=He,exports.hasSufficientMinimumBalance=function(e){return e.amount>=e.minBalance},exports.intToBytes=ee,exports.isAccountOptedIntoApp=function(e){var t=e.appID,n=e.accountAppsLocalState;return!!n&&n.some((function(e){return e.id===BigInt(t)}))},exports.isSwapAssetInAmountLow=Le,exports.isSwapQuoteErrorCausedByAmount=Ye,exports.joinByteArrays=M,exports.poolUtils=Pt,exports.prepareCommitTransactions=function(e){return Lr.apply(this,arguments)},exports.redeemAllExcessAsset=function(e){return yr.apply(this,arguments)},exports.redeemExcessAsset=function(e){return xr.apply(this,arguments)},exports.sendAndWaitRawTransaction=Z,exports.sumUpTxnFees=K,exports.tinymanContract_v1_1=nt,exports.tinymanContract_v2=st,exports.tinymanJSSDKConfig=oe;
